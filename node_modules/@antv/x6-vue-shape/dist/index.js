!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@antv/x6"),require("vue")):"function"==typeof define&&define.amd?define(["exports","@antv/x6","vue"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).X6VueShape={},e.X6,e.Vue)}(this,(function(e,t,n){"use strict";class o extends t.Node{}!function(e){function n(e){const n=[],o=t.Markup.getForeignObjectMarkup();return e?n.push({tagName:e,selector:"body"},o):n.push(o),n}e.config({view:"vue-shape-view",markup:n(),attrs:{body:{fill:"none",stroke:"none",refWidth:"100%",refHeight:"100%"},fo:{refWidth:"100%",refHeight:"100%"}},propHooks(e){if(null==e.markup){const o=e.primer;if(o){e.markup=n(o);let r={};switch(o){case"circle":r={refCx:"50%",refCy:"50%",refR:"50%"};break;case"ellipse":r={refCx:"50%",refCy:"50%",refRx:"50%",refRy:"50%"}}e.attrs=t.ObjectExt.merge({},{body:Object.assign({refWidth:null,refHeight:null},r)},e.attrs||{})}}return e}}),t.Node.registry.register("vue-shape",e,!0)}(o||(o={}));const r={};let i=!1;const s=n.reactive({});function u(e,t,o,r,u){i&&(s[e]=n.markRaw(n.defineComponent({render:()=>n.h(n.Teleport,{to:o},[n.h(t,{node:r,graph:u})]),provide:()=>({getNode:()=>r,getGraph:()=>u})})))}function p(e){i&&delete s[e]}function a(){return i}class c extends t.NodeView{getComponentContainer(){return this.selectors&&this.selectors.foContent}confirmUpdate(e){const t=super.confirmUpdate(e);return this.handleAction(t,c.action,(()=>{this.renderVueComponent()}))}targetId(){return`${this.graph.view.cid}:${this.cell.id}`}renderVueComponent(){this.unmountVueComponent();const e=this.getComponentContainer(),t=this.cell,o=this.graph;if(e){const{component:i}=r[t.shape];i&&(a()?u(this.targetId(),i,e,t,o):(this.vm=n.createApp({render:()=>n.h(i,{node:t,graph:o}),provide:()=>({getNode:()=>t,getGraph:()=>o})}),this.vm.mount(e)))}}unmountVueComponent(){const e=this.getComponentContainer();return this.vm&&(this.vm.unmount(),this.vm=null),e&&(e.innerHTML=""),e}onMouseDown(e,t,n){const o=e.target;if("input"===o.tagName.toLowerCase()){const e=o.getAttribute("type");if(null==e||["text","password","number","email","search","tel","url"].includes(e))return}super.onMouseDown(e,t,n)}unmount(){return a()&&p(this.targetId()),this.unmountVueComponent(),super.unmount(),this}}!function(e){e.action="vue",e.config({bootstrap:[e.action],actions:{component:e.action}}),t.NodeView.registry.register("vue-shape-view",e,!0)}(c||(c={})),e.VueShape=o,e.VueShapeView=c,e.connect=u,e.disconnect=p,e.getTeleport=function(){return i=!0,n.defineComponent({setup:()=>()=>n.h(n.Fragment,{},Object.keys(s).map((e=>n.h(s[e]))))})},e.isActive=a,e.register=function(e){const{shape:n,component:o,inherit:i}=e,s=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n}(e,["shape","component","inherit"]);if(!n)throw new Error("should specify shape in config");r[n]={component:o},t.Graph.registerNode(n,Object.assign({inherit:i||"vue-shape"},s),!0)},e.shapeMaps=r}));
//# sourceMappingURL=index.js.map
