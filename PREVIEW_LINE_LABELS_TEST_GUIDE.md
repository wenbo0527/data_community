# 预览线标签功能测试指南

## 📋 功能概述

为超过1个分流的节点在预览线上增加标签显示，帮助用户清晰识别不同分支的用途。

## 🎯 测试目标

验证分流节点的预览线是否正确显示分支标签，以及标签样式在不同状态下的表现。

## 🧪 测试步骤

### 1. 人群分流节点测试

1. **创建人群分流节点**
   - 在画布上添加一个"人群分流"节点
   - 配置多个人群层（至少2个）
   - 确认配置完成后生成的预览线

2. **验证标签显示**
   - 检查每条预览线是否显示对应的人群名称标签
   - 验证"未命中人群"分支的标签显示
   - 确认标签位置在预览线的30%处

3. **测试标签样式**
   - 静态显示状态：灰色标签，浅灰背景
   - 交互状态：橙色标签，白色背景
   - 拖拽状态：深色标签，蓝色背景
   - 连接状态：绿色标签，浅绿背景

### 2. 事件分流节点测试

1. **创建事件分流节点**
   - 在画布上添加一个"事件分流"节点
   - 配置事件条件
   - 确认生成"是"和"否"两条预览线

2. **验证标签内容**
   - "是"分支显示正确标签
   - "否"分支显示正确标签
   - 可自定义标签文本（如果配置了yesLabel/noLabel）

### 3. AB测试节点测试

1. **创建AB测试节点**
   - 在画布上添加一个"AB测试"节点
   - 配置多个测试版本
   - 确认每个版本生成对应的预览线

2. **验证版本标签**
   - 每条预览线显示对应的版本名称
   - 标签内容与配置的版本名称一致
   - 支持自定义版本标签

### 4. 单分支节点测试

1. **创建单分支节点**
   - 添加普通节点（如AI调用、短信发送等）
   - 确认只生成一条预览线
   - 验证单分支预览线不显示标签

## 🎨 标签样式规范

### 标签外观
- **背景**: 白色圆角矩形，边框1px
- **文字**: 12px Arial字体，居中对齐
- **位置**: 预览线30%处
- **内边距**: 上下6px，左右8px

### 状态样式
| 状态 | 文字颜色 | 边框颜色 | 背景颜色 |
|------|----------|----------|----------|
| 静态显示 | #999 | #d9d9d9 | #f5f5f5 |
| 交互状态 | #fa8c16 | #fa8c16 | #fff |
| 拖拽状态 | #333 | #1890ff | #e6f7ff |
| 连接状态 | #52c41a | #52c41a | #f6ffed |
| 隐藏状态 | 透明 | 透明 | 透明 |

## 🔍 验证要点

### 功能验证
- [ ] 分流节点（>1分支）显示标签
- [ ] 单分支节点不显示标签
- [ ] 标签内容与配置一致
- [ ] 标签位置正确（30%处）

### 样式验证
- [ ] 标签背景和边框正确
- [ ] 文字大小和对齐正确
- [ ] 不同状态下样式切换正确
- [ ] 标签不遮挡预览线

### 交互验证
- [ ] 拖拽预览线时标签跟随移动
- [ ] 状态切换时标签样式同步更新
- [ ] 标签不影响预览线的交互功能

## 🐛 常见问题排查

### 标签不显示
1. 检查节点是否为分流节点
2. 确认分支数量是否大于1
3. 验证分支配置中是否有label字段

### 标签样式异常
1. 检查updateLabelStyle方法是否正确调用
2. 确认样式配置是否正确传递
3. 验证X6标签API使用是否正确

### 标签位置错误
1. 检查position.distance设置（应为0.3）
2. 确认预览线路径是否正确
3. 验证标签定位选项配置

## 📝 测试记录

### 测试环境
- 浏览器: Chrome/Firefox/Safari
- 分辨率: 1920x1080
- 缩放比例: 100%

### 测试结果
- [ ] 人群分流节点标签显示正常
- [ ] 事件分流节点标签显示正常  
- [ ] AB测试节点标签显示正常
- [ ] 单分支节点无标签显示
- [ ] 标签样式在各状态下正确
- [ ] 标签交互功能正常

## 🚀 后续优化建议

1. **标签内容优化**
   - 支持更丰富的标签内容（图标、颜色等）
   - 长标签文本的省略和提示

2. **标签位置优化**
   - 根据预览线长度动态调整标签位置
   - 避免标签重叠的智能布局

3. **标签交互优化**
   - 标签点击编辑功能
   - 标签悬停显示详细信息

4. **性能优化**
   - 标签渲染性能优化
   - 大量分支时的标签管理