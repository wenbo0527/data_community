# 画布拖拽功能优化说明

## 概述
基于 AntV X6 的桌面端画布拖拽功能已经进行了全面优化，提供了更加流畅和专业的用户体验。

## 新增功能特性

### 1. 多模式拖拽控制
- **默认模式 (1键)**: 标准拖拽体验，平衡的灵敏度
- **精确模式 (2键)**: 低灵敏度，适合精细操作
- **快速模式 (3键)**: 高灵敏度，适合快速浏览

### 2. 增强的键盘控制
- **空格键**: 临时启用拖拽模式（按住期间有效）
- **Shift键**: 提高拖拽灵敏度（2倍）
- **Ctrl键**: 降低拖拽灵敏度（0.3倍）
- **方向键**: 精确平移画布（上下左右）
- **H键**: 居中内容
- **R键**: 重置变换

### 3. 智能缩放控制
- **Ctrl + 滚轮**: 在鼠标位置进行缩放
- **普通滚轮**: 平移画布
- **+/-键**: 放大/缩小
- **0键**: 重置缩放
- **F键**: 适应内容

### 4. 实时视觉反馈
- **模式指示器**: 显示当前拖拽模式
- **位置指示器**: 实时显示画布位置和缩放比例
- **光标反馈**: 根据操作状态动态变化光标
- **拖拽提示**: 拖拽过程中的视觉提示

### 5. 性能优化
- **高性能模式**: 拖拽时自动启用，提升渲染性能
- **防抖处理**: 避免频繁的事件触发
- **边界检查**: 智能边界限制和阻力反馈
- **内存优化**: 及时清理事件监听器和UI元素

## 使用方法

### 基本拖拽
1. 在画布空白区域按住鼠标左键拖拽
2. 或按住空格键临时启用拖拽模式

### 模式切换
1. 点击工具栏中的拖拽模式按钮
2. 或使用键盘快捷键 1/2/3

### 缩放操作
1. 按住 Ctrl 键 + 滚轮缩放
2. 使用工具栏缩放按钮
3. 键盘快捷键：+/-/0/F

### 精确控制
1. 按住 Shift 键提高灵敏度
2. 按住 Ctrl 键降低灵敏度
3. 使用方向键进行像素级移动

## 技术实现

### 核心类：CanvasPanZoomManager
- 管理所有拖拽和缩放逻辑
- 提供多种拖拽模式
- 处理键盘和鼠标事件
- 管理UI指示器

### 集成方式
```javascript
// 在 TaskFlowCanvas.vue 中
import CanvasPanZoomManager from '../../../../utils/CanvasPanZoomManager.js'

// 初始化
panZoomManager = new CanvasPanZoomManager(graph)

// 切换模式
panZoomManager.setDragMode('precise')
```

### 配置选项
```javascript
// 拖拽模式配置
dragModes: {
  default: { sensitivity: 1.0, cursor: 'grab', name: '默认', description: '标准拖拽' },
  precise: { sensitivity: 0.5, cursor: 'crosshair', name: '精确', description: '精细操作' },
  fast: { sensitivity: 2.0, cursor: 'move', name: '快速', description: '快速浏览' }
}
```

## 兼容性
- 支持鼠标和触摸操作
- 兼容所有现代浏览器
- 响应式设计，适配不同屏幕尺寸

## 注意事项
1. 拖拽功能仅在画布空白区域有效
2. 节点拖拽和画布拖拽是独立的功能
3. 所有UI指示器会在组件销毁时自动清理
4. 建议在大型画布上使用快速模式以提高效率

## 故障排除
如果遇到拖拽功能异常，请检查：
1. 浏览器控制台是否有错误信息
2. X6 图实例是否正确初始化
3. 事件监听器是否正确绑定
4. UI指示器元素是否正确创建