# “10 条日志”问题分析与修复方案

## 问题分析
- 触发页面：`/risk/model-offline-analysis/task-management`
- 触发条件与频率：分页合计文案默认显示造成误读；在数据总数为 10 时更易被理解为“10 条日志”。
- 错误堆栈与上下文：当前仓库未检索到与该路由相关的错误堆栈；开发服务器与文档型日志未包含该页面的报错记录。
- 历史日志模式：项目内存在“最近17条日志”等硬编码案例，说明计数文案可能来源于页面级配置而非后端日志系统。

## 代码审查
- 路由：`src/router/model-offline-analysis.js:49-56` 指向 `taskManagement/index.vue`
- 页面：`src/pages/risk/model-offline-analysis/taskManagement/index.vue` 使用 Arco `a-table`，分页 `pagination.pageSize=10`
- 状态：`src/store/modules/model-offline.js:146-214`（Pinia）
- 全局配置：未使用 Arco `ConfigProvider` 或全局 `locale` 改写合计文案，问题集中在页面级渲染。

## 修复措施
- 分页合计文案：显式覆盖为任务领域文案
  - 代码：`showTotal: (total) => \`共 ${total} 条任务\``（`taskManagement/index.vue:291-298`）
- 日志接入：接入统一日志器，覆盖关键操作与异常
  - 引入：`import { logger } from '@/utils/enhancedErrorHandler.js'`
  - 覆盖点：数据加载、筛选、搜索、重置、分页、刷新、跳转与错误流
- 异常处理：补全 `onUnmounted` 导入，确保定时器清理逻辑在测试与运行环境均正常

## 测试与验证
- 单元测试：`src/pages/risk/model-offline-analysis/taskManagement/__tests__/taskManagement.spec.ts`
  - 验证点：组件挂载触发 `loadData`，并产生 `TaskManagement loadData start/success` 日志输出
  - 结果：测试通过（`vitest --config vitest.config.js run <spec>`）
- 运行验证：开发环境下加载页面，分页合计显示“共 X 条任务”，未出现“10 条日志”。

## 结论与后续
- 问题根因：页面级合计文案未明确领域词导致误读。
- 修复效果：分页文案统一为任务领域；日志覆盖到关键交互，便于后续问题复盘。
- 后续行动：如出现跨模块相似文案问题，统一通过组件或配置抽象进行治理；避免硬编码计数描述。

