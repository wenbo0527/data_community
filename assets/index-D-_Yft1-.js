import{packageMockData as Q}from"./coupon-BKFb4O9B.js";import{_ as W,r as u,p as S,c as X,h as Y,f as e,w as l,M as _,e as n,o as Z,j as i,i as ee,x as ae,t as h}from"./index-CsgcdrY7.js";const le={class:"coupon-package-container"},te={class:"header"},oe={__name:"index",setup(ne){const w=u(Q),f=u(!1),C=u(""),p=S({total:0,current:1,pageSize:10,showTotal:!0,showJumper:!0,showPageSize:!0}),b=u(null),m=u(!1),y=u(!1),z=u([]),r=u(!1),s=S({name:"",coupons:[],stockRule:"sufficient",invalidRule:"any",marketingTargets:[]}),U={name:[{required:!0,message:"请输入券包名称"},{maxLength:50,message:"券包名称不能超过50个字符"}],coupons:[{required:!0,message:"请选择券"},{type:"array",min:1,message:"至少选择一张券"}],stockRule:[{required:!0,message:"请选择库存管理规则"}],invalidRule:[{required:!0,message:"请选择失效规则"}],marketingTargets:[{required:!0,message:"请选择营销目标"},{type:"array",min:1,message:"至少选择一个营销目标"}]},M=u([{label:"首贷满100减50券",value:"1",type:"首贷促动包"},{label:"首贷满200减100券",value:"2",type:"首贷促动包"},{label:"首贷满300减150券",value:"3",type:"首贷促动包"},{label:"复贷满500减100券",value:"4",type:"复贷促动包"},{label:"复贷满1000减200券",value:"5",type:"复贷促动包"},{label:"复贷满2000减400券",value:"6",type:"复贷促动包"}]),c=async()=>{f.value=!0;try{w.value=[{id:1,name:"新用户首贷大礼包",couponTypes:3,couponCount:150,createTime:"2023-06-18 10:00:00",status:1,type:"首贷促动包",creator:"张三"},{id:2,name:"老用户专享券包",couponTypes:2,couponCount:200,createTime:"2023-07-01 14:30:00",status:1,type:"复贷促动包",creator:"李四"},{id:3,name:"新手体验券包",couponTypes:2,couponCount:100,createTime:"2023-07-15 09:00:00",status:0,type:"首贷促动包",creator:"王五"},{id:4,name:"复贷优惠大礼包",couponTypes:3,couponCount:300,createTime:"2023-07-20 16:45:00",status:1,type:"复贷促动包",creator:"赵六"}],p.total=100}catch(o){console.error("获取券包列表失败:",o),_.error("获取券包列表失败")}finally{f.value=!1}},q=()=>{p.current=1,c()},$=o=>{p.current=o,c()},B=o=>{p.pageSize=o,p.current=1,c()},N=()=>{m.value=!0},I=async()=>{try{await b.value.validate(),_.success("创建成功"),m.value=!1,c()}catch(o){console.error("表单验证失败:",o)}},O=()=>{b.value.resetFields(),m.value=!1},j=async o=>{try{_.success(`${o.status===1?"停用":"启用"}成功`),c()}catch(t){console.error("修改状态失败:",t),_.error("操作失败")}},A=async o=>{try{_.success("删除成功"),c()}catch(t){console.error("删除失败:",t),_.error("删除失败")}},V=o=>{s.value={name:o.name,coupons:o.coupons||[],stockRule:o.stockRule||"sufficient",invalidRule:o.invalidRule||"any",marketingTargets:o.marketingTargets||["app","miniprogram"]},m.value=!0};return c(),(o,t)=>{const E=n("a-input-search"),k=n("a-button"),x=n("a-space"),F=n("a-link"),d=n("a-table-column"),J=n("a-tag"),L=n("a-table"),G=n("a-input"),g=n("a-form-item"),T=n("a-select"),v=n("a-radio"),R=n("a-radio-group"),H=n("a-form"),D=n("a-modal"),K=n("a-descriptions");return Z(),X("div",le,[Y("div",te,[e(x,null,{default:l(()=>[e(E,{modelValue:C.value,"onUpdate:modelValue":t[0]||(t[0]=a=>C.value=a),placeholder:"搜索券包名称",style:{width:"300px"},onSearch:q},null,8,["modelValue"]),e(k,{type:"primary",onClick:N},{icon:l(()=>[e(ee(ae))]),default:l(()=>[i(" 新建券包 ")]),_:1})]),_:1})]),e(L,{data:w.value,loading:f.value,pagination:p,onPageChange:$,onPageSizeChange:B,onRowDblclick:V},{columns:l(()=>[e(d,{title:"券包名称","data-index":"name",width:200},{cell:l(({record:a})=>[e(F,{onClick:P=>V(a),style:{color:"rgb(var(--primary-6))"}},{default:l(()=>[i(h(a.name),1)]),_:2},1032,["onClick"])]),_:1}),e(d,{title:"包含券种类","data-index":"couponTypes",width:150}),e(d,{title:"可下发券数量","data-index":"couponCount",width:120,align:"center"}),e(d,{title:"创建时间","data-index":"createTime",width:180}),e(d,{title:"状态","data-index":"status",width:120,align:"center"},{cell:l(({record:a})=>[e(J,{color:a.status===1?"green":"red"},{default:l(()=>[i(h(a.status===1?"启用":"停用"),1)]),_:2},1032,["color"])]),_:1}),e(d,{title:"创建人","data-index":"creator",width:120}),e(d,{title:"操作",align:"center",width:150},{cell:l(({record:a})=>[e(x,null,{default:l(()=>[e(k,{type:"text",size:"small",status:a.status===1?"danger":"success",onClick:P=>j(a)},{default:l(()=>[i(h(a.status===1?"停用":"启用"),1)]),_:2},1032,["status","onClick"]),e(k,{type:"text",status:"danger",size:"small",disabled:a.status===1,onClick:P=>A(a)},{default:l(()=>[i(" 删除 ")]),_:2},1032,["disabled","onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data","loading","pagination"]),e(D,{visible:m.value,"onUpdate:visible":t[6]||(t[6]=a=>m.value=a),title:r.value?"券包详情":"新建券包",onOk:I,onCancel:O},{default:l(()=>[e(H,{model:s,rules:r.value?{}:U,ref_key:"formRef",ref:b,layout:"horizontal",style:{width:"90%",margin:"0 auto"}},{default:l(()=>[e(g,{field:"name",label:"券包名称","validate-trigger":"blur","label-col-props":{span:6},"wrapper-col-props":{span:18}},{default:l(()=>[e(G,{modelValue:s.name,"onUpdate:modelValue":t[1]||(t[1]=a=>s.name=a),placeholder:"请输入券包名称",readonly:r.value,"allow-clear":""},null,8,["modelValue","readonly"])]),_:1}),e(g,{field:"coupons",label:"选择券","validate-trigger":"blur","label-col-props":{span:6},"wrapper-col-props":{span:18}},{default:l(()=>[e(T,{modelValue:s.coupons,"onUpdate:modelValue":t[2]||(t[2]=a=>s.coupons=a),placeholder:"请选择券",multiple:"",options:M.value,readonly:r.value,disabled:r.value,"allow-clear":"","allow-search":"","max-tag-count":3},null,8,["modelValue","options","readonly","disabled"])]),_:1}),e(g,{field:"stockRule",label:"库存管理规则","validate-trigger":"blur","label-col-props":{span:6},"wrapper-col-props":{span:18}},{default:l(()=>[e(R,{modelValue:s.stockRule,"onUpdate:modelValue":t[3]||(t[3]=a=>s.stockRule=a),disabled:r.value},{default:l(()=>[e(v,{value:"sufficient"},{default:l(()=>[i("所有券库存充足发放")]),_:1}),e(v,{value:"any"},{default:l(()=>[i("任一券库存充足发放")]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1}),e(g,{field:"invalidRule",label:"失效规则","validate-trigger":"blur","label-col-props":{span:6},"wrapper-col-props":{span:18}},{default:l(()=>[e(R,{modelValue:s.invalidRule,"onUpdate:modelValue":t[4]||(t[4]=a=>s.invalidRule=a),disabled:r.value},{default:l(()=>[e(v,{value:"any"},{default:l(()=>[i("包内一张券失效则失效")]),_:1}),e(v,{value:"all"},{default:l(()=>[i("所有券失效才失效")]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1}),e(g,{field:"marketingTargets",label:"营销目标","validate-trigger":"blur","label-col-props":{span:6},"wrapper-col-props":{span:18}},{default:l(()=>[e(T,{modelValue:s.marketingTargets,"onUpdate:modelValue":t[5]||(t[5]=a=>s.marketingTargets=a),placeholder:"请选择营销目标",multiple:"",options:[{label:"APP",value:"app"},{label:"小程序",value:"miniprogram"}],readonly:r.value,disabled:r.value,"allow-clear":"","max-tag-count":2},null,8,["modelValue","readonly","disabled"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["visible","title"]),e(D,{visible:y.value,"onUpdate:visible":t[7]||(t[7]=a=>y.value=a),title:"券包详情",onCancel:t[8]||(t[8]=()=>y.value=!1),footer:!1},{default:l(()=>[e(K,{data:z.value,layout:"inline-vertical",bordered:""},null,8,["data"])]),_:1},8,["visible"])])}}},ue=W(oe,[["__scopeId","data-v-17caf1ce"]]);export{ue as default};
