import{r as p,a as $,b as ke,M as C,d as b,w as a,e as n,u as Ve,o as v,f as e,g as z,h as x,i as q,I as he,t as m,j as r,k as Te,n as Ne,l as Ie,c as Ce,F as qe,m as xe}from"./index-CsgcdrY7.js";import{I as Ue}from"./index-D3r115Ij.js";const Fe={class:"title-section"},Pe={class:"data-title"},we={class:"tag-group"},Ee=x("h3",null,"表结构信息",-1),De={__name:"detail",setup(Me){const H=p([{value:"interface1",label:"主接口1"},{value:"interface2",label:"主接口2"},{value:"interface3",label:"主接口3"}]),W=Ve(),A=[{title:"接口名称",dataIndex:"name"},{title:"接口地址",dataIndex:"url"},{title:"操作",slotName:"operations"}],j=()=>{t.value.backupInterfaces.push({name:"",url:""})},J=d=>{t.value.backupInterfaces.splice(d,1)},K=$(()=>[{label:"接口编号",value:l.value.interfaceId},{label:"数据管理",value:l.value.manager},{label:"上线时间",value:l.value.onlineTime},{label:"更新频率",value:l.value.updateFrequency},{label:"请求方式",value:l.value.requestMethod},{label:"测试环境地址",value:l.value.testUrl},{label:"生产环境地址",value:l.value.productionUrl},{label:"超时时间",value:`${l.value.timeout}秒`},{label:"重试次数",value:l.value.retryCount},{label:"缓存时间",value:`${l.value.cacheTime}秒`}]),S=d=>({核验类:"blue",评分类:"orange",标签类:"green",名单类:"red",价格评估类:"purple",身份核验类:"cyan",信用评分:"gold",用户画像:"lime",风险名单:"magenta",资产评估:"geekblue"})[d]||"gray",l=p({dataName:"手机号核验服务",dataType:"核验类",subType:"身份核验类",category:"核验类",manager:"李明",supplier:"数据服务商A",price:.8,description:"提供手机号实名认证及在网时长查询服务，支持批量查询，实时响应",isPrimary:!0,isFavorite:!1,interfaceId:"WS_CELLPHONE_V2",onlineTime:"2024-01-15",updateFrequency:"实时",requestMethod:"POST",testUrl:"https://test-api.example.com/api/v2/verify/phone",productionUrl:"https://api.example.com/api/v2/verify/phone",backupTestUrl:"",backupProductionUrl:"",timeout:1.5,retryCount:2,cacheTime:1800}),h=p(!1),y=p(null),t=p({category:"",dataType:"",interfaceType:"主接口",tableName:"",callCost:0,supplier:"",price:0,description:"",backupTestUrl:"",backupProductionUrl:""}),U={category:[{required:!0,message:"请选择数源种类"}],dataType:[{required:!0,message:"请选择数源分类"}],interfaceType:[{required:!0,message:"请选择接口类型"}],tableName:[{required:!0,message:"请输入落库表名"}],supplier:[{required:!0,message:"请输入供应商"}],price:[{required:!0,message:"请输入单价"}],callCost:[{required:!0,message:"请输入调用费用"},{type:"number",min:0,message:"费用不能为负数"}],backupTestUrl:[{required:!1,message:"请输入备用测试环境地址"}],backupProductionUrl:[{required:!1,message:"请输入备用生产环境地址"}]},B=p([{label:"接口编号",value:"WS_CELLPHONE_V2"},{label:"数据管理",value:"dws_prd_phone_verify"},{label:"上线时间",value:"2024-01-15"},{label:"更新频率",value:"实时"}]),D=p([{label:"请求方式",value:"POST"},{label:"测试环境地址",value:"https://test-api.example.com/api/v2/verify/phone"},{label:"生产环境地址",value:"https://api.example.com/api/v2/verify/phone"},{label:"超时时间",value:"1500ms"},{label:"重试次数",value:"2次"},{label:"缓存时间",value:"30分钟"},{label:"上线时间",value:"2024-01-15"},{label:"报文格式",value:"JSON"},{label:"请求编码",value:"UTF-8"}]),F=p([{label:"落库表名",value:"dws_verify_phone_result_v2"},{label:"落库频率",value:"准实时"},{label:"保存天数",value:"365天"},{label:"压缩方式",value:"ORC"},{label:"分区字段",value:"dt,hour"},{label:"主键字段",value:"request_id,phone"}]),G=[{title:"字段中文名",dataIndex:"chineseName"},{title:"字段英文名",dataIndex:"englishName"},{title:"字段类型",dataIndex:"fieldType"},{title:"是否必填",dataIndex:"required"},{title:"备注",dataIndex:"remark"}],Q=[{chineseName:"请求ID",englishName:"request_id",fieldType:"string",required:"是",remark:"唯一标识请求的ID"},{chineseName:"手机号",englishName:"phone",fieldType:"string",required:"是",remark:"待验证的手机号码"},{chineseName:"验证结果",englishName:"verify_result",fieldType:"boolean",required:"是",remark:"验证是否通过"},{chineseName:"在网状态",englishName:"status",fieldType:"string",required:"是",remark:"手机号在网状态"},{chineseName:"在网时长",englishName:"duration",fieldType:"integer",required:"否",remark:"手机号在网时长（月）"},{chineseName:"运营商",englishName:"operator",fieldType:"string",required:"是",remark:"手机号所属运营商"},{chineseName:"创建时间",englishName:"create_time",fieldType:"timestamp",required:"是",remark:"数据创建时间"},{chineseName:"更新时间",englishName:"update_time",fieldType:"timestamp",required:"是",remark:"数据更新时间"}],X=p([{label:"计费方式",value:"阶梯计费"},{label:"单价",value:"0.8元/次起"},{label:"最小起订量",value:"5000次"},{label:"账期",value:"预付费"}]),Y=p([{label:"准确率",value:"99.95%"},{label:"响应时间",value:"平均150ms"},{label:"覆盖率",value:"99.5%"},{label:"稳定性",value:"99.995%"}]),Z=[{title:"参数名",dataIndex:"name"},{title:"类型",dataIndex:"type"},{title:"是否必填",dataIndex:"required"},{title:"描述",dataIndex:"description"}],ee=[{name:"phone",type:"string",required:"是",description:"手机号码，支持单个或批量查询（最多100个）"},{name:"checkItems",type:"array",required:"否",description:'查询项目，可选值：["status", "duration"]'},{name:"source",type:"string",required:"否",description:"调用来源，用于统计"}],ae=[{title:"参数名",dataIndex:"name"},{title:"类型",dataIndex:"type"},{title:"描述",dataIndex:"description"}],le=[{name:"isValid",type:"boolean",description:"号码是否有效"},{name:"status",type:"string",description:"在网状态：正常/停机/销号/空号"},{name:"duration",type:"number",description:"在网时长（月）"},{name:"operator",type:"string",description:"运营商信息"},{name:"message",type:"string",description:"结果说明"}],te=()=>{l.value.isFavorite=!l.value.isFavorite},ue=()=>{t.value={category:l.value.category,interfaceType:l.value.isPrimary?"主接口":"备用接口",tableName:F.value[0].value,supplier:l.value.supplier,price:l.value.price,description:l.value.description},h.value=!0},oe=()=>{var d;h.value=!1,(d=y.value)==null||d.resetFields()},ne=async()=>{var d;try{await((d=y.value)==null?void 0:d.validate()),console.log("保存编辑数据:",t.value),l.value={...l.value,category:t.value.category,isPrimary:t.value.interfaceType==="主接口",supplier:t.value.supplier,price:t.value.price,description:t.value.description},F.value[0].value=t.value.tableName,C.success("保存成功"),h.value=!1}catch(u){console.error("表单验证失败:",u)}},re=async d=>{try{console.log("切换到",d?"主接口":"备用接口"),await new Promise(u=>setTimeout(u,1e3)),de(d),C.success(`已切换到${d?"主接口":"备用接口"}`)}catch{C.error("接口切换失败")}},de=d=>{d?(B.value[0].value="WS_CELLPHONE",D.value[1].value="/api/v1/verify/phone"):(B.value[0].value="WS_CELLPHONE_BACKUP",D.value[1].value="/api/v1/verify/phone/backup")},ie=$(()=>W.params.id);return ke(async()=>{try{console.log("获取数据详情:",ie.value),await new Promise(d=>setTimeout(d,1e3))}catch{C.error("获取数据详情失败")}}),(d,u)=>{const _=n("a-button"),L=n("a-tag"),T=n("a-space"),g=n("a-descriptions-item"),k=n("a-descriptions"),O=n("a-col"),se=n("a-row"),f=n("a-card"),ce=n("a-alert"),R=n("a-radio"),pe=n("a-radio-group"),s=n("a-tab-pane"),me=n("a-divider"),N=n("a-table"),P=n("a-tabs"),fe=n("a-layout-content"),w=n("a-input"),i=n("a-form-item"),c=n("a-option"),V=n("a-select"),E=n("a-input-number"),ve=n("a-textarea"),M=n("a-form"),_e=n("icon-plus"),be=n("a-drawer"),ye=n("a-layout");return v(),b(ye,null,{default:a(()=>[e(fe,{class:"content"},{default:a(()=>[e(f,{bordered:!1,class:"main-info"},{default:a(()=>[e(se,{gutter:24},{default:a(()=>[e(O,{span:18},{default:a(()=>[e(T,{direction:"vertical",fill:""},{default:a(()=>[x("div",Fe,[e(T,{align:"center"},{default:a(()=>[e(_,{type:"text",onClick:u[0]||(u[0]=o=>d.$router.back())},{icon:a(()=>[e(q(he))]),_:1}),x("h2",Pe,m(l.value.dataName),1),x("div",we,[e(L,{color:S(l.value.dataType)},{default:a(()=>[r(m(l.value.dataType),1)]),_:1},8,["color"]),l.value.subType?(v(),b(L,{key:0,color:S(l.value.subType)},{default:a(()=>[r(m(l.value.subType),1)]),_:1},8,["color"])):z("",!0)])]),_:1})]),e(k,{column:2,size:"large",class:"basic-info"},{default:a(()=>[e(g,{label:"产品分类"},{default:a(()=>[r(m(l.value.category),1)]),_:1}),e(g,{label:"管理人员"},{default:a(()=>[r(m(l.value.manager),1)]),_:1}),e(g,{label:"供应商"},{default:a(()=>[r(m(l.value.supplier),1)]),_:1}),e(g,{label:"单价"},{default:a(()=>[r(m(l.value.price)+"元/次",1)]),_:1}),e(g,{label:"产品描述",span:2},{default:a(()=>[r(m(l.value.description),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(O,{span:6,class:"action-panel"},{default:a(()=>[e(T,null,{default:a(()=>[e(_,{type:"primary",onClick:ue},{icon:a(()=>[e(q(Te))]),default:a(()=>[r(" 编辑信息 ")]),_:1}),e(_,{type:"text",class:Ne({"favorite-btn":!0,"is-favorite":l.value.isFavorite}),onClick:te},{icon:a(()=>[l.value.isFavorite?(v(),b(q(Ie),{key:0})):(v(),b(q(Ue),{key:1}))]),default:a(()=>[r(" "+m(l.value.isFavorite?"取消收藏":"收藏"),1)]),_:1},8,["class"])]),_:1})]),_:1})]),_:1})]),_:1}),l.value.isPrimary?z("",!0):(v(),b(ce,{key:0,type:"warning",style:{margin:"16px 0"}},{default:a(()=>[r(" 当前查看的是备用接口信息，可切换至主接口查看 ")]),_:1})),e(pe,{modelValue:l.value.isPrimary,"onUpdate:modelValue":u[1]||(u[1]=o=>l.value.isPrimary=o),type:"button",style:{marginBottom:"16px"},onChange:re},{default:a(()=>[e(R,{value:!0},{default:a(()=>[r("主接口")]),_:1}),e(R,{value:!1},{default:a(()=>[r("备用接口")]),_:1})]),_:1},8,["modelValue"]),e(f,{bordered:!1,class:"main-card"},{default:a(()=>[e(P,null,{default:a(()=>[e(s,{key:"1",title:"基本信息"},{default:a(()=>[e(f,{bordered:!1,class:"info-card"},{default:a(()=>[e(k,{column:2,data:K.value},null,8,["data"])]),_:1})]),_:1}),e(s,{key:"2",title:"落库信息"},{default:a(()=>[e(f,{bordered:!1,class:"info-card"},{default:a(()=>[e(k,{column:2,data:F.value},null,8,["data"]),e(me,{style:{margin:"16px 0"}}),Ee,e(N,{columns:G,data:Q,pagination:!1})]),_:1})]),_:1}),e(s,{key:"3",title:"产品入参"},{default:a(()=>[e(f,{bordered:!1,class:"info-card"},{default:a(()=>[e(N,{columns:Z,data:ee,pagination:!1})]),_:1})]),_:1}),e(s,{key:"4",title:"产品出参"},{default:a(()=>[e(f,{bordered:!1,class:"info-card"},{default:a(()=>[e(N,{columns:ae,data:le,pagination:!1})]),_:1})]),_:1}),e(s,{key:"5",title:"调用及费用"},{default:a(()=>[e(f,{bordered:!1,class:"info-card"},{default:a(()=>[e(k,{column:2,data:X.value},null,8,["data"])]),_:1})]),_:1}),e(s,{key:"6",title:"变量评估"},{default:a(()=>[e(f,{bordered:!1,class:"info-card"},{default:a(()=>[e(k,{column:2,data:Y.value},null,8,["data"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(be,{visible:h.value,onCancel:oe,onOk:ne,title:"编辑信息",width:"800px"},{default:a(()=>[e(P,{"default-active-key":"1"},{default:a(()=>[e(s,{key:"1",title:"产品信息"},{default:a(()=>[e(f,{bordered:!1},{default:a(()=>[e(M,{model:t.value,ref_key:"editFormRef",ref:y,rules:U},{default:a(()=>[e(i,{field:"dataName",label:"产品名称"},{default:a(()=>[e(w,{modelValue:l.value.dataName,"onUpdate:modelValue":u[2]||(u[2]=o=>l.value.dataName=o),disabled:""},null,8,["modelValue"])]),_:1}),e(i,{field:"dataType",label:"数源种类",required:""},{default:a(()=>[e(V,{modelValue:t.value.dataType,"onUpdate:modelValue":u[3]||(u[3]=o=>t.value.dataType=o),placeholder:"请选择数源种类"},{default:a(()=>[e(c,{value:"核验类"},{default:a(()=>[r("核验类")]),_:1}),e(c,{value:"评分类"},{default:a(()=>[r("评分类")]),_:1}),e(c,{value:"标签类"},{default:a(()=>[r("标签类")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(i,{field:"subType",label:"数源分类",required:""},{default:a(()=>[e(V,{modelValue:t.value.subType,"onUpdate:modelValue":u[4]||(u[4]=o=>t.value.subType=o),placeholder:"请选择数源分类"},{default:a(()=>[e(c,{value:"身份核验类"},{default:a(()=>[r("身份核验类")]),_:1}),e(c,{value:"信用评分"},{default:a(()=>[r("信用评分")]),_:1}),e(c,{value:"用户画像"},{default:a(()=>[r("用户画像")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(i,{field:"supplier",label:"供应商",required:""},{default:a(()=>[e(w,{modelValue:t.value.supplier,"onUpdate:modelValue":u[5]||(u[5]=o=>t.value.supplier=o),placeholder:"请输入供应商"},null,8,["modelValue"])]),_:1}),e(i,{field:"price",label:"单价",required:""},{default:a(()=>[e(E,{modelValue:t.value.price,"onUpdate:modelValue":u[6]||(u[6]=o=>t.value.price=o),min:0,precision:2,placeholder:"请输入单价"},null,8,["modelValue"])]),_:1}),e(i,{field:"description",label:"产品描述",required:""},{default:a(()=>[e(ve,{modelValue:t.value.description,"onUpdate:modelValue":u[7]||(u[7]=o=>t.value.description=o),placeholder:"请输入产品描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),e(s,{key:"2",title:"已注册接口"},{default:a(()=>[e(P,null,{default:a(()=>[e(s,{key:"2-1",title:"主接口"},{default:a(()=>[e(M,{model:t.value,ref_key:"editFormRef",ref:y,rules:U},{default:a(()=>[e(i,{field:"tableName",label:"落库表名",required:""},{default:a(()=>[e(V,{modelValue:t.value.tableName,"onUpdate:modelValue":u[8]||(u[8]=o=>t.value.tableName=o),placeholder:"请选择已注册接口"},{default:a(()=>[(v(!0),Ce(qe,null,xe(H.value,(o,I)=>(v(),b(c,{key:I,value:o.value},{default:a(()=>[r(m(o.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(i,{field:"callCost",label:"调用费用(元/次)",required:""},{default:a(()=>[e(E,{modelValue:t.value.callCost,"onUpdate:modelValue":u[9]||(u[9]=o=>t.value.callCost=o),min:0,precision:2,placeholder:"请输入调用费用"},null,8,["modelValue"])]),_:1}),e(i,{field:"dataManagement",label:"数据管理",required:""},{default:a(()=>[e(V,{modelValue:t.value.dataManagement,"onUpdate:modelValue":u[10]||(u[10]=o=>t.value.dataManagement=o),placeholder:"请选择数据管理方式"},{default:a(()=>[e(c,{value:"自动"},{default:a(()=>[r("自动")]),_:1}),e(c,{value:"手动"},{default:a(()=>[r("手动")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1}),e(s,{key:"2-2",title:"备用接口"},{default:a(()=>[e(M,{model:t.value,ref_key:"editFormRef",ref:y,rules:U},{default:a(()=>[e(i,{field:"backupTableName",label:"落库表名",required:""},{default:a(()=>[e(w,{modelValue:t.value.backupTableName,"onUpdate:modelValue":u[11]||(u[11]=o=>t.value.backupTableName=o),placeholder:"请输入落库表名"},null,8,["modelValue"])]),_:1}),e(i,{field:"backupCallCost",label:"调用费用(元/次)",required:""},{default:a(()=>[e(E,{modelValue:t.value.backupCallCost,"onUpdate:modelValue":u[12]||(u[12]=o=>t.value.backupCallCost=o),min:0,precision:2,placeholder:"请输入调用费用"},null,8,["modelValue"])]),_:1}),e(i,{field:"backupDataManagement",label:"数据管理",required:""},{default:a(()=>[e(V,{modelValue:t.value.backupDataManagement,"onUpdate:modelValue":u[13]||(u[13]=o=>t.value.backupDataManagement=o),placeholder:"请选择数据管理方式"},{default:a(()=>[e(c,{value:"自动"},{default:a(()=>[r("自动")]),_:1}),e(c,{value:"手动"},{default:a(()=>[r("手动")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1}),e(s,{key:"2-3",title:"新增备用接口"},{default:a(()=>[e(N,{columns:A,data:t.value.backupInterfaces},{operations:a(({record:o,index:I})=>[e(T,null,{default:a(()=>[e(_,{type:"text",size:"small",onClick:ge=>d.handleEditBackupInterface(I)},{default:a(()=>[r("编辑")]),_:2},1032,["onClick"]),e(_,{type:"text",size:"small",status:"danger",onClick:ge=>J(I)},{default:a(()=>[r("删除")]),_:2},1032,["onClick"])]),_:2},1024)]),_:1},8,["data"]),e(_,{type:"primary",onClick:j,style:{"margin-top":"16px"}},{icon:a(()=>[e(_e)]),default:a(()=>[r(" 添加备用接口 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["visible"])]),_:1})}}};export{De as default};
