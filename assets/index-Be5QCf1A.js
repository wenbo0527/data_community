import{i as K}from"./index-CeY0obGP.js";import{_ as U,r as n,K as q,b as G,L as H,c as b,f as e,w as t,M as Q,e as s,o as l,F as z,m as R,d,h as _,C as k,t as f,i as g,j as B}from"./index-CsgcdrY7.js";import{I as A,a as I}from"./index-BrBaLzo0.js";import{I as X}from"./index-CrAnsjHE.js";const Y={class:"coupon-statistics-container"},Z={class:"highlight-text"},$={class:"highlight-text"},ee={__name:"index",setup(te){const c=n(!1),L=n("week"),W=n([{batchDate:"2024-01-01",sendCount:1e3,successCount:850,successRate:85},{batchDate:"2024-01-02",sendCount:1200,successCount:980,successRate:81.7},{batchDate:"2024-01-03",sendCount:800,successCount:700,successRate:87.5},{batchDate:"2024-01-04",sendCount:1500,successCount:1200,successRate:80}]),T=n([{title:"库存量",value:1e4,trend:"up",percentage:10.2,description:"近3月内权益创建的券总库存"},{title:"未领取量",value:3200,trend:"down",percentage:5.5,description:"状态为未领取券的总量"},{title:"已领取量",value:4800,trend:"up",percentage:12.3,description:"当前状态为已领取券的总量"},{title:"已锁定量",value:1200,trend:"up",percentage:8.1,description:"当前状态为已锁定券的总量"},{title:"已核销量",value:800,trend:"up",percentage:6.7,description:"当前状态为已核销券的总量"},{title:"权益领取率",value:68,precision:1,trend:"up",percentage:3.2,description:"统计周期内：(已领取+已锁定+已核销)/库存量"},{title:"权益使用率",value:41.7,precision:1,trend:"up",percentage:2.8,description:"统计周期内：(已锁定 + 已核销)/已领取"}]),E=n([{title:"领取成功率",value:85.5,precision:1,trend:"up",percentage:4.2,description:"统计周期内：已领取量/策略请求下发量"},{title:"锁定成功率",value:99.99,precision:2,trend:"up",percentage:.01,description:"统计周期内：已锁定量/核心请求锁定量"},{title:"核销成功率",value:99.99,precision:2,trend:"up",percentage:.01,description:"统计周期内：已核销量/核心请求核销量"}]);n("ma"),n(null),n(null);const M=n([{type:"券包发放失败",content:"券包ID: CP20240101发放失败，请检查",time:"2024-01-15 10:30",status:"未处理"},{type:"券即将过期",content:"券ID: C20240101即将在3天后过期",time:"2024-01-14 15:20",status:"已处理"},{type:"券使用异常",content:"券ID: C20240102使用率低于5%，请关注",time:"2024-01-13 09:45",status:"未处理"}]);n([{value:35,name:"用户信息不匹配"},{value:25,name:"券已过期"},{value:20,name:"库存不足"},{value:15,name:"系统错误"},{value:5,name:"其他原因"}]);const F=n([{value:42,name:"用户信息不匹配"},{value:28,name:"券已过期"},{value:18,name:"库存不足"},{value:8,name:"系统错误"},{value:4,name:"其他原因"}]),m=n(null);let p=null;const h=()=>{if(!m.value||!m.value.clientWidth){setTimeout(h,100);return}p=K(m.value);const r={tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{orient:"vertical",right:10,top:"center",data:F.value.map(C=>C.name)},series:[{name:"领取失败原因",type:"pie",radius:["50%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"18",fontWeight:"bold"}},labelLine:{show:!1},data:F.value}]};p.setOption(r)},N=r=>{console.log("搜索值:",r),x()},x=async()=>{c.value=!0;try{await new Promise(r=>setTimeout(r,1e3)),h()}catch{Q.error("获取统计数据失败")}finally{c.value=!1}};q(L,()=>{x()});const w=()=>{};return G(()=>{x(),window.addEventListener("resize",w),h()}),H(()=>{window.removeEventListener("resize",w),p==null||p.dispose()}),(r,C)=>{const S=s("a-statistic"),u=s("a-card"),o=s("a-col"),v=s("a-row"),i=s("a-table-column"),P=s("a-tag"),D=s("a-table"),V=s("a-input-search"),O=s("a-button"),j=s("a-space"),J=s("a-badge");return l(),b("div",Y,[e(v,{gutter:[16,16]},{default:t(()=>[e(o,{span:24},{default:t(()=>[e(u,{title:"平台库存情况",loading:c.value},{default:t(()=>[e(v,{gutter:[16,16]},{default:t(()=>[(l(!0),b(z,null,R(T.value,(a,y)=>(l(),d(o,{span:6,key:y},{default:t(()=>[e(u,{class:"stat-card",bordered:!1},{default:t(()=>[e(S,{title:a.title,value:a.value,precision:a.precision||0,"value-style":{color:a.trend==="up"?"#00B42A":"#F53F3F",fontSize:"24px",fontWeight:600}},{prefix:t(()=>[a.trend==="up"?(l(),d(g(A),{key:0,style:{color:"#00B42A",fontSize:"20px"}})):(l(),d(g(I),{key:1,style:{color:"#F53F3F",fontSize:"20px"}}))]),suffix:t(()=>[_("span",{class:"trend-text",style:k({color:a.trend==="up"?"#00B42A":"#F53F3F",fontSize:"14px"})},f(a.percentage)+"% ",5)]),_:2},1032,["title","value","precision","value-style"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1},8,["loading"])]),_:1}),e(o,{span:24},{default:t(()=>[e(u,{title:"过程指标监控",loading:c.value},{default:t(()=>[e(v,{gutter:[16,16]},{default:t(()=>[(l(!0),b(z,null,R(E.value,(a,y)=>(l(),d(o,{span:8,key:y},{default:t(()=>[e(u,{class:"stat-card",bordered:!1},{default:t(()=>[e(S,{title:a.title,value:a.value,precision:a.precision||0,"value-style":{color:a.trend==="up"?"#00B42A":"#F53F3F",fontSize:"24px",fontWeight:600}},{prefix:t(()=>[a.trend==="up"?(l(),d(g(A),{key:0,style:{color:"#00B42A",fontSize:"20px"}})):(l(),d(g(I),{key:1,style:{color:"#F53F3F",fontSize:"20px"}}))]),suffix:t(()=>[_("span",{class:"trend-text",style:k({color:a.trend==="up"?"#00B42A":"#F53F3F",fontSize:"14px"})},f(a.percentage)+"% ",5)]),_:2},1032,["title","value","precision","value-style"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1},8,["loading"])]),_:1}),e(o,{span:24},{default:t(()=>[e(v,{gutter:[16,16]},{default:t(()=>[e(o,{span:12},{default:t(()=>[e(u,{title:"权益平台预警信息",loading:c.value},{default:t(()=>[e(D,{data:M.value,pagination:!1,scroll:{y:240}},{columns:t(()=>[e(i,{title:"预警类型","data-index":"type"}),e(i,{title:"预警内容","data-index":"content"}),e(i,{title:"预警时间","data-index":"time"}),e(i,{title:"状态","data-index":"status"},{cell:t(({record:a})=>[e(P,{color:a.status==="已处理"?"green":"red"},{default:t(()=>[B(f(a.status),1)]),_:2},1032,["color"])]),_:1})]),_:1},8,["data"])]),_:1},8,["loading"])]),_:1}),e(o,{span:12},{default:t(()=>[e(u,{title:"领取失败原因分析",loading:c.value},{default:t(()=>[_("div",{ref_key:"failureChartRef",ref:m,style:{width:"100%",height:"300px"}},null,512)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1}),e(o,{span:24},{default:t(()=>[e(u,{title:"数据统计明细",loading:c.value,class:"data-table-card"},{extra:t(()=>[e(j,null,{default:t(()=>[e(V,{placeholder:"搜索批次日期",style:{width:"200px"},"allow-clear":"",onSearch:N}),e(O,{type:"text"},{icon:t(()=>[e(g(X))]),default:t(()=>[B(" 导出数据 ")]),_:1})]),_:1})]),default:t(()=>[e(D,{data:W.value,pagination:{pageSize:10,showTotal:!0,showJumper:!0,showPageSize:!0},bordered:!1,stripe:""},{columns:t(()=>[e(i,{title:"批次日期","data-index":"batchDate",align:"center"}),e(i,{title:"下发量","data-index":"sendCount",align:"right"},{cell:t(({record:a})=>[_("span",Z,f(a.sendCount.toLocaleString()),1)]),_:1}),e(i,{title:"下发成功量","data-index":"successCount",align:"right"},{cell:t(({record:a})=>[_("span",$,f(a.successCount.toLocaleString()),1)]),_:1}),e(i,{title:"下发成功率","data-index":"successRate",align:"right"},{cell:t(({record:a})=>[e(J,{color:a.successRate>=80?"#00B42A":a.successRate>=60?"#FF7D00":"#F53F3F",text:a.successRate.toFixed(1)+"%"},null,8,["color","text"])]),_:1})]),_:1},8,["data"])]),_:1},8,["loading"])]),_:1})]),_:1})])}}},oe=U(ee,[["__scopeId","data-v-042fcbb1"]]);export{oe as default};
