## 问题复盘
- 目前“分支走廊”实现出现阶梯错位：同一条分支上的后续节点被分配到越来越大的 `laneId`，导致 Y 基线逐层下移，呈现斜线/阶梯效果。
- 原因：车道是用完整分支路径（如 `root.0.0.1`）派生，子层路径每深入一层都会变成新的唯一“车道”，而不是保持顶层分支的统一车道。

## 目标
- 同一顶层分支的所有后续节点在各层使用同一条车道（同一 Y 基线）；不同分支之间保持平行，不交叉。
- 横向按层列网格对齐；仅改变节点坐标，不改变连线（`router: 'normal'` + `connector: 'smooth'`），不写 `edge.vertices`。

## 修复方案
1) 车道派生规则调整：
- 将 `laneKey` 定义为“顶层分支键”，即分支路径 `root.X.*` 中的 `X`；
- 对所有节点，从其路径 `pathOf(id)` 提取顶层键：
  - `laneKey = path.includes('.') ? path.split('.')[1] : '0'`
  - 合流节点无路径或多父路径时，取多数父的顶层键；若仍冲突，取字典序最小键。
- 车道编号 `laneId` 来自按顶层键排序后的稳定映射（例如按数字/端口顺序/类型优先级）。

2) 层列网格与去重：
- `rankOf` 用自根 BFS（对无根或多根图，先选入度为 0 的所有节点作为根并逐个 BFS），保证整个图得到层索引；
- 坐标：`x = startX + rank * colSpacing`；`y = startY + laneId * laneGapY`；
- 同层同车道多个节点用 `rowOffset` 做轻微位移（±offset），仍在走廊内。

3)  防交叉与稳定性：
- 每层按 `laneId` -> `x` 稳定排序应用位置，避免层内穿插；
- 对不可达节点（孤立/环），给出警告，放到最左列或最近父列。

## 参数与扩展
- `colSpacing`（默认 260）、`laneGapY`（默认 240）、`rowOffset`（默认 16）、`startX/startY`（默认 80/120）。
- 车道排序策略可选：`portIndex` | `typePriority` | `idNumeric`（默认 `idNumeric`）。

## 验证
- 用你的示例图：顶层分支形成多条平行走廊，后续层保持同一 Y 基线，不再阶梯下沉；横向各层整齐对齐。
- 连线平滑、无控制点；缩放/拖拽新增节点坐标准确。

若确认，我将修改 `executeLaneGridLayout` 的车道派生逻辑（从顶层键派生），完善多根/不可达节点处理，并输出对齐统计日志以便验证。