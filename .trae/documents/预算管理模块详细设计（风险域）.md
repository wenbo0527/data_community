# 预算管理模块详细设计（风险域）

## 页面与路由
- 预算总览：`src/pages/budget/BudgetOverview.vue`（`src/router/index.js:408, 514`）
- 预算列表：`src/pages/budget/BudgetList.vue`（`src/router/index.js:421, 520`）
- 合同管理：`src/pages/budget/components/ContractManagement.vue`（`src/router/index.js:446, 545`）
- 预算监控：`src/pages/budget/BudgetMonitor.vue`（`src/router/index.js:459, 551`）
- 结算管理：`src/pages/budget/SettlementManagement.vue`（`src/router/index.js:465, 557`）

## Store 与 API
- 预算 Store：
  - 列表获取：`src/store/modules/budget.ts:54`
  - 上传占位：`src/store/modules/budget.ts:76–83`
  - 新增预算：`src/store/modules/budget.ts:86–93`
  - 删除预算：`src/store/modules/budget.ts:101–113`
- 预算 API：
  - 获取列表：`src/api/budget.ts:56–85`
  - 获取详情：`src/api/budget.ts:88–95`
  - 创建预算：`src/api/budget.ts:99–127`
  - 更新预算：`src/api/budget.ts:131–145`
  - 删除预算：`src/api/budget.ts:148–157`

## 关键组件
- 燃尽标签页组件：
  - 类型切换：`src/components/modals/BudgetBurndownTabs.vue:58`
  - 粒度切换：`src/components/modals/BudgetBurndownTabs.vue:64`
  - 数据刷新：`src/components/modals/BudgetBurndownTabs.vue:70`
  - 累积计算：`src/components/modals/BudgetBurndownTabs.vue:92`
  - 渲染更新：`src/components/modals/BudgetBurndownTabs.vue:116`

## 结算管理流程
- 创建任务：`src/pages/budget/SettlementManagement.vue:304–317`
- 启动任务与子任务进度：`src/pages/budget/SettlementManagement.vue:319–348`
- 生成/下载报告：`src/pages/budget/SettlementManagement.vue:365–381`
- 数据更新占位：`src/pages/budget/SettlementManagement.vue:385–387`
- 取消任务：`src/pages/budget/SettlementManagement.vue:389–395`

## 总览页职责
- 工作台式导航（预算列表/监控/合同/结算），示例：按钮点击跳转。
- KPI：当年预算总额、当前累积消耗、当年实际核销、预算健康度。
- 预算监控区：嵌入燃尽组件并支持跳转到监控页。
- 预算消耗预警列表：点击跳转监控页确认详情。

## 与其他模块的协同
- 与档案：从档案页携带 `archiveId/product` 进入预算域，KPI 与监控按产品维度过滤。
- 与评估：评估结论影响预算健康度与预警阈值（监控页体现）。
- 与服务：服务结果更新监控数据源，影响预算预警与结算触发。
- 与合同：预算异常定位到合同条目，进入结算流程。

## 指标与口径
- KPI 与燃尽图在总览与监控保持一致口径；累计消耗/实际核销基于合同与核销记录汇总。
- 预警偏离率计算在监控页与总览页一致，TopN排序。

## 迭代与落地
- 打通结算报告写回合同域与预算核销，完善闭环（`updateData` 后端联调）。
- 统一跨模块跳转协议的上下文解析（`archiveId/from/product/tab`）。
- 将预算监控的异常事件转化为结算任务建议与自动化流程。
