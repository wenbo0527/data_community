**问题定位**
- 现有总线计算在 [Canvas2_5D.vue:busLines](file:///Users/mac/nis_mock/data_comunity/data_comunity/src/components/architecture/Canvas2_5D.vue#L145-L183) 中：
  - 使用“跨层代表节点连线（源层→目标层中位节点）”的方向与长度来生成总线。
  - 这导致“数据源→数据仓库”的总线不保证与目标层内的 DWS→ODS 参照连线平行且等长。
- 因此与需求不符：总线应平行且等长于“目标层内的参照连线”（如 DWS→ODS）。

**通用修复算法**
- 对于每一层配对 L→L+1：
  1. 计算源层与目标层矩形主对角线中点（来自 [layerPolygons](file:///Users/mac/nis_mock/data_comunity/data_comunity/src/components/architecture/Canvas2_5D.vue#L212-L268)），再取两者的中点 C 作为总线的中心位置。
  2. 选择目标层的“参照连线”方向与长度：
     - 优先使用配置的参照节点对（例如 L=0 的目标层：['dws','ods']）。
     - 若缺失或节点不足，则回退为目标层节点集合的主轴方向（PCA/最大跨度对）与该跨度长度。
  3. 令 u 为目标层参照连线的单位方向，L_ref 为其长度；计算总线端点：
     - A = C − u × (L_ref/2)
     - B = C + u × (L_ref/2)
- 节点↔总线连接：保持现有“投影到 AB 线段”的方式（正交投影并裁剪到段内），确保连接严格基于节点实际坐标。

**实施步骤**
1. 在 Canvas2_5D.vue 中新增“层→目标层参照对”配置：
   - 例如 const layerRefPairs: Record<number,[string,string]> = { 0: ['dws','ods'] }；可通过 opts 传入覆盖。
2. 重写 busLines：
   - 从 layerPolygons 取源层/目标层主对角线中点，计算 C。
   - 从 layerRefPairs 或回退策略获取目标层参照向量及长度（读取 nodesPx）。
   - 用该方向与长度生成总线端点 A、B。
3. 保留 edgesBus 的投影锚点逻辑，但将投影基准改为新生成的 AB。
4. 在 ArchitectureChart.vue 的工具栏增加“同层参照对”可选项（可选），或在 opts.flowMode 保持 bus 模式下使用上述计算。

**验证方案**
- 日志输出：
  - 打印每个层对的参照连线（节点 id、向量、长度），总线端点与中心。
- 视觉验证：
  - 数据源→数据仓库：总线与 DWS→ODS 的方向一致、长度相等；位置位于两层对角线中点之间。
- 边界用例：
  - 目标层节点不足 2 个时，回退到主轴或最大跨度计算；确保不会崩溃。

**配置与扩展**
- 支持在 opts 中传入 refPairs: Record<number,[string,string]>，用于指定各层的参照连线。
- 若未来采用“泳道+插槽”规范，可将参照对切换为“泳道内的两端节点”，算法保持不变。

请确认上述计划；确认后我将按该方案实现并验证显示效果。