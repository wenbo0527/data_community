# 横向画布节点样式设计与实现规范

## 1. 产品概述

本文档基于横向画布的真实代码实现，定义了营销画布系统中节点的视觉样式、交互行为和数据结构规范。采用 AntV X6 图形引擎 + Vue 3 + TypeScript 技术栈，确保节点样式与现有代码实现完全一致。

**核心特点：**

* 横向布局：左进右出，目标节点必须在右侧

* 统一图标：所有节点使用固定的蓝绿色图标 (#14B8A6)

* 动态端口：分流类型节点每行内容对应一个输出端口

* 数据兼容：支持历史数据格式，保持向后兼容

## 2. 实际支持的节点类型

基于 `buildDisplayLines` 函数的真实实现，横向画布支持以下节点类型：

| 节点类型        | 显示标签 | 图标文本 | 内容行数              | 端口类型 |
| ----------- | ---- | ---- | ----------------- | ---- |
| start       | 开始   | ST   | 2行（任务类型、目标人群）     | 单输出  |
| crowd-split | 人群分流 | CS   | 动态（命中N行 + 否则）     | 多输出  |
| event-split | 事件分流 | ES   | 2行（命中、等待超时）       | 双输出  |
| ab-test     | AB实验 | AB   | 动态（每变体1行）         | 多输出  |
| ai-call     | AI外呼 | AI   | 1行（触达任务ID）        | 单输出  |
| sms         | 短信触达 | SM   | 1行（短信模板）          | 单输出  |
| manual-call | 人工外呼 | MC   | 1-2行（配置ID + 可选描述） | 单输出  |
| wait        | 等待节点 | WA   | 1行（等待时长）          | 单输出  |
| benefit     | 权益节点 | BE   | 1行（权益包名称）         | 单输出  |
| end         | 结束节点 | EN   | 无内容               | 无端口  |

**注意：** 横向画布实际不支持 email、wechat、task 节点类型

## 3. 节点样式规范

### 3.1 整体布局结构

**节点区域划分（左右结构）：**

```
┌─────────────────────────────────────────────────┐
│ [图标] 节点名称                          [···] │ ← 标题区 (36px)
├─────────────────────────────────────────────────┤
│ ○ 任务类型：营销活动                    ●     │ ← 内容区 (动态高度)
│   目标人群：新用户、活跃用户            ●     │     端口附着在内容区左右边缘
└─────────────────────────────────────────────────┘
```

**基础尺寸：**

* **固定宽度**：280px
* **动态高度**：`max(96, headerHeight + contentPadding + max(1, rows.length) × rowHeight + 12)` px
  * headerHeight: 36px
  * contentPadding: 12px  
  * rowHeight: 32px
  * 底部边距: 12px
* **最小高度**：96px

**关键理解：**
- 端口直接附着在内容区的左右边缘，没有独立的"端口区"
- 左右结构指的是端口相对于内容区的位置
- 输入端口位于内容区左侧中心，输出端口位于内容区右侧每行中点

**视觉图示：**
```
┌─────────────────────────────────────────────────┐
│ [图标] 节点名称                          [···] │ ← 标题区 (36px)
├─────────────────────────────────────────────────┤
│ ○ 任务类型：营销活动                    ●     │ ← 内容区 (动态高度)
│   目标人群：新用户、活跃用户            ●     │     端口附着在内容区边缘
└─────────────────────────────────────────────────┘
      ↑                                      ↑
   输入端口                            输出端口（每行一个）
```

**端口对齐原理：**
- 输入端口：对齐到内容区垂直中心（contentCenter）
- 输出端口：每行文本对应一个端口，对齐到行中点（lineCenter）
- 使用 AntV X6 的 `position: 'left'` 和 `position: 'right'` 定位
- `dy` 参数相对于节点中心点的垂直偏移

### 3.2 标题区设计

**视觉规范：**

```javascript
// 实际代码中的样式定义
'header': { 
  fill: '#F8FAFC', 
  stroke: '#E5E7EB', 
  strokeWidth: 1, 
  rx: 8, ry: 8, 
  ref: 'body', 
  refX: 0, refY: 0, 
  refWidth: '100%', 
  height: 36 
}
```

**组成元素：**

1. **图标块**：28×20px，圆角 6px，位置 (12, 8)
2. **图标文本**：取 nodeType 前2字符大写，12px 白色，居中
3. **节点标题**：48px 左边距，13px 粗体，颜色 #111827
4. **更多菜单**：3个圆点，位置 (宽度-24/18/12, 16)，仅非 start/end 显示

**代码位置：**

* 创建：`src/pages/marketing/tasks/horizontal/index.vue:240-243`（端口配置参数）
* 创建：`src/pages/marketing/tasks/horizontal/index.vue:258-261`（标题区样式）

* 更新：`src/pages/marketing/tasks/horizontal/index.vue:413-416`（端口配置参数）
* 更新：`src/pages/marketing/tasks/horizontal/index.vue:431-434`（标题区样式）

### 3.3 内容区设计

**区域特性：**
- 包含所有文本内容和端口
- 端口附着在内容区的左右边缘
- 动态高度根据内容行数变化

**布局规则：**

* **起始位置**：标题区底部 + 12px 内边距 = 48px

* **行高**：32px

* **文本对齐**：左对齐，x=16px，textAnchor='start'

* **文本基线**：行中点 + 5px 视觉调整

**端口附着位置：**
- **输入端口**：内容区左侧中心，对齐到内容区垂直中心
- **输出端口**：内容区右侧，每行文本对应一个端口
- **端口垂直位置**：对齐到对应行的中点

**计算基准：**
```
内容区起始Y = headerHeight + contentPadding = 48px
内容区中心Y = contentCenter = headerHeight + contentPadding + contentHeight/2
行中点Y = lineCenter(i) = headerHeight + contentPadding + i*rowHeight + rowHeight/2
```

**代码实现：**
```javascript
// 计算内容区中心和行中点
const contentCenter = headerHeight + contentPadding + Math.floor(contentHeight / 2)
const verticalOffsets = isSplit
  ? rows.map((_, i) => headerHeight + contentPadding + i * rowHeight + Math.floor(rowHeight / 2))
  : [contentCenter]
```

* 基线调整：行中点 + 5px，确保视觉居中

**样式定义：**

```javascript
// 每行文本样式
`row-${i}`: {
  text: text,
  fill: '#111827',
  fontSize: 13,
  textAnchor: 'start',
  x: 16,
  y: v + baselineAdjust  // v = 行中点位置
}
```

**代码位置：**

* 创建：`src/pages/marketing/tasks/horizontal/index.vue:265-272`

* 更新：`src/pages/marketing/tasks/horizontal/index.vue:438-445`

### 3.4 端口附着规则

**附着原理：**
节点采用**左右结构**布局，端口直接附着在内容区边缘，没有独立的端口区域：

### 2.1 标题区（顶部）
- **位置**：节点顶部，全宽度
- **高度**：36px
- **背景**：#F8FAFC
- **内容**：节点图标、标题文本、菜单按钮
- **边框**：底部1px实线 #E5E7EB
- **注意**：标题区不是端口区的一部分

### 2.2 内容区（中部，动态高度）
- **位置**：标题区下方
- **高度**：根据文本行数动态计算（每行32px）
- **内边距**：12px（上下）
- **背景**：#FFFFFF
- **内容**：多行文本内容，每行32px高度
- **端口位置**：
  - **输入端口**：左侧边缘，垂直对齐内容区中心
  - **输出端口**：右侧边缘，每行文本对应一个端口

### 2.3 端口布局算法

#### 输入端口位置计算
```
contentCenter = headerHeight + contentPadding + contentHeight/2
inVerticalOffset = contentCenter
```

#### 输出端口位置计算
```
// 每行中点位置
lineCenter(i) = headerHeight + contentPadding + i*rowHeight + rowHeight/2
// 端口偏移量（相对于节点中心）
dy = verticalOffset - nodeHeight/2
```

### 2.4 关键理解
- **端口是内容区的一部分**：端口直接附着在内容区的左右边缘，没有独立的"端口区"
- **左右结构**：指的是端口相对于内容区的位置关系（左侧输入，右侧输出）
- **动态对齐**：输入端口始终对齐内容区垂直中心，输出端口对应每行文本中点

**视觉图示：**
```
┌─────────────────────────────────────────────────┐
│ [图标] 节点名称                          [···] │ ← 标题区 (36px)
├─────────────────────────────────────────────────┤
│ ○ 任务类型：营销活动                    ●     │ ← 内容区 (动态高度)
│   目标人群：新用户、活跃用户            ●     │     端口附着在内容区边缘
└─────────────────────────────────────────────────┘
      ↑                                      ↑
   输入端口                            输出端口（每行一个）
```

**端口对齐原理：**
- 输入端口：对齐到内容区垂直中心（contentCenter）
- 输出端口：每行文本对应一个端口，对齐到行中点（lineCenter）
- 使用 AntV X6 的 `position: 'left'` 和 `position: 'right'` 定位
- `dy` 参数相对于节点中心点的垂直偏移

### 3.2 标题区设计

**视觉规范：**

```javascript
// 实际代码中的样式定义
'header': { 
  fill: '#F8FAFC', 
  stroke: '#E5E7EB', 
  strokeWidth: 1, 
  rx: 8, ry: 8, 
  ref: 'body', 
  refX: 0, refY: 0, 
  refWidth: '100%', 
  height: 36 
}
```

**组成元素：**

1. **图标块**：28×20px，圆角 6px，位置 (12, 8)
2. **图标文本**：取 nodeType 前2字符大写，12px 白色，居中
3. **节点标题**：48px 左边距，13px 粗体，颜色 #111827
4. **更多菜单**：3个圆点，位置 (宽度-24/18/12, 16)，仅非 start/end 显示

**代码位置：**

* 创建：`src/pages/marketing/tasks/horizontal/index.vue:240-243`（端口配置参数）
* 创建：`src/pages/marketing/tasks/horizontal/index.vue:258-261`（标题区样式）

* 更新：`src/pages/marketing/tasks/horizontal/index.vue:413-416`（端口配置参数）
* 更新：`src/pages/marketing/tasks/horizontal/index.vue:431-434`（标题区样式）

### 3.3 内容区设计

**区域特性：**
- 包含所有文本内容和端口
- 端口附着在内容区的左右边缘
- 动态高度根据内容行数变化

**布局规则：**

* **起始位置**：标题区底部 + 12px 内边距 = 48px

* **行高**：32px

* **文本对齐**：左对齐，x=16px，textAnchor='start'

* **文本基线**：行中点 + 5px 视觉调整

**端口附着位置：**
- **输入端口**：内容区左侧中心，对齐到内容区垂直中心
- **输出端口**：内容区右侧，每行文本对应一个端口
- **端口垂直位置**：对齐到对应行的中点

**计算基准：**
```
内容区起始Y = headerHeight + contentPadding = 48px
内容区中心Y = contentCenter = headerHeight + contentPadding + contentHeight/2
行中点Y = lineCenter(i) = headerHeight + contentPadding + i*rowHeight + rowHeight/2
```

**代码实现：**
```javascript
// 计算内容区中心和行中点
const contentCenter = headerHeight + contentPadding + Math.floor(contentHeight / 2)
const verticalOffsets = isSplit
  ? rows.map((_, i) => headerHeight + contentPadding + i * rowHeight + Math.floor(rowHeight / 2))
  : [contentCenter]
```

* 基线调整：行中点 + 5px，确保视觉居中

**样式定义：**

```javascript
// 每行文本样式
`row-${i}`: {
  text: text,
  fill: '#111827',
  fontSize: 13,
  textAnchor: 'start',
  x: 16,
  y: v + baselineAdjust  // v = 行中点位置
}
```

**代码位置：**

* 创建：`src/pages/marketing/tasks/horizontal/index.vue:265-272`

* 更新：`src/pages/marketing/tasks/horizontal/index.vue:438-445`

### 3.4 端口附着规则

**附着原理：**
端口直接附着在内容区的左右边缘，没有独立的端口区域。左右结构指的是端口相对于内容区的位置。

**端口样式：**
- 输入端口：左侧，白色填充，蓝色边框 (#4C78FF)
- 输出端口：右侧，蓝色填充 (#4C78FF)
- 端口大小：半径 4px
- 连接点：支持磁力吸附

**输入端口附着：**
- **位置**：内容区左侧中心
- **对齐**：对齐到内容区垂直中心
- **算法**：`dyIn = inVerticalOffset - nodeHeight/2`
- **参数**：`inVerticalOffset = contentCenter`

**输出端口附着：**
- **位置**：内容区右侧，每行文本对应一个端口
- **对齐**：端口垂直位置对齐到对应行的中点
- **算法**：`dy = verticalOffsets[i] - nodeHeight/2`
- **参数**：`verticalOffsets[i] = lineCenter(i)`

**端口配置参数：**
```javascript
{
  includeIn: true,           // 包含输入端口
  outIds: ['out-0', 'out-1'], // 输出端口ID数组
  verticalOffsets: [116, 148], // 每行中点的Y坐标数组
  nodeHeight: 180,            // 节点总高度
  inVerticalOffset: 132       // 输入端口Y坐标（内容区中心）
}
```

**关键理解：**
- 端口使用 AntV X6 的 `position: 'left'` 和 `position: 'right'` 定位
- `dy` 参数控制端口的垂直偏移，相对于节点中心点
- `inVerticalOffset` 和 `verticalOffsets` 计算的是绝对Y坐标，需要减去 `nodeHeight/2` 得到相对偏移

**代码位置：**
- 端口工厂：`src/pages/marketing/tasks/horizontal/utils/portConfigFactoryHorizontal.js:1-46`
- 创建传入：`src/pages/marketing/tasks/horizontal/index.vue:240-243`
- 更新传入：`src/pages/marketing/tasks/horizontal/index.vue:413-416`

**端口配置参数：**
```javascript
{
  includeIn: true,           // 包含输入端口
  outIds: ['out-0', 'out-1'], // 输出端口ID数组
  verticalOffsets: [116, 148], // 每行中点的Y坐标数组
  nodeHeight: 180,            // 节点总高度
  inVerticalOffset: 132       // 输入端口Y坐标（内容区中心）
}
```
  inVerticalOffset: 132       // 输入端口垂直偏移（内容区中心）
}
```

**端口工厂：**

* 位置：`src/pages/marketing/tasks/horizontal/utils/portConfigFactoryHorizontal.js`

* 参数：`createHorizontalPortConfig(outCount, { verticalOffsets, nodeHeight, inVerticalOffset })`

### 3.5 图标颜色说明

**重要：** 横向画布中所有节点图标统一使用固定的蓝绿色 (#14B8A6)，不根据节点类型变化。

```javascript
// 统一的图标颜色（实际代码）
'header-icon': { 
  fill: '#14B8A6', 
  stroke: '#14B8A6',
  rx: 6, ry: 6 
}
```

## 4. 分支节点每行UI样式设计

### 4.1 人群分流 (crowd-split)

**内容行格式：**

```
第1行：命中：{crowdName1}
第2行：命中：{crowdName2}
...    
第N行：否则：{unmatchBranch.name}
```

**端口对应：**

* 第1行 ←→ out-0 端口

* 第2行 ←→ out-1 端口

* 第N行 ←→ out-(N-1) 端口（未命中分支）

**数据兼容性：**

```javascript
// 支持多种数据结构
const layers = config?.crowdLayers || []
const branches = config?.branches || []
const splitCount = config?.splitCount || 0

// 优先级：crowdLayers > branches > splitCount
if (layers.length) {
  layers.forEach(l => lines.push(`命中：${l.crowdName}`))
  lines.push(`否则：${config.unmatchBranch?.name || '未命中人群'}`)
}
```

### 4.2 事件分流 (event-split)

**固定两行内容：**

```
第1行：命中：{yesLabel || '是'}
第2行：等待 {timeout} 分钟未命中
```

**端口对应：**

* 第1行 ←→ out-0 端口（命中分支）

* 第2行 ←→ out-1 端口（未命中分支）

### 4.3 AB实验 (ab-test)

**动态行格式：**

```
第1行：{branch1.name}：{percentage}%
第2行：{branch2.name}：{percentage}%
...
第N行：{branchN.name}：{percentage}%
```

**数据兼容：**

```javascript
// 支持多种变体配置格式
const branches = config?.branches || []
const variants = config?.variants || []
const versions = config?.versions || []
const merged = branches.length ? branches : (variants.length ? variants : versions)

merged.forEach((b, i) => {
  const name = b?.name || `变体${String.fromCharCode(65 + i)}`
  const pct = b?.percentage != null ? b.percentage : (b?.ratio != null ? b.ratio : '')
  lines.push(`${name}：${pct}%`)
})
```

## 5. 数据格式定义

### 5.1 节点基础结构

```typescript
interface NodeData {
  id: string
  type: string // 实际节点类型
  nodeType?: string // 兼容字段
  config: NodeConfig
  isConfigured?: boolean
  position: { x: number, y: number }
  size?: { width: number, height: number }
}

interface NodeConfig {
  // 通用字段
  nodeName?: string // 自定义名称
  description?: string // 描述
  
  // 开始节点
  taskType?: string
  targetAudience?: string[]
  
  // 人群分流
  crowdLayers?: Array<{crowdName: string}>
  branches?: Array<{name: string}>
  unmatchBranch?: {name: string}
  splitCount?: number
  
  // 事件分流
  yesLabel?: string
  timeout?: number
  
  // AB实验
  variants?: Array<{name: string, percentage: number}>
  versions?: Array<{name: string, ratio: number}>
  
  // 触达节点
  taskId?: string // AI外呼
  smsTemplate?: string // 短信
  configId?: string // 人工外呼
  
  // 其他节点
  value?: number // 等待
  unit?: string // 等待
  benefitName?: string // 权益
}
```

### 5.2 兼容性处理

```javascript
// 节点类型标准化
const nodeType = data?.type || data?.nodeType || 'unknown'

// 人群分流别名处理
const actualType = nodeType === 'crowd-split' ? 'audience-split' : nodeType

// 变体数据统一
const variants = config?.branches || config?.variants || config?.versions || []
```

## 6. 核心组件与代码位置

### 6.1 主要组件

**CanvasController**

* 位置：`src/pages/marketing/tasks/horizontal/services/CanvasController.js`

* 职责：协调事件服务、管理画布状态

* 依赖：EventService、配置系统

**EventService**

* 位置：`src/pages/marketing/tasks/horizontal/services/EventService.js`

* 职责：处理节点交互、连接管理

* 功能：节点点击、连接删除、节点插入

### 6.2 核心函数

**节点创建**

```javascript
function createRectNode({ id, x, y, label, outCount = 1, data = {}, portsOptions = {} })
// 位置：src/pages/marketing/tasks/horizontal/index.vue:228-275
```

**数据映射**

```javascript
function buildDisplayLines(nodeType, config = {})
// 位置：src/pages/marketing/tasks/horizontal/index.vue:335-391
```

**节点更新**

```javascript
function updateNodeFromConfig(node, nodeType, config)
// 位置：src/pages/marketing/tasks/horizontal/index.vue:403-454
```

**端口工厂**

```javascript
export function createHorizontalPortConfig(outCount = 1, options = {})
// 位置：src/pages/marketing/tasks/horizontal/utils/portConfigFactoryHorizontal.js:1-35
```

## 7. 交互行为

### 7.1 节点交互

**点击行为：**

* 左键点击：打开配置抽屉

* 入口：`useConfigDrawers.openConfigDrawer(type, node, data)`

* 位置：`src/pages/marketing/tasks/horizontal/services/EventService.js:70`

**更多菜单：**

* 显示条件：非 start/end 节点

* 功能：重命名、复制、删除

* 位置：固定在标题右上角

### 7.2 连接交互

**连接删除：**

* 右键连接线：删除连接

* 位置：`src/pages/marketing/tasks/horizontal/services/EventService.js:50`

**节点插入：**

* 连接线上悬停显示 + 号

* 点击后在中点插入新节点

* 位置：`src/pages/marketing/tasks/horizontal/services/EventService.js:15-42`

### 7.3 更新流程

**配置更新链：**

```
抽屉确认 → 事件触发 → 节点刷新 → 视觉更新
```

**事件触发：**

```javascript
// 监听事件并更新节点
function updateNodeFromConfig(node, nodeType, config) {
  // 1. 重算显示行
  const rows = buildDisplayLines(nodeType, config)
  // 2. 重算节点尺寸
  const height = headerHeight + contentPadding + rows.length * rowHeight + 12
  // 3. 重算端口配置
  const ports = createHorizontalPortConfig(...)
  // 4. 更新视觉
  node.resize(width, height)
  node.setMarkup(...)
  node.setAttrs(...)
}
```

**节点刷新：**

```javascript
// 监听事件并更新节点
function updateNodeFromConfig(node, nodeType, config) {
  // 1. 重算显示行
  const rows = buildDisplayLines(nodeType, config)
  // 2. 重算节点尺寸
  const height = headerHeight + contentPadding + rows.length * rowHeight + 12
  // 3. 重算端口配置
  const ports = createHorizontalPortConfig(...)
  // 4. 更新视觉
  node.resize(width, height)
  node.setMarkup(...)
  node.setAttrs(...)
}
```

## 8. 测试与验收标准

### 8.1 分支节点专项测试

**人群分流测试：**

* ✓ 修改分支数量：行数与 out-i 端口数量同步变化

* ✓ 每行右侧端口垂直居中对齐

* ✓ 未命中分支始终显示在最后

* ✓ 支持 crowdLayers/branches/splitCount 多种配置

**事件分流测试：**

* ✓ 固定显示两行内容

* ✓ 超时配置正确显示"等待 X 分钟未命中"

* ✓ 两个输出端口位置准确

**AB实验测试：**

* ✓ 变体数量动态调整

* ✓ 百分比显示格式统一

* ✓ 支持 branches/variants/versions 格式

### 8.2 视觉一致性测试

**图标统一性：**

* ✓ 所有节点图标颜色统一为 #14B8A6

* ✓ 图标文本截取规则一致（前2字符大写）

* ✓ 图标块尺寸和位置统一

**内容对齐：**

* ✓ 文本左对齐，x=16px

* ✓ 基线调整 +5px，视觉居中

* ✓ 行高 32px，间距均匀

### 8.3 数据兼容性测试

**历史数据兼容：**

* ✓ crowd-split 正确映射到人群分流逻辑

* ✓ nodeType/type 字段兼容处理

* ✓ 旧版 splitCount 配置识别

**配置更新：**

* ✓ 配置变更实时反映到节点显示

* ✓ 取消配置恢复原始状态

* ✓ 复杂配置正确渲染

## 9. 性能基准

**渲染性能：**

* 单节点创建：≤ 30ms

* 批量更新（10个节点）：≤ 150ms

* 复杂分流节点（10分支）：≤ 80ms

**内存使用：**

* 单个节点内存占用：≤ 8KB

* 事件监听器及时清理

* 无内存泄漏风险

## 10. 扩展指南

### 10.1 新增节点类型

**步骤：**

1. 在 `buildDisplayLines` 中添加数据映射逻辑
2. 更新 `getOutCountByType` 函数确定端口数量
3. 在节点类型选择器中添加支持
4. 添加对应的配置抽屉组件

**示例模板：**

```javascript
case 'new-type':
  if (config?.field1) lines.push(`显示：${config.field1}`)
  if (config?.field2) lines.push(`内容：${config.field2}`)
  break
```

### 10.2 样式定制

**颜色主题：**

* 图标颜色：修改 `'header-icon'` 的 fill 属性

* 文本颜色：修改 `'row-${i}'` 的 fill 属性

* 背景颜色：修改 `'body'` 的 fill 属性

**尺寸调整：**

* 节点宽度：修改 `const width = 280`

* 行高：修改 `const rowHeight = 32`

* 标题高度：修改 `const headerHeight = 36`

## 关键代码索引

**核心实现：**

* 节点创建：`src/pages/marketing/tasks/horizontal/index.vue:228-275`
* 数据映射：`src/pages/marketing/tasks/horizontal/index.vue:335-391`
* 节点更新：`src/pages/marketing/tasks/horizontal/index.vue:403-454`
* 端口工厂：`src/pages/marketing/tasks/horizontal/utils/portConfigFactoryHorizontal.js:1-46`
* 端口配置参数：`src/pages/marketing/tasks/horizontal/index.vue:240-243`（创建）
* 端口配置参数：`src/pages/marketing/tasks/horizontal/index.vue:413-416`（更新）

**端口布局核心：**
* 内容区中心计算：`contentCenter = headerHeight + contentPadding + contentHeight/2`
* 行中点计算：`lineCenter(i) = headerHeight + contentPadding + i*rowHeight + rowHeight/2`
* 端口偏移算法：`dy = verticalOffset - nodeHeight/2`

**事件交互：**

* 事件服务：`src/pages/marketing/tasks/horizontal/services/EventService.js`

* 抽屉触发：`src/pages/marketing/tasks/composables/canvas/useConfigDrawers.js:229-235`

**组件文件：**

* 节点配置抽屉：`src/pages/marketing/tasks/components/canvas/NodeConfigDrawer.vue`

* 节点类型选择器：`src/pages/marketing/tasks/components/canvas/NodeTypeSelector.vue`

* 画布控制器：`src/pages/marketing/tasks/horizontal/services/CanvasController.js`

**工具函数：**

* 节点标签：`getNodeLabel()` in `src/utils/nodeTypes.js`

* 节点配置：`getNodeConfig()` in `src/utils/nodeTypes.js`

***

**文档说明：** 本文档完全基于横向画布的真实代码实现编写，确保与实际功能保持一致。所有样式参数、颜色值、尺寸数据均来自源代码，可直接作为开发和测试的参考依据。
