# 营销画布节点功能测试计划

## 1. 测试概述

本测试计划旨在全面验证营销画布系统中所有节点类型的创建、配置、连接和删除功能，确保每种节点类型都能正确识别并匹配相应的配置抽屉。

### 1.1 测试目标
- 验证所有节点类型的拖拽创建功能
- 确保节点配置抽屉与节点类型完全匹配
- 测试节点配置的保存和读取功能
- 验证预览线生成和节点连接功能
- 测试节点删除功能的正确性
- 确保节点类型识别的准确性

### 1.2 测试环境
- 开发环境：Vue 3 + Vite + AntV X6
- 测试浏览器：Chrome、Firefox、Safari
- 测试设备：桌面端和移动端

## 2. 测试范围

### 2.1 实际支持的节点类型分析

根据代码分析，系统实际支持以下**9种**节点类型，这些节点类型在NodeConfigDrawer.vue中都有完整的配置支持：

#### 2.1.1 完全支持的节点类型（9种）
| 节点类型 | 中文名称 | 颜色标识 | 最大输出数 | 配置复杂度 | 状态 |
|---------|---------|---------|-----------|-----------|------|
| start | 开始节点 | #5F95FF | 1 | 中等 | ✅ 完整支持 |
| audience-split | 人群分流 | #FF6A6A | 动态 | 复杂 | ✅ 完整支持 |
| event-split | 事件分流 | #69C0FF | 2 | 复杂 | ✅ 完整支持 |
| sms | 短信触达 | #45B7D1 | 1 | 中等 | ✅ 完整支持 |
| ai-call | AI外呼 | #96CEB4 | 1 | 中等 | ✅ 完整支持 |
| manual-call | 人工外呼 | #FFEAA7 | 1 | 中等 | ✅ 完整支持 |
| ab-test | AB测试 | #DDA0DD | 2 | 复杂 | ✅ 完整支持 |
| wait | 等待节点 | #A8A8A8 | 1 | 简单 | ✅ 完整支持 |
| benefit | 权益节点 | #FFD700 | 1 | 中等 | ✅ 完整支持 |

### 2.2 测试范围确认

本测试计划将专注于以上**9种**完全支持的节点类型，确保测试的一致性和可靠性。

### 2.3 测试功能模块
1. **节点创建模块**：拖拽新建节点功能
2. **节点配置模块**：配置抽屉匹配和表单验证
3. **节点连接模块**：预览线生成和节点连接
4. **节点管理模块**：节点删除和编辑功能
5. **类型识别模块**：节点类型获取和验证

## 3. 详细测试用例

### 3.1 节点创建测试

#### 3.1.1 基础创建测试
**测试目标**：验证所有9种节点类型都能通过拖拽成功创建

| 测试用例ID | 节点类型 | 测试步骤 | 预期结果 |
|-----------|---------|---------|---------|
| TC_CREATE_001 | start | 从节点选择器拖拽开始节点到画布 | 节点成功创建，显示正确的标签和颜色 |
| TC_CREATE_002 | audience-split | 拖拽人群分流节点到画布 | 节点创建成功，显示"人群分流"标签 |
| TC_CREATE_003 | event-split | 拖拽事件分流节点到画布 | 节点创建成功，显示"事件分流"标签 |
| TC_CREATE_004 | sms | 拖拽短信触达节点到画布 | 节点创建成功，显示"短信触达"标签 |
| TC_CREATE_005 | ai-call | 拖拽AI外呼节点到画布 | 节点创建成功，显示"AI外呼"标签 |
| TC_CREATE_006 | manual-call | 拖拽人工外呼节点到画布 | 节点创建成功，显示"人工外呼"标签 |
| TC_CREATE_007 | ab-test | 拖拽AB测试节点到画布 | 节点创建成功，显示"AB测试"标签 |
| TC_CREATE_008 | wait | 拖拽等待节点到画布 | 节点创建成功，显示"等待节点"标签 |
| TC_CREATE_009 | benefit | 拖拽权益节点到画布 | 节点创建成功，显示"权益节点"标签 |

#### 3.1.2 节点属性验证测试
**测试目标**：验证创建的节点具有正确的属性配置

| 测试用例ID | 验证项 | 测试方法 | 预期结果 |
|-----------|-------|---------|---------|
| TC_ATTR_001 | 节点颜色 | 检查节点的填充颜色是否与配置一致 | 每种节点类型显示正确的颜色 |
| TC_ATTR_002 | 节点尺寸 | 测量节点的宽度和高度 | 所有节点尺寸为100x100像素 |
| TC_ATTR_003 | 节点形状 | 验证节点的形状属性 | 所有节点都是圆形 |
| TC_ATTR_004 | 端口配置 | 检查节点的输入输出端口 | 端口数量和位置符合配置 |

### 3.2 配置抽屉匹配测试

#### 3.2.1 抽屉打开测试
**测试目标**：验证双击节点能正确打开对应的配置抽屉

| 测试用例ID | 节点类型 | 测试步骤 | 预期结果 |
|-----------|---------|---------|---------|
| TC_DRAWER_001 | start | 双击开始节点 | 打开开始节点配置抽屉，显示任务类型选择 |
| TC_DRAWER_002 | audience-split | 双击人群分流节点 | 打开人群分流配置抽屉，显示分流设置 |
| TC_DRAWER_003 | event-split | 双击事件分流节点 | 打开事件分流配置抽屉，显示事件配置 |
| TC_DRAWER_004 | sms | 双击短信触达节点 | 打开短信配置抽屉，显示短信模板设置 |
| TC_DRAWER_005 | ai-call | 双击AI外呼节点 | 打开AI外呼配置抽屉，显示外呼脚本设置 |
| TC_DRAWER_006 | manual-call | 双击人工外呼节点 | 打开人工外呼配置抽屉，显示外呼任务设置 |
| TC_DRAWER_007 | ab-test | 双击AB测试节点 | 打开AB测试配置抽屉，显示实验变体设置 |
| TC_DRAWER_008 | wait | 双击等待节点 | 打开等待配置抽屉，显示等待时间设置 |
| TC_DRAWER_009 | benefit | 双击权益节点 | 打开权益配置抽屉，显示权益内容设置 |

#### 3.2.2 配置表单验证测试
**测试目标**：验证每种节点类型的配置表单显示正确的字段

| 节点类型 | 必需字段 | 可选字段 | 特殊验证 |
|---------|---------|---------|---------|
| start | 任务类型、目标人群 | 描述 | 任务类型不能为空 |
| audience-split | 分流数量、分流方式 | 描述 | 分流数量≥2 |
| event-split | 事件列表 | 描述 | 至少配置一个事件 |
| sms | 短信模板 | 发送时间、描述 | 模板内容不能为空 |
| email | 邮件模板、主题 | 发送时间、描述 | 主题和内容不能为空 |
| wechat | 消息类型、内容 | 发送时间、描述 | 内容不能为空 |
| ai-call | 外呼脚本 | 重试次数、描述 | 脚本不能为空 |
| manual-call | 外呼任务 | 优先级、描述 | 任务描述不能为空 |
| ab-test | 实验变体 | 流量分配、描述 | 至少2个变体 |
| wait | 等待时间 | 描述 | 时间必须>0 |
| condition | 判断条件 | 描述 | 条件表达式不能为空 |
| benefit | 权益类型、内容 | 有效期、描述 | 权益内容不能为空 |
| task | 任务类型、内容 | 截止时间、描述 | 任务内容不能为空 |
| end | - | 描述 | 无必需字段 |

### 3.3 节点连接测试

#### 3.3.1 预览线生成测试
**测试目标**：验证节点间的预览线能正确生成

| 测试用例ID | 源节点类型 | 目标节点类型 | 预期结果 |
|-----------|-----------|-------------|---------|
| TC_CONNECT_001 | start | audience-split | 显示预览线，连接成功 |
| TC_CONNECT_002 | audience-split | sms | 显示多条预览线（分流节点） |
| TC_CONNECT_003 | sms | end | 显示预览线，连接成功 |
| TC_CONNECT_004 | condition | email | 显示条件分支预览线 |
| TC_CONNECT_005 | ab-test | wechat | 显示AB测试分支预览线 |

#### 3.3.2 连接规则验证测试
**测试目标**：验证节点连接规则的正确性

| 测试场景 | 测试内容 | 预期结果 |
|---------|---------|---------|
| 输出端口限制 | end节点不能作为源节点 | 连接被阻止，显示错误提示 |
| 输入端口限制 | start节点不能作为目标节点 | 连接被阻止，显示错误提示 |
| 循环连接检测 | 创建循环连接 | 连接被阻止，显示警告 |
| 重复连接检测 | 重复连接同一对节点 | 连接被阻止或替换原连接 |

### 3.4 节点删除测试

#### 3.4.1 单节点删除测试
**测试目标**：验证单个节点的删除功能

| 测试用例ID | 测试步骤 | 预期结果 |
|-----------|---------|---------|
| TC_DELETE_001 | 选中节点，按Delete键 | 节点被删除，相关连线也被删除 |
| TC_DELETE_002 | 右键节点，选择删除 | 节点被删除，相关连线也被删除 |
| TC_DELETE_003 | 删除有连接的节点 | 节点和所有相关连线都被删除 |

#### 3.4.2 批量删除测试
**测试目标**：验证多个节点的批量删除功能

| 测试用例ID | 测试步骤 | 预期结果 |
|-----------|---------|---------|
| TC_DELETE_004 | 框选多个节点，按Delete键 | 所有选中节点被删除 |
| TC_DELETE_005 | Ctrl+A全选，按Delete键 | 所有节点被删除，画布清空 |

### 3.5 节点类型识别测试

#### 3.5.1 类型获取测试
**测试目标**：验证节点类型获取函数的正确性

| 测试用例ID | 测试方法 | 预期结果 |
|-----------|---------|---------|
| TC_TYPE_001 | 调用getNodeType()函数 | 返回正确的节点类型字符串 |
| TC_TYPE_002 | 测试undefined节点 | 返回null或默认值，不抛出错误 |
| TC_TYPE_003 | 测试无效节点类型 | 返回null，记录警告日志 |

#### 3.5.2 类型验证测试
**测试目标**：验证节点类型验证函数的正确性

| 测试用例ID | 输入值 | 预期结果 |
|-----------|-------|---------|
| TC_VALID_001 | 'start' | 返回true |
| TC_VALID_002 | 'invalid-type' | 返回false |
| TC_VALID_003 | null | 返回false |
| TC_VALID_004 | undefined | 返回false |
| TC_VALID_005 | '' | 返回false |

## 4. 错误处理测试

### 4.1 异常情况测试
| 测试场景 | 测试方法 | 预期结果 |
|---------|---------|---------|
| 网络异常 | 断网状态下操作节点 | 显示友好错误提示 |
| 内存不足 | 创建大量节点 | 系统稳定，适当限制 |
| 浏览器兼容性 | 不同浏览器测试 | 功能正常，样式一致 |

### 4.2 边界值测试
| 测试项 | 边界值 | 预期结果 |
|-------|-------|---------|
| 节点数量 | 创建1000个节点 | 系统稳定运行 |
| 连接数量 | 创建复杂连接网络 | 预览线正常显示 |
| 配置数据 | 超长文本输入 | 适当截断或验证 |

## 5. 性能测试

### 5.1 响应时间测试
| 操作类型 | 性能指标 | 目标值 |
|---------|---------|-------|
| 节点创建 | 响应时间 | <100ms |
| 配置抽屉打开 | 响应时间 | <200ms |
| 预览线生成 | 响应时间 | <150ms |
| 节点删除 | 响应时间 | <50ms |

### 5.2 内存使用测试
| 测试场景 | 监控指标 | 目标值 |
|---------|---------|-------|
| 长时间使用 | 内存泄漏 | 无明显增长 |
| 大量操作 | 内存峰值 | <500MB |

## 6. 验收标准

### 6.1 功能验收标准
- ✅ 所有14种节点类型都能正确创建
- ✅ 每种节点类型的配置抽屉完全匹配
- ✅ 节点配置能正确保存和读取
- ✅ 预览线能正确生成和显示
- ✅ 节点删除功能正常工作
- ✅ 节点类型识别准确无误
- ✅ 错误处理机制完善

### 6.2 质量验收标准
- ✅ 所有测试用例通过率≥95%
- ✅ 关键功能响应时间符合性能指标
- ✅ 无内存泄漏和严重性能问题
- ✅ 错误日志清晰，便于调试
- ✅ 用户体验流畅，操作直观

### 6.3 兼容性验收标准
- ✅ 支持Chrome、Firefox、Safari最新版本
- ✅ 支持桌面端和移动端设备
- ✅ 支持不同屏幕分辨率

## 7. 测试执行计划

### 7.1 测试阶段
1. **第一阶段**：基础功能测试（节点创建、配置抽屉）
2. **第二阶段**：连接功能测试（预览线、节点连接）
3. **第三阶段**：删除功能测试（单个、批量删除）
4. **第四阶段**：类型识别测试（类型获取、验证）
5. **第五阶段**：错误处理和性能测试

### 7.2 测试时间安排
- 测试准备：1天
- 功能测试：3天
- 性能测试：1天
- 回归测试：1天
- 测试报告：1天

### 7.3 测试人员安排
- 测试负责人：1人
- 功能测试工程师：2人
- 性能测试工程师：1人
- 自动化测试工程师：1人

## 8. 风险评估

### 8.1 技术风险
- **节点类型识别失败**：可能导致配置抽屉匹配错误
- **预览线生成异常**：影响用户的连接操作体验
- **内存泄漏**：长时间使用可能导致浏览器卡顿

### 8.2 缓解措施
- 增强节点类型验证和错误处理机制
- 优化预览线生成算法，增加异常处理
- 定期进行内存使用监控和优化

## 9. 测试工具和环境

### 9.1 测试工具
- **功能测试**：手动测试 + Cypress自动化测试
- **性能测试**：Chrome DevTools + Lighthouse
- **兼容性测试**：BrowserStack
- **内存监控**：Chrome Memory Tab

### 9.2 测试数据
- 准备各种节点类型的测试配置数据
- 创建复杂的节点连接场景
- 准备边界值和异常数据

## 10. 测试报告模板

测试完成后，将生成详细的测试报告，包括：
- 测试执行情况汇总
- 各功能模块测试结果
- 发现的问题和缺陷列表
- 性能测试数据分析
- 改进建议和后续计划

---

**文档版本**：v1.0  
**创建日期**：2024年12月19日  
**最后更新**：2024年12月19日  
**文档状态**：待审核