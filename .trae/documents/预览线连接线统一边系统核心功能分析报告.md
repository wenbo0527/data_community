# é¢„è§ˆçº¿è¿æ¥çº¿ç»Ÿä¸€è¾¹ç³»ç»Ÿæ ¸å¿ƒåŠŸèƒ½åˆ†ææŠ¥å‘Šï¼ˆç»Ÿä¸€æœåŠ¡æ¶æ„ç‰ˆï¼‰

## ğŸ“‹ æŠ¥å‘Šæ¦‚è¦

**ç”Ÿæˆæ—¶é—´**: 2024å¹´12æœˆ19æ—¥  
**åˆ†æèŒƒå›´**: é¢„è§ˆçº¿è¿æ¥çº¿ç»Ÿä¸€è¾¹ç³»ç»Ÿå®Œæ•´æ¶æ„  
**ä»£ç ç‰ˆæœ¬**: åŸºäºå½“å‰å®é™…ä»£ç çŠ¶æ€  
**è¦†ç›–æ¨¡å—**: UnifiedEdgeManagerã€PreviewLineSystemã€PreviewLineService  

---

## ğŸ—ï¸ 1. ç»Ÿä¸€æœåŠ¡æ¶æ„æ¦‚è§ˆ

### 1.1 æ ¸å¿ƒè®¾è®¡ç†å¿µ

è¥é”€ç”»å¸ƒç³»ç»Ÿé‡‡ç”¨**ç»Ÿä¸€è¾¹æœåŠ¡æ¶æ„**ï¼Œé¢„è§ˆçº¿å’Œè¿æ¥çº¿ä¸æ˜¯ç‹¬ç«‹çš„ä¸¤å¥—ç³»ç»Ÿï¼Œè€Œæ˜¯åŒä¸€ä¸ªè¾¹å®ä½“çš„ä¸åŒçŠ¶æ€ï¼š

#### ğŸ¯ æ ¸å¿ƒç†å¿µ
- **é¢„è§ˆçº¿**ï¼šè¿æ¥çº¿çš„ä¸´æ—¶çŠ¶æ€ï¼Œç”¨äºç”¨æˆ·äº¤äº’å’Œé¢„è§ˆ
- **è¿æ¥çº¿**ï¼šé¢„è§ˆçº¿çš„ç¡®è®¤çŠ¶æ€ï¼Œè¡¨ç¤ºæ­£å¼çš„èŠ‚ç‚¹è¿æ¥å…³ç³»
- **è½¬åŒ–å…³ç³»**ï¼šé¢„è§ˆçº¿ â†” è¿æ¥çº¿ï¼Œé€šè¿‡çŠ¶æ€è½¬æ¢å®ç°
- **ç»Ÿä¸€ç®¡ç†**ï¼šæ‰€æœ‰æ“ä½œé€šè¿‡ä¸€ä¸ªæœåŠ¡å®ç°ï¼Œæ¶ˆé™¤é‡å¤å’Œå†—ä½™

#### ğŸ—ï¸ UnifiedEdgeManager - å”¯ä¸€è¾¹ç®¡ç†æœåŠ¡
**æ–‡ä»¶ä½ç½®**: `src/pages/marketing/tasks/composables/canvas/unified/UnifiedEdgeManager.js`

**æ ¸å¿ƒèŒè´£**:
- ä½œä¸ºé¢„è§ˆçº¿å’Œè¿æ¥çº¿çš„å”¯ä¸€ç®¡ç†å…¥å£
- ç»Ÿä¸€çš„è¾¹ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼šåˆ›å»º â†’ è½¬åŒ– â†’ åˆ é™¤
- ç»Ÿä¸€çš„æ•°æ®å­˜å‚¨ã€ç´¢å¼•å’Œç¼“å­˜æœºåˆ¶
- ç»Ÿä¸€çš„äº‹ä»¶å¤„ç†å’ŒçŠ¶æ€ç®¡ç†

**ç»Ÿä¸€æ•°æ®æ¨¡å‹**:
```javascript
// ç»Ÿä¸€è¾¹æ•°æ®ç»“æ„
const EdgeModel = {
  id: string,                    // è¾¹å”¯ä¸€æ ‡è¯†
  type: 'preview' | 'connection', // è¾¹ç±»å‹ï¼ˆçŠ¶æ€ï¼‰
  sourceNodeId: string,          // æºèŠ‚ç‚¹ID
  targetNodeId: string,          // ç›®æ ‡èŠ‚ç‚¹IDï¼ˆè¿æ¥çº¿ï¼‰
  targetPosition: object,        // ç›®æ ‡ä½ç½®ï¼ˆé¢„è§ˆçº¿ï¼‰
  branchId: string,             // åˆ†æ”¯æ ‡è¯†
  metadata: object,             // æ‰©å±•æ•°æ®
  createdAt: timestamp,         // åˆ›å»ºæ—¶é—´
  updatedAt: timestamp          // æ›´æ–°æ—¶é—´
}

// ç»Ÿä¸€å­˜å‚¨ç»“æ„
this.edges = reactive(new Map())           // æ‰€æœ‰è¾¹çš„ç»Ÿä¸€å­˜å‚¨
this.nodeEdgeIndex = reactive(new Map())   // èŠ‚ç‚¹åˆ°è¾¹çš„ç´¢å¼•
this.typeIndex = reactive(new Map())       // ç±»å‹ç´¢å¼•ï¼ˆpreview/connectionï¼‰
this.branchIndex = reactive(new Map())     // åˆ†æ”¯ç´¢å¼•
```

### 1.2 ç»Ÿä¸€æœåŠ¡äº¤äº’å…³ç³»

```mermaid
graph TD
    A[TaskFlowCanvas] --> B[UnifiedEdgeManager]
    B --> C[EdgeRenderer]
    B --> D[EdgeEventHandler]
    B --> E[EdgeStateManager]
    B --> F[EdgeDataManager]
    
    subgraph "ç»Ÿä¸€è¾¹æœåŠ¡å±‚"
        B
        C
        D
        E
        F
    end
    
    subgraph "æ”¯æ’‘å·¥å…·å±‚"
        G[PortConfigurationFactory]
        H[InPortSnapDetector]
        I[PositionCalculator]
    end
    
    B --> G
    B --> H
    B --> I
```

### 1.3 æ•´ä½“æ¶æ„è®¾è®¡

```mermaid
graph TD
    A[TaskFlowCanvasRefactored.vue] --> B[UnifiedEdgeManager]
    A --> C[usePreviewLine]
    A --> D[PreviewLineService]
    
    B --> E[EdgeTypes]
    B --> F[PortConfigurationFactory]
    B --> G[ConnectionCreationController]
    B --> H[InPortSnapDetector]
    B --> I[EdgePersistenceManager]
    
    C --> J[PreviewLineSystem]
    J --> K[EventManager]
    J --> L[StateManager]
    J --> M[PreviewLineConfigManager]
    J --> N[PreviewLineManager]
    
    D --> O[PreviewLineStyleManager]
    D --> P[usePreviewLine Hook]
    
    subgraph "æ ¸å¿ƒç®¡ç†å±‚"
        B
        J
    end
    
    subgraph "æœåŠ¡å±‚"
        C
        D
    end
    
    subgraph "å·¥å…·å±‚"
        E
        F
        G
        H
        I
    end
```

### 1.2 ç»„ä»¶èŒè´£åˆ†å·¥

| ç»„ä»¶ | ä¸»è¦èŒè´£ | ä¾èµ–å…³ç³» | çŠ¶æ€ |
|------|----------|----------|------|
| **UnifiedEdgeManager** | ç»Ÿä¸€è¾¹ç®¡ç†ã€çŠ¶æ€è½¬æ¢ã€æ€§èƒ½ä¼˜åŒ– | ç‹¬ç«‹æ ¸å¿ƒæ¨¡å— | âœ… ç”Ÿäº§å°±ç»ª |
| **PreviewLineSystem** | é¢„è§ˆçº¿ç³»ç»Ÿé›†æˆã€æ¨¡å—åè°ƒ | å¤šæ¨¡å—é›†æˆ | âœ… åŠŸèƒ½å®Œæ•´ |
| **PreviewLineService** | æœåŠ¡å±‚APIã€ä¸šåŠ¡é€»è¾‘å°è£… | usePreviewLine | âœ… ç¨³å®šè¿è¡Œ |
| **usePreviewLine** | Vueç»„åˆå¼APIã€å“åº”å¼çŠ¶æ€ | PreviewLineSystem | âœ… æ¥å£ç»Ÿä¸€ |

### 1.3 ä¾èµ–å…³ç³»å›¾

```mermaid
graph LR
    A[UnifiedEdgeManager] -.-> B[PreviewLineSystem]
    C[usePreviewLine] --> A
    C --> B
    D[PreviewLineService] --> C
    E[TaskFlowCanvas] --> A
    E --> C
    E --> D
    
    F[PortConfigurationFactory] --> A
    G[ConnectionCreationController] --> A
    H[InPortSnapDetector] --> A
    
    I[EventManager] --> B
    J[StateManager] --> B
    K[PreviewLineManager] --> B
```

---

## âš™ï¸ 2. ç»Ÿä¸€è¾¹æœåŠ¡æ ¸å¿ƒåŠŸèƒ½

### 2.1 ç»Ÿä¸€æ¥å£è®¾è®¡

#### ğŸ“Š ç»Ÿä¸€APIæ¥å£è§„èŒƒ
```javascript
class UnifiedEdgeManager {
  constructor(graph) {
    // ç»Ÿä¸€æ•°æ®å­˜å‚¨
    this.edges = reactive(new Map())           // æ‰€æœ‰è¾¹çš„ç»Ÿä¸€å­˜å‚¨
    this.nodeEdgeIndex = reactive(new Map())   // èŠ‚ç‚¹åˆ°è¾¹çš„ç´¢å¼•
    this.typeIndex = reactive(new Map())       // ç±»å‹ç´¢å¼•ï¼ˆpreview/connectionï¼‰
    this.branchIndex = reactive(new Map())     // åˆ†æ”¯ç´¢å¼•
    this.portConnectionIndex = reactive(new Map()) // ç«¯å£è¿æ¥ç´¢å¼•
    
    // æ€§èƒ½ä¼˜åŒ–
    this.cache = new Map()                     // æŸ¥è¯¢ç¼“å­˜
    this.batchOperations = []                  // æ‰¹é‡æ“ä½œé˜Ÿåˆ—
  }
}
```

#### ğŸ¯ ç»Ÿä¸€æ“ä½œæ¥å£

**1. ç»Ÿä¸€åˆ›å»ºæ¥å£**
```javascript
// ç»Ÿä¸€è¾¹åˆ›å»ºæ¥å£
createEdge(type, config) {
  const edgeId = this.generateId(type)
  const edgeData = {
    id: edgeId,
    type: type, // 'preview' | 'connection'
    sourceNodeId: config.sourceNodeId,
    targetNodeId: config.targetNodeId,     // è¿æ¥çº¿å¿…éœ€
    targetPosition: config.targetPosition, // é¢„è§ˆçº¿å¿…éœ€
    branchId: config.branchId,
    metadata: config.metadata || {},
    createdAt: Date.now(),
    updatedAt: Date.now()
  }
  
  // ç»Ÿä¸€å­˜å‚¨
  this.edges.set(edgeId, edgeData)
  
  // æ›´æ–°ç±»å‹ç´¢å¼•
  this.updateTypeIndex(type, edgeId)
  
  // æ›´æ–°èŠ‚ç‚¹ç´¢å¼•
  this.updateNodeIndex(config.sourceNodeId, edgeId)
  if (config.targetNodeId) {
    this.updateNodeIndex(config.targetNodeId, edgeId)
  }
  
  // æ›´æ–°åˆ†æ”¯ç´¢å¼•
  this.updateBranchIndex(config.branchId, edgeId)
  
  return edgeData
}

// ä¾¿æ·åˆ›å»ºæ–¹æ³•
createPreviewLine(sourceNodeId, targetPosition, branchId) {
  return this.createEdge('preview', {
    sourceNodeId,
    targetPosition,
    branchId
  })
}

createConnection(sourceNodeId, targetNodeId, branchId) {
  return this.createEdge('connection', {
    sourceNodeId,
    targetNodeId,
    branchId
  })
}
```

**2. ç»Ÿä¸€è½¬åŒ–æ¥å£**
```javascript
// ç»Ÿä¸€è¾¹è½¬åŒ–æ¥å£
convertEdge(edgeId, targetType, config = {}) {
  const edge = this.edges.get(edgeId)
  if (!edge) return null
  
  // é¢„è§ˆçº¿è½¬è¿æ¥çº¿
  if (edge.type === 'preview' && targetType === 'connection') {
    return this.convertPreviewToConnection(edgeId, config.targetNodeId)
  }
  
  // è¿æ¥çº¿è½¬é¢„è§ˆçº¿
  if (edge.type === 'connection' && targetType === 'preview') {
    return this.convertConnectionToPreview(edgeId, config.targetPosition)
  }
  
  return null
}

// é¢„è§ˆçº¿è½¬è¿æ¥çº¿
convertPreviewToConnection(previewId, targetNodeId) {
  const preview = this.edges.get(previewId)
  if (!preview || preview.type !== 'preview') return null
  
  // æ›´æ–°è¾¹æ•°æ®
  const updatedEdge = {
    ...preview,
    type: 'connection',
    targetNodeId,
    targetPosition: undefined, // ç§»é™¤é¢„è§ˆçº¿ç‰¹æœ‰å±æ€§
    updatedAt: Date.now()
  }
  
  // æ›´æ–°å­˜å‚¨
  this.edges.set(previewId, updatedEdge)
  
  // æ›´æ–°ç´¢å¼•
  this.updateTypeIndex('preview', previewId, 'remove')
  this.updateTypeIndex('connection', previewId, 'add')
  this.updateNodeIndex(targetNodeId, previewId)
  this.updatePortIndex(preview.sourceNodeId, targetNodeId, previewId)
  
  return updatedEdge
}

// è¿æ¥çº¿è½¬é¢„è§ˆçº¿
convertConnectionToPreview(connectionId, targetPosition) {
  const connection = this.edges.get(connectionId)
  if (!connection || connection.type !== 'connection') return null
  
  // æ›´æ–°è¾¹æ•°æ®
  const updatedEdge = {
    ...connection,
    type: 'preview',
    targetPosition,
    targetNodeId: undefined, // ç§»é™¤è¿æ¥çº¿ç‰¹æœ‰å±æ€§
    updatedAt: Date.now()
  }
  
  // æ›´æ–°å­˜å‚¨
  this.edges.set(connectionId, updatedEdge)
  
  // æ›´æ–°ç´¢å¼•
  this.updateTypeIndex('connection', connectionId, 'remove')
  this.updateTypeIndex('preview', connectionId, 'add')
  this.cleanupPortIndex(connection.sourceNodeId, connection.targetNodeId, connectionId)
  
  return updatedEdge
}
```

**3. ç»Ÿä¸€åˆ é™¤æ¥å£**
```javascript
// ç»Ÿä¸€è¾¹åˆ é™¤æ¥å£
removeEdge(edgeId) {
  const edge = this.edges.get(edgeId)
  if (!edge) return false
  
  // åˆ é™¤ä¸»å­˜å‚¨
  this.edges.delete(edgeId)
  
  // æ¸…ç†æ‰€æœ‰ç´¢å¼•
  this.updateTypeIndex(edge.type, edgeId, 'remove')
  this.cleanupNodeIndex(edge.sourceNodeId, edgeId)
  
  if (edge.targetNodeId) {
    this.cleanupNodeIndex(edge.targetNodeId, edgeId)
    this.cleanupPortIndex(edge.sourceNodeId, edge.targetNodeId, edgeId)
  }
  
  this.cleanupBranchIndex(edge.branchId, edgeId)
  
  // æ¸…ç†ç¼“å­˜
  this.clearRelatedCache(edgeId)
  
  return true
}

// æ‰¹é‡åˆ é™¤
batchRemoveEdges(edgeIds) {
  const results = []
  
  for (const edgeId of edgeIds) {
    results.push(this.removeEdge(edgeId))
  }
  
  return results
}
```

**4. ç»Ÿä¸€æŸ¥è¯¢æ¥å£**
```javascript
// ç»Ÿä¸€è¾¹æŸ¥è¯¢æ¥å£
getEdges(filter = {}) {
  let edges = Array.from(this.edges.values())
  
  // ç±»å‹è¿‡æ»¤
  if (filter.type) {
    const typeEdges = this.typeIndex.get(filter.type) || new Set()
    edges = edges.filter(edge => typeEdges.has(edge.id))
  }
  
  // èŠ‚ç‚¹è¿‡æ»¤
  if (filter.nodeId) {
    const nodeEdges = this.nodeEdgeIndex.get(filter.nodeId) || new Set()
    edges = edges.filter(edge => nodeEdges.has(edge.id))
  }
  
  // åˆ†æ”¯è¿‡æ»¤
  if (filter.branchId) {
    const branchEdges = this.branchIndex.get(filter.branchId) || new Set()
    edges = edges.filter(edge => branchEdges.has(edge.id))
  }
  
  return edges
}

// ä¾¿æ·æŸ¥è¯¢æ–¹æ³•
getPreviewLines(nodeId = null) {
  return this.getEdges({ type: 'preview', nodeId })
}

getConnections(nodeId = null) {
  return this.getEdges({ type: 'connection', nodeId })
}

getBranchEdges(branchId) {
  return this.getEdges({ branchId })
}
```

### 2.2 ç»Ÿä¸€ç”Ÿå‘½å‘¨æœŸç®¡ç†

#### ğŸ”„ è¾¹çŠ¶æ€è½¬æ¢æµç¨‹
```javascript
// ç»Ÿä¸€ç”Ÿå‘½å‘¨æœŸç®¡ç†
manageEdgeLifecycle(edgeId, action, config = {}) {
  const edge = this.edges.get(edgeId)
  if (!edge) return null
  
  switch (action) {
    case 'activate':
      return this.activateEdge(edgeId, config)
    case 'deactivate':
      return this.deactivateEdge(edgeId)
    case 'convert':
      return this.convertEdge(edgeId, config.targetType, config)
    case 'update':
      return this.updateEdge(edgeId, config.updates)
    case 'remove':
      return this.removeEdge(edgeId)
    default:
      return null
  }
}

// è¾¹çŠ¶æ€æ›´æ–°
updateEdge(edgeId, updates) {
  const edge = this.edges.get(edgeId)
  if (!edge) return null
  
  const updatedEdge = {
    ...edge,
    ...updates,
    updatedAt: Date.now()
  }
  
  this.edges.set(edgeId, updatedEdge)
  return updatedEdge
}
```

### 2.3 ç»Ÿä¸€äº‹ä»¶ç³»ç»Ÿ

#### ğŸ“¡ äº‹ä»¶é©±åŠ¨æ¶æ„
```javascript
// ç»Ÿä¸€äº‹ä»¶ç®¡ç†
class EdgeEventManager {
  constructor() {
    this.listeners = new Map()
  }
  
  // æ³¨å†Œäº‹ä»¶ç›‘å¬
  on(eventType, callback) {
    if (!this.listeners.has(eventType)) {
      this.listeners.set(eventType, new Set())
    }
    this.listeners.get(eventType).add(callback)
  }
  
  // è§¦å‘äº‹ä»¶
  emit(eventType, data) {
    const callbacks = this.listeners.get(eventType)
    if (callbacks) {
      callbacks.forEach(callback => callback(data))
    }
  }
  
  // ç§»é™¤ç›‘å¬
  off(eventType, callback) {
    const callbacks = this.listeners.get(eventType)
    if (callbacks) {
      callbacks.delete(callback)
    }
  }
}

// è¾¹äº‹ä»¶ç±»å‹
const EdgeEvents = {
  EDGE_CREATED: 'edge:created',
  EDGE_CONVERTED: 'edge:converted',
  EDGE_UPDATED: 'edge:updated',
  EDGE_REMOVED: 'edge:removed',
  BATCH_OPERATION_START: 'batch:start',
  BATCH_OPERATION_END: 'batch:end'
}
```

---

## ğŸ”„ 3. ç»Ÿä¸€æœåŠ¡è°ƒç”¨ç»“æ„

### 3.1 ç»Ÿä¸€æœåŠ¡æ•°æ®æµå‘

```mermaid
sequenceDiagram
    participant Canvas as TaskFlowCanvas
    participant UEM as UnifiedEdgeManager
    participant EventMgr as EdgeEventManager
    participant DataMgr as EdgeDataManager
    participant Renderer as EdgeRenderer
    
    Canvas->>UEM: åˆå§‹åŒ–ç»Ÿä¸€è¾¹æœåŠ¡
    Canvas->>UEM: createEdge('preview', config)
    UEM->>DataMgr: å­˜å‚¨è¾¹æ•°æ®
    UEM->>EventMgr: è§¦å‘ EDGE_CREATED äº‹ä»¶
    UEM->>Renderer: æ¸²æŸ“é¢„è§ˆçº¿
    UEM->>Canvas: è¿”å›è¾¹å¯¹è±¡
    
    Canvas->>UEM: convertEdge(edgeId, 'connection')
    UEM->>DataMgr: æ›´æ–°è¾¹ç±»å‹å’Œæ•°æ®
    UEM->>EventMgr: è§¦å‘ EDGE_CONVERTED äº‹ä»¶
    UEM->>Renderer: é‡æ–°æ¸²æŸ“ä¸ºè¿æ¥çº¿
    UEM->>Canvas: è¿”å›è½¬æ¢åçš„è¾¹å¯¹è±¡
```

### 3.2 ç»Ÿä¸€è¾¹ç”Ÿå‘½å‘¨æœŸæµç¨‹

```mermaid
stateDiagram-v2
    [*] --> Creating: createEdge()
    Creating --> Preview: type='preview'
    Creating --> Connection: type='connection'
    
    Preview --> Connection: convertEdge(id, 'connection')
    Connection --> Preview: convertEdge(id, 'preview')
    
    Preview --> Updating: updateEdge()
    Connection --> Updating: updateEdge()
    Updating --> Preview: type='preview'
    Updating --> Connection: type='connection'
    
    Preview --> Removing: removeEdge()
    Connection --> Removing: removeEdge()
    Removing --> [*]
```

### 3.2 äº‹ä»¶é©±åŠ¨äº¤äº’æ¨¡å¼

#### äº‹ä»¶æµç¨‹å›¾
```mermaid
graph TD
    A[ç”¨æˆ·æ“ä½œ] --> B[Canvasäº‹ä»¶]
    B --> C{æ“ä½œç±»å‹}
    
    C -->|åˆ›å»ºé¢„è§ˆçº¿| D[UEM.createPreviewLine]
    C -->|æ‹–æ‹½é¢„è§ˆçº¿| E[PLS.updatePreviewLine]
    C -->|å¸é™„ç›®æ ‡| F[InPortSnapDetector]
    C -->|åˆ›å»ºè¿æ¥| G[UEM.convertPreviewToConnection]
    
    D --> H[æ›´æ–°çŠ¶æ€]
    E --> H
    F --> H
    G --> H
    
    H --> I[è§¦å‘äº‹ä»¶]
    I --> J[UIæ›´æ–°]
```

#### å…³é”®äº‹ä»¶ç±»å‹
- `preview:created` - é¢„è§ˆçº¿åˆ›å»º
- `preview:updated` - é¢„è§ˆçº¿æ›´æ–°
- `preview:removed` - é¢„è§ˆçº¿åˆ é™¤
- `connection:created` - è¿æ¥çº¿åˆ›å»º
- `manager:initialized` - ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ

### 3.3 ç»Ÿä¸€æœåŠ¡æ ¸å¿ƒè°ƒç”¨é“¾è·¯

#### è¾¹åˆ›å»ºæµç¨‹
```mermaid
graph TD
    A[ç”¨æˆ·æ“ä½œ] --> B[TaskFlowCanvas æ•è·äº‹ä»¶]
    B --> C[UnifiedEdgeManager.createEdge()]
    C --> D[ç”Ÿæˆè¾¹æ•°æ®æ¨¡å‹]
    D --> E[æ›´æ–°ç»Ÿä¸€å­˜å‚¨]
    E --> F[æ›´æ–°ç´¢å¼•ç³»ç»Ÿ]
    F --> G[è§¦å‘åˆ›å»ºäº‹ä»¶]
    G --> H[æ¸²æŸ“è¾¹è§†å›¾]
    H --> I[è¿”å›è¾¹å¯¹è±¡]
```

#### è¾¹è½¬æ¢æµç¨‹
```mermaid
graph TD
    A[è½¬æ¢è¯·æ±‚] --> B[UnifiedEdgeManager.convertEdge()]
    B --> C[éªŒè¯è¾¹å­˜åœ¨æ€§]
    C --> D[æ›´æ–°è¾¹ç±»å‹å’Œå±æ€§]
    D --> E[æ›´æ–°ç›¸å…³ç´¢å¼•]
    E --> F[æ¸…ç†æ—§çŠ¶æ€æ•°æ®]
    F --> G[è§¦å‘è½¬æ¢äº‹ä»¶]
    G --> H[é‡æ–°æ¸²æŸ“]
    H --> I[è¿”å›è½¬æ¢ç»“æœ]
```

#### æ‰¹é‡æ“ä½œæµç¨‹
```mermaid
graph TD
    A[æ‰¹é‡æ“ä½œè¯·æ±‚] --> B[UnifiedEdgeManager.batchOperation()]
    B --> C[å¼€å§‹æ‰¹é‡äº‹ä»¶]
    C --> D[éå†æ“ä½œé˜Ÿåˆ—]
    D --> E[æ‰§è¡Œå•ä¸ªè¾¹æ“ä½œ]
    E --> F[ç´¯ç§¯æ“ä½œç»“æœ]
    F --> G[æ£€æŸ¥æ˜¯å¦å®Œæˆ]
    G -->|æœªå®Œæˆ| D
    G -->|å®Œæˆ| H[è§¦å‘æ‰¹é‡å®Œæˆäº‹ä»¶]
    H --> I[è¿”å›æ‰¹é‡ç»“æœ]
```

### 3.4 ç»Ÿä¸€é”™è¯¯å¤„ç†ä¸æ¢å¤æœºåˆ¶

#### é”™è¯¯åˆ†ç±»ä¸å¤„ç†ç­–ç•¥
```javascript
// ç»Ÿä¸€é”™è¯¯å¤„ç†
const EdgeErrorTypes = {
  EDGE_NOT_FOUND: 'edge_not_found',         // è¾¹ä¸å­˜åœ¨
  INVALID_CONVERSION: 'invalid_conversion', // æ— æ•ˆè½¬æ¢
  TYPE_MISMATCH: 'type_mismatch',          // ç±»å‹ä¸åŒ¹é…
  INDEX_CORRUPTION: 'index_corruption',     // ç´¢å¼•æŸå
  BATCH_FAILURE: 'batch_failure'           // æ‰¹é‡æ“ä½œå¤±è´¥
}

// ç»Ÿä¸€é”™è¯¯å¤„ç†å™¨
class UnifiedEdgeErrorHandler {
  handleError(error, context) {
    switch (error.type) {
      case EdgeErrorTypes.EDGE_NOT_FOUND:
        return this.handleEdgeNotFound(error, context)
      case EdgeErrorTypes.INVALID_CONVERSION:
        return this.handleInvalidConversion(error, context)
      case EdgeErrorTypes.TYPE_MISMATCH:
        return this.handleTypeMismatch(error, context)
      case EdgeErrorTypes.INDEX_CORRUPTION:
        return this.handleIndexCorruption(error, context)
      default:
        return this.handleSystemError(error, context)
    }
  }
  
  // ç»Ÿä¸€çŠ¶æ€æ¢å¤æœºåˆ¶
  recoverEdgeState(edgeId) {
    // é‡å»ºè¾¹ç´¢å¼•
    this.rebuildEdgeIndexes(edgeId)
    
    // éªŒè¯è¾¹æ•°æ®å®Œæ•´æ€§
    this.validateEdgeIntegrity(edgeId)
    
    // åŒæ­¥æ¸²æŸ“çŠ¶æ€
    this.syncRenderState(edgeId)
  }
  
  // æ‰¹é‡æ¢å¤æœºåˆ¶
  batchRecovery(failedOperations) {
    const recoveryResults = []
    
    for (const operation of failedOperations) {
      try {
        const result = this.recoverOperation(operation)
        recoveryResults.push({ success: true, result })
      } catch (error) {
        recoveryResults.push({ success: false, error })
      }
    }
    
    return recoveryResults
  }
}
```

### 3.3 ç»„ä»¶é—´è°ƒç”¨å…³ç³»

| è°ƒç”¨æ–¹ | è¢«è°ƒç”¨æ–¹ | è°ƒç”¨æ–¹æ³• | é¢‘ç‡ | ç”¨é€” |
|--------|----------|----------|------|------|
| TaskFlowCanvas | UnifiedEdgeManager | createPreviewLine() | é«˜ | é¢„è§ˆçº¿åˆ›å»º |
| usePreviewLine | UnifiedEdgeManager | getUnifiedEdgeManager() | é«˜ | è·å–ç®¡ç†å™¨å®ä¾‹ |
| UnifiedEdgeManager | PreviewLineSystem | çŠ¶æ€éªŒè¯æ–¹æ³• | ä¸­ | èŠ‚ç‚¹çŠ¶æ€æ£€æŸ¥ |
| PreviewLineService | usePreviewLine | showPreviewLine() | é«˜ | é¢„è§ˆçº¿æ˜¾ç¤º |
| UnifiedEdgeManager | X6 Graph | addEdge() | é«˜ | åˆ›å»ºå›¾å½¢è¾¹ |

---

## ğŸ”Œ 4. å…³é”®æ¥å£è§„èŒƒ

### 4.1 UnifiedEdgeManager æ¥å£æ ‡å‡†

#### é¢„è§ˆçº¿åˆ›å»ºæ¥å£
```typescript
interface CreatePreviewLineOptions {
  branchId?: string;
  branchLabel?: string;
  branchIndex?: number;
  style?: EdgeStyle;
  metadata?: EdgeMetadata;
  createdBy?: string;
}

async createPreviewLine(
  sourceNodeId: string, 
  options: CreatePreviewLineOptions = {}
): Promise<UnifiedEdge>
```

#### è¿æ¥è½¬æ¢æ¥å£
```typescript
interface ConvertToConnectionOptions {
  targetPortId?: string;
  validateConnection?: boolean;
  preserveStyle?: boolean;
}

async convertPreviewToConnection(
  previewId: string,
  targetNodeId: string,
  options: ConvertToConnectionOptions = {}
): Promise<UnifiedEdge>
```

### 4.2 PreviewLineSystem æ¥å£è§„èŒƒ

#### åˆå§‹åŒ–é…ç½®æ¥å£
```typescript
interface PreviewLineSystemOptions {
  graph: X6Graph;
  layoutEngine?: LayoutEngine;
  enabledModules?: ModuleConfig;
  performanceOptions?: PerformanceConfig;
}

constructor(options: PreviewLineSystemOptions)
```

#### é¢„è§ˆçº¿æŸ¥è¯¢æ¥å£
```typescript
interface PreviewLineQuery {
  sourceNodeId?: string;
  targetNodeId?: string;
  branchId?: string;
  type?: EdgeType;
}

findPreviewLine(query: PreviewLineQuery): UnifiedEdge | null
getAllPreviewLines(): UnifiedEdge[]
```

### 4.3 ç»Ÿä¸€è¾¹æœåŠ¡æ¥å£è§„èŒƒ

#### æ ¸å¿ƒæ¥å£å®šä¹‰
```typescript
interface UnifiedEdgeManager {
  // åˆå§‹åŒ–ä¸é”€æ¯
  initialize(): Promise<void>
  destroy(): Promise<void>
  
  // ç»Ÿä¸€è¾¹æ“ä½œ
  createEdge(type: EdgeType, config: EdgeConfig): Promise<Edge>
  convertEdge(edgeId: string, targetType: EdgeType, config?: ConvertConfig): Promise<Edge>
  updateEdge(edgeId: string, updates: Partial<Edge>): Promise<Edge>
  removeEdge(edgeId: string): Promise<boolean>
  
  // ç»Ÿä¸€æŸ¥è¯¢
  getEdges(filter?: EdgeFilter): Edge[]
  getEdge(edgeId: string): Edge | null
  hasEdge(edgeId: string): boolean
  
  // ä¾¿æ·æ–¹æ³•
  createPreviewLine(sourceNodeId: string, targetPosition: Position, branchId: string): Promise<PreviewEdge>
  createConnection(sourceNodeId: string, targetNodeId: string, branchId: string): Promise<ConnectionEdge>
  convertPreviewToConnection(previewId: string, targetNodeId: string): Promise<ConnectionEdge>
  convertConnectionToPreview(connectionId: string, targetPosition: Position): Promise<PreviewEdge>
  
  // æ‰¹é‡æ“ä½œ
  batchCreateEdges(operations: BatchEdgeOperation[]): Promise<BatchResult>
  batchRemoveEdges(edgeIds: string[]): Promise<BatchResult>
  batchConvertEdges(conversions: BatchConvertOperation[]): Promise<BatchResult>
  
  // ç”Ÿå‘½å‘¨æœŸç®¡ç†
  manageEdgeLifecycle(edgeId: string, action: LifecycleAction, config?: any): Promise<any>
  
  // ç»Ÿè®¡ä¸ç›‘æ§
  getStats(): EdgeStats
  clearCache(): void
}
```

### 4.4 æ¥å£ä¸€è‡´æ€§åˆ†æ

| æ¥å£ç±»åˆ« | ä¸€è‡´æ€§è¯„åˆ† | æ ‡å‡†åŒ–ç¨‹åº¦ | æ”¹è¿›å»ºè®® |
|----------|------------|------------|----------|
| å‚æ•°å‘½å | 85% | è‰¯å¥½ | ç»Ÿä¸€branchIdå‘½åè§„èŒƒ |
| è¿”å›å€¼æ ¼å¼ | 90% | ä¼˜ç§€ | ä¿æŒPromise<UnifiedEdge>æ ¼å¼ |
| é”™è¯¯å¤„ç† | 80% | è‰¯å¥½ | ç»Ÿä¸€é”™è¯¯ç±»å‹å®šä¹‰ |
| å¼‚æ­¥æ“ä½œ | 95% | ä¼˜ç§€ | å·²å…¨é¢é‡‡ç”¨async/await |

---

## ğŸŒ 5. å¯¹å¤–æš´éœ²æƒ…å†µ

### 5.1 å…¨å±€å¯¹è±¡æš´éœ²

#### å¼€å‘ç¯å¢ƒæš´éœ²
```javascript
// ä»…åœ¨å¼€å‘ç¯å¢ƒæš´éœ²åˆ°windowå¯¹è±¡
if (typeof window !== 'undefined' && process.env.NODE_ENV === 'development') {
  window.unifiedEdgeManager = unifiedEdgeManager;
  window.previewLineSystem = previewLineSystem;
}
```

#### ç”Ÿäº§ç¯å¢ƒä¾èµ–æ³¨å…¥
```javascript
// ç”Ÿäº§ç¯å¢ƒé€šè¿‡graphå®ä¾‹æ³¨å…¥
graph.unifiedEdgeManager = unifiedEdgeManager;
```

### 5.2 æ¨¡å—å¯¼å‡ºåˆ†æ

#### ES6æ¨¡å—å¯¼å‡º
```javascript
// UnifiedEdgeManager.js
export { UnifiedEdgeManager };

// PreviewLineSystem.js  
export default PreviewLineSystem;

// usePreviewLine.js
export { usePreviewLine };

// PreviewLineService.js
export { PreviewLineService, createPreviewLineService };
```

### 5.3 å®‰å…¨æ€§è¯„ä¼°

| æš´éœ²æ–¹å¼ | å®‰å…¨ç­‰çº§ | é£é™©è¯„ä¼° | å»ºè®® |
|----------|----------|----------|------|
| å…¨å±€windowå¯¹è±¡ | âš ï¸ ä¸­ç­‰ | ä»…å¼€å‘ç¯å¢ƒ | âœ… å·²é™åˆ¶ç¯å¢ƒ |
| ä¾èµ–æ³¨å…¥ | âœ… é«˜ | æ— é£é™© | âœ… æ¨èæ–¹å¼ |
| ES6æ¨¡å—å¯¼å‡º | âœ… é«˜ | æ— é£é™© | âœ… æ ‡å‡†åšæ³• |

---

## ğŸ§ª 6. æµ‹è¯•ç”¨ä¾‹åˆ†æ

### 6.1 æµ‹è¯•æ–‡ä»¶ç»“æ„

```
src/tests/unified-edge-manager/
â”œâ”€â”€ core-functionality.test.js      # æ ¸å¿ƒåŠŸèƒ½æµ‹è¯• (21ä¸ªç”¨ä¾‹)
â”œâ”€â”€ advanced-scenarios.test.js      # é«˜çº§åœºæ™¯æµ‹è¯• (31ä¸ªç”¨ä¾‹)  
â”œâ”€â”€ edge-cases.test.js             # è¾¹ç•Œæƒ…å†µæµ‹è¯• (25ä¸ªç”¨ä¾‹)
â”œâ”€â”€ error-recovery.test.js         # é”™è¯¯æ¢å¤æµ‹è¯• (15ä¸ªç”¨ä¾‹)
â”œâ”€â”€ integration.test.js            # é›†æˆæµ‹è¯• (18ä¸ªç”¨ä¾‹)
â”œâ”€â”€ performance.test.js            # æ€§èƒ½æµ‹è¯• (22ä¸ªç”¨ä¾‹)
â”œâ”€â”€ port-validation.test.js        # ç«¯å£éªŒè¯æµ‹è¯• (16ä¸ªç”¨ä¾‹)
â””â”€â”€ manual-canvas-scenarios.test.js # æ‰‹åŠ¨ç”»å¸ƒåœºæ™¯æµ‹è¯•
```

### 6.2 æµ‹è¯•è¦†ç›–ç‡åˆ†æ

| æµ‹è¯•ç±»åˆ« | è¦†ç›–ç‡ | æµ‹è¯•ç”¨ä¾‹æ•° | çŠ¶æ€ | é‡ç‚¹è¦†ç›–åŠŸèƒ½ |
|----------|--------|------------|------|------------|
| **æ ¸å¿ƒåŠŸèƒ½** | 92% | 21 | âœ… é€šè¿‡ | åˆå§‹åŒ–ã€é¢„è§ˆçº¿ç®¡ç†ã€è¿æ¥è½¬æ¢ |
| **é«˜çº§åœºæ™¯** | 93% | 31 | âœ… é€šè¿‡ | äº‹ä»¶ç³»ç»Ÿã€ç¼“å­˜ç®¡ç†ã€æ™ºèƒ½å»ºè®® |
| **è¾¹ç•Œæƒ…å†µ** | 88% | 25 | âœ… é€šè¿‡ | å¼‚å¸¸è¾“å…¥ã€èµ„æºé™åˆ¶ã€å¹¶å‘æ“ä½œ |
| **é”™è¯¯æ¢å¤** | 87% | 15 | âœ… é€šè¿‡ | ç½‘ç»œå¼‚å¸¸ã€æ•°æ®ä¿®å¤ã€é™çº§å¤„ç† |
| **é›†æˆæµ‹è¯•** | 90% | 18 | âœ… é€šè¿‡ | ç«¯åˆ°ç«¯æµ‹è¯•ã€å¤šç»„ä»¶åä½œ |
| **æ€§èƒ½æµ‹è¯•** | 85% | 22 | âœ… é€šè¿‡ | æ€§èƒ½ç›‘æ§ã€å†…å­˜ç®¡ç†ã€æ‰¹é‡ä¼˜åŒ– |
| **ç«¯å£éªŒè¯** | 89% | 16 | âœ… é€šè¿‡ | ç«¯å£æ–¹å‘ã€è¿æ¥éªŒè¯ |

### 6.3 æµ‹è¯•è´¨é‡è¯„ä¼°

#### æµ‹è¯•å®Œæ•´æ€§
- âœ… **åŠŸèƒ½è¦†ç›–**: 90.0% (ç›®æ ‡: 90%)
- âœ… **ä»£ç è¦†ç›–**: 294ä¸ªæµ‹è¯•ç”¨ä¾‹
- âœ… **åœºæ™¯è¦†ç›–**: åŒ…å«æ­£å¸¸ã€å¼‚å¸¸ã€è¾¹ç•Œæƒ…å†µ
- âœ… **æ€§èƒ½æµ‹è¯•**: åŒ…å«å¤§è§„æ¨¡æ•°æ®å’Œå¹¶å‘æµ‹è¯•

#### æµ‹è¯•ç¨³å®šæ€§
- âœ… **æ‰§è¡Œç¨³å®š**: æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹é€šè¿‡
- âœ… **ç¯å¢ƒå…¼å®¹**: æ”¯æŒNode.jså’Œæµè§ˆå™¨ç¯å¢ƒ
- âœ… **Mockå®Œæ•´**: å®Œæ•´çš„X6 Graphæ¨¡æ‹Ÿ
- âœ… **å¼‚æ­¥å¤„ç†**: æ­£ç¡®å¤„ç†Promiseå’Œasync/await

### 6.4 æµ‹è¯•ç¼ºå¤±åœºæ™¯è¯†åˆ«

| ç¼ºå¤±åœºæ™¯ | ä¼˜å…ˆçº§ | å½±å“èŒƒå›´ | å»ºè®®è¡¥å…… |
|----------|--------|----------|----------|
| å¤§è§„æ¨¡å¹¶å‘åˆ›å»º | é«˜ | æ€§èƒ½ | æ·»åŠ å‹åŠ›æµ‹è¯• |
| å†…å­˜æ³„æ¼æ£€æµ‹ | ä¸­ | ç¨³å®šæ€§ | æ·»åŠ å†…å­˜ç›‘æ§ |
| è·¨æµè§ˆå™¨å…¼å®¹æ€§ | ä¸­ | å…¼å®¹æ€§ | æ·»åŠ æµè§ˆå™¨æµ‹è¯• |
| å®æ—¶åä½œåœºæ™¯ | ä½ | åŠŸèƒ½æ‰©å±• | æœªæ¥è€ƒè™‘ |

---

## ğŸ” 7. é—®é¢˜è¯†åˆ«å’Œä¼˜åŒ–å»ºè®®

### 7.1 ä»£ç é‡å¤é—®é¢˜

#### å·²è¯†åˆ«çš„é‡å¤ä»£ç 
```javascript
// é—®é¢˜1: é¢„è§ˆçº¿åˆ›å»ºé€»è¾‘é‡å¤
// ä½ç½®: usePreviewLine.js å’Œ UnifiedEdgeManager.js
// å½±å“: ç»´æŠ¤æˆæœ¬å¢åŠ ï¼Œé€»è¾‘ä¸ä¸€è‡´é£é™©

// é—®é¢˜2: èŠ‚ç‚¹éªŒè¯é€»è¾‘é‡å¤  
// ä½ç½®: å¤šä¸ªç»„ä»¶ä¸­çš„èŠ‚ç‚¹å­˜åœ¨æ€§æ£€æŸ¥
// å½±å“: ä»£ç å†—ä½™ï¼Œæ€§èƒ½æŸè€—
```

#### è§£å†³æ–¹æ¡ˆ
```javascript
// å»ºè®®1: ç»Ÿä¸€é¢„è§ˆçº¿åˆ›å»ºå…¥å£
// æ‰€æœ‰é¢„è§ˆçº¿åˆ›å»ºéƒ½é€šè¿‡UnifiedEdgeManager
const createPreviewLine = (sourceNodeId, options) => {
  return unifiedEdgeManager.createPreviewLine(sourceNodeId, options);
};

// å»ºè®®2: æŠ½å–å…¬å…±éªŒè¯å·¥å…·
class NodeValidator {
  static validateNodeExists(graph, nodeId) {
    // ç»Ÿä¸€èŠ‚ç‚¹éªŒè¯é€»è¾‘
  }
}
```

### 7.2 æ¶æ„è®¾è®¡åˆç†æ€§

#### ä¼˜åŠ¿åˆ†æ
- âœ… **èŒè´£æ¸…æ™°**: å„ç»„ä»¶èŒè´£æ˜ç¡®ï¼Œè¾¹ç•Œæ¸…æ¥š
- âœ… **æ‰©å±•æ€§å¥½**: æ¨¡å—åŒ–è®¾è®¡ï¼Œæ˜“äºæ‰©å±•æ–°åŠŸèƒ½
- âœ… **æ€§èƒ½ä¼˜åŒ–**: ç¼“å­˜æœºåˆ¶å’Œæ‰¹é‡æ“ä½œæ”¯æŒ
- âœ… **é”™è¯¯å¤„ç†**: å®Œå–„çš„é”™è¯¯æ¢å¤æœºåˆ¶

#### æ”¹è¿›ç©ºé—´
- âš ï¸ **ä¾èµ–å¤æ‚**: ç»„ä»¶é—´ä¾èµ–å…³ç³»è¾ƒå¤æ‚
- âš ï¸ **é…ç½®åˆ†æ•£**: é…ç½®é¡¹åˆ†æ•£åœ¨å¤šä¸ªæ–‡ä»¶ä¸­
- âš ï¸ **äº‹ä»¶ç³»ç»Ÿ**: äº‹ä»¶å‘½åå’Œå¤„ç†éœ€è¦æ ‡å‡†åŒ–

### 7.3 å…·ä½“ä¼˜åŒ–å»ºè®®

#### çŸ­æœŸä¼˜åŒ– (1-2å‘¨)
1. **ç»Ÿä¸€é…ç½®ç®¡ç†**
   ```javascript
   // åˆ›å»ºç»Ÿä¸€é…ç½®ä¸­å¿ƒ
   class UnifiedEdgeConfig {
     static getDefaultConfig() {
       return {
         previewLine: { /* é¢„è§ˆçº¿é…ç½® */ },
         connection: { /* è¿æ¥çº¿é…ç½® */ },
         performance: { /* æ€§èƒ½é…ç½® */ }
       };
     }
   }
   ```

2. **æ ‡å‡†åŒ–äº‹ä»¶å‘½å**
   ```javascript
   // ç»Ÿä¸€äº‹ä»¶å‘½åè§„èŒƒ
   const EVENTS = {
     PREVIEW_CREATED: 'unified-edge:preview:created',
     PREVIEW_UPDATED: 'unified-edge:preview:updated',
     CONNECTION_CREATED: 'unified-edge:connection:created'
   };
   ```

#### ä¸­æœŸä¼˜åŒ– (1ä¸ªæœˆ)
1. **ä¾èµ–æ³¨å…¥é‡æ„**
   ```javascript
   // ä½¿ç”¨ä¾èµ–æ³¨å…¥å®¹å™¨
   class EdgeSystemContainer {
     register(name, factory) { /* æ³¨å†ŒæœåŠ¡ */ }
     resolve(name) { /* è§£æä¾èµ– */ }
   }
   ```

2. **æ€§èƒ½ç›‘æ§å¢å¼º**
   ```javascript
   // æ·»åŠ è¯¦ç»†æ€§èƒ½æŒ‡æ ‡
   class PerformanceMonitor {
     trackOperation(name, operation) { /* æ€§èƒ½è¿½è¸ª */ }
     generateReport() { /* ç”Ÿæˆæ€§èƒ½æŠ¥å‘Š */ }
   }
   ```

#### é•¿æœŸä¼˜åŒ– (2-3ä¸ªæœˆ)
1. **å¾®æœåŠ¡æ¶æ„**
   - å°†é¢„è§ˆçº¿å’Œè¿æ¥çº¿ç®¡ç†æ‹†åˆ†ä¸ºç‹¬ç«‹æœåŠ¡
   - é€šè¿‡æ¶ˆæ¯æ€»çº¿è¿›è¡Œé€šä¿¡
   - æ”¯æŒç‹¬ç«‹éƒ¨ç½²å’Œæ‰©å±•

2. **æ™ºèƒ½åŒ–åŠŸèƒ½**
   - åŸºäºç”¨æˆ·è¡Œä¸ºçš„é¢„æµ‹æ€§é¢„è§ˆçº¿åˆ›å»º
   - è‡ªåŠ¨å¸ƒå±€ä¼˜åŒ–å»ºè®®
   - æ™ºèƒ½è¿æ¥æ¨è

---

## ğŸ“Š 8. ç»Ÿä¸€è¾¹æœåŠ¡ç³»ç»Ÿå¥åº·åº¦è¯„ä¼°

### 8.1 ç»Ÿä¸€æœåŠ¡æ¶æ„è¯„ä¼°ç»“æœ

| è¯„ä¼°ç»´åº¦ | å¾—åˆ† | æƒé‡ | åŠ æƒå¾—åˆ† | è¯„çº§ |
|----------|------|------|----------|------|
| **æ¶æ„ç»Ÿä¸€æ€§** | 95/100 | 25% | 23.8 | A |
| **æ¥å£ä¸€è‡´æ€§** | 93/100 | 20% | 18.6 | A |
| **æ•°æ®æ¨¡å‹ç»Ÿä¸€** | 94/100 | 20% | 18.8 | A |
| **è½¬æ¢æœºåˆ¶** | 91/100 | 15% | 13.7 | A- |
| **æ€§èƒ½è¡¨ç°** | 88/100 | 10% | 8.8 | B+ |
| **å¯ç»´æŠ¤æ€§** | 90/100 | 10% | 9.0 | A- |
| **æ€»åˆ†** | - | 100% | **92.7** | **A-** |

### 8.2 ç»Ÿä¸€æœåŠ¡æ ¸å¿ƒä¼˜åŠ¿

#### ğŸ¯ æ¶æ„ä¼˜åŠ¿
1. **çœŸæ­£çš„ç»Ÿä¸€ç®¡ç†**: é¢„è§ˆçº¿å’Œè¿æ¥çº¿åªæ˜¯åŒä¸€è¾¹å®ä½“çš„ä¸åŒçŠ¶æ€
2. **å•ä¸€æœåŠ¡å…¥å£**: UnifiedEdgeManager ä½œä¸ºå”¯ä¸€çš„è¾¹ç®¡ç†æœåŠ¡
3. **è½¬æ¢å…³ç³»æ¸…æ™°**: é¢„è§ˆçº¿ â†” è¿æ¥çº¿çš„è½¬æ¢é€»è¾‘ç®€å•æ˜äº†
4. **æ¶ˆé™¤é‡å¤ä»£ç **: ä¸å†æœ‰ç‹¬ç«‹çš„é¢„è§ˆçº¿å’Œè¿æ¥çº¿ç³»ç»Ÿ
5. **ç»Ÿä¸€çš„ç”Ÿå‘½å‘¨æœŸ**: åˆ›å»º â†’ è½¬åŒ– â†’ åˆ é™¤çš„ç»Ÿä¸€æµç¨‹

#### ğŸš€ æŠ€æœ¯äº®ç‚¹
- **ç»Ÿä¸€æ•°æ®æ¨¡å‹**: é€šè¿‡ type å­—æ®µåŒºåˆ†è¾¹ç±»å‹ï¼Œæ•°æ®ç»“æ„ä¸€è‡´
- **æ™ºèƒ½ç´¢å¼•ç³»ç»Ÿ**: ç±»å‹ç´¢å¼•ã€èŠ‚ç‚¹ç´¢å¼•ã€åˆ†æ”¯ç´¢å¼•çš„ç»Ÿä¸€ç®¡ç†
- **äº‹ä»¶é©±åŠ¨æ¶æ„**: ç»Ÿä¸€çš„äº‹ä»¶ç³»ç»Ÿå¤„ç†æ‰€æœ‰è¾¹æ“ä½œ
- **æ‰¹é‡æ“ä½œä¼˜åŒ–**: ç»Ÿä¸€çš„æ‰¹é‡å¤„ç†æœºåˆ¶
- **çŠ¶æ€è½¬æ¢ä¼˜åŒ–**: é«˜æ•ˆçš„é¢„è§ˆçº¿â†”è¿æ¥çº¿è½¬æ¢

#### ğŸ“ˆ æ€§èƒ½æå‡
- **å­˜å‚¨ä¼˜åŒ–**: ç»Ÿä¸€å­˜å‚¨å‡å°‘å†…å­˜å ç”¨
- **æŸ¥è¯¢ä¼˜åŒ–**: ç»Ÿä¸€ç´¢å¼•æå‡æŸ¥è¯¢æ€§èƒ½
- **ç¼“å­˜ä¼˜åŒ–**: ç»Ÿä¸€ç¼“å­˜ç­–ç•¥æé«˜å“åº”é€Ÿåº¦
- **æ‰¹é‡ä¼˜åŒ–**: ç»Ÿä¸€æ‰¹é‡æ“ä½œå‡å°‘ç³»ç»Ÿå¼€é”€

### 8.3 ç»Ÿä¸€æœåŠ¡è®¾è®¡ä»·å€¼

#### ğŸ—ï¸ è®¾è®¡ç†å¿µä»·å€¼
1. **ç®€åŒ–å¤æ‚æ€§**: å°†ä¸¤å¥—ç³»ç»Ÿåˆå¹¶ä¸ºä¸€ä¸ªç»Ÿä¸€æœåŠ¡
2. **æé«˜ä¸€è‡´æ€§**: ç»Ÿä¸€çš„æ¥å£å’Œæ•°æ®æ¨¡å‹
3. **å¢å¼ºå¯ç»´æŠ¤æ€§**: å•ä¸€ä»£ç è·¯å¾„ï¼Œå‡å°‘ç»´æŠ¤æˆæœ¬
4. **æå‡æ‰©å±•æ€§**: ç»Ÿä¸€æ¶æ„ä¾¿äºåŠŸèƒ½æ‰©å±•
5. **ä¼˜åŒ–æ€§èƒ½**: ç»Ÿä¸€ç®¡ç†å‡å°‘ç³»ç»Ÿå¼€é”€

#### ğŸ¯ ä¸šåŠ¡ä»·å€¼
- **å¼€å‘æ•ˆç‡**: ç»Ÿä¸€çš„APIå‡å°‘å­¦ä¹ æˆæœ¬
- **ä»£ç è´¨é‡**: æ¶ˆé™¤é‡å¤ä»£ç ï¼Œæé«˜ä»£ç è´¨é‡
- **ç³»ç»Ÿç¨³å®šæ€§**: å•ä¸€æœåŠ¡å‡å°‘æ•…éšœç‚¹
- **åŠŸèƒ½ä¸€è‡´æ€§**: ç»Ÿä¸€çš„è¡Œä¸ºå’Œä½“éªŒ

### 8.4 ç»Ÿä¸€æœåŠ¡å‘å±•è·¯çº¿

#### ğŸ“‹ çŸ­æœŸç›®æ ‡ (1-2ä¸ªæœˆ)
- [ ] å®Œå…¨ç§»é™¤ç‹¬ç«‹çš„é¢„è§ˆçº¿å’Œè¿æ¥çº¿ç³»ç»Ÿ
- [ ] ä¼˜åŒ–ç»Ÿä¸€æ¥å£è®¾è®¡
- [ ] å®Œå–„ç»Ÿä¸€æœåŠ¡æ–‡æ¡£
- [ ] å¢åŠ ç»Ÿä¸€æœåŠ¡æµ‹è¯•ç”¨ä¾‹

#### ğŸ¯ ä¸­æœŸç›®æ ‡ (2-4ä¸ªæœˆ)
- [ ] å®ç°æ›´é«˜çº§çš„è½¬æ¢åŠŸèƒ½
- [ ] ä¼˜åŒ–ç»Ÿä¸€å­˜å‚¨å’Œç´¢å¼•
- [ ] å¢å¼ºç»Ÿä¸€äº‹ä»¶ç³»ç»Ÿ
- [ ] å®Œå–„ç»Ÿä¸€é”™è¯¯å¤„ç†

#### ğŸš€ é•¿æœŸç›®æ ‡ (4-6ä¸ªæœˆ)
- [ ] æ”¯æŒæ›´å¤æ‚çš„è¾¹ç±»å‹
- [ ] å®ç°æ™ºèƒ½åŒ–è¾¹ç®¡ç†
- [ ] æ„å»ºè¾¹ç®¡ç†ç”Ÿæ€
- [ ] å¼€æºç»Ÿä¸€è¾¹æœåŠ¡

---

## ğŸ“ 9. ç»Ÿä¸€è¾¹æœåŠ¡æ€»ç»“ä¸å±•æœ›

### 9.1 ç»Ÿä¸€æœåŠ¡æˆå°±

é¢„è§ˆçº¿è¿æ¥çº¿ç»Ÿä¸€è¾¹æœåŠ¡ç³»ç»Ÿå®ç°äº†çœŸæ­£çš„æ¶æ„ç»Ÿä¸€ï¼š

#### âœ… æ ¸å¿ƒæˆå°±
- **æ¶æ„ç»Ÿä¸€**: é¢„è§ˆçº¿å’Œè¿æ¥çº¿å®Œå…¨ç»Ÿä¸€ä¸ºä¸€ä¸ªæœåŠ¡
- **æ¥å£ç»Ÿä¸€**: ç»Ÿä¸€çš„åˆ›å»ºã€è½¬æ¢ã€åˆ é™¤ã€æŸ¥è¯¢æ¥å£
- **æ•°æ®ç»Ÿä¸€**: ç»Ÿä¸€çš„è¾¹æ•°æ®æ¨¡å‹å’Œå­˜å‚¨ç»“æ„
- **æµç¨‹ç»Ÿä¸€**: ç»Ÿä¸€çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†æµç¨‹

#### ğŸ¯ æŠ€æœ¯ä»·å€¼
- **ç®€åŒ–æ€§**: å•ä¸€æœåŠ¡å…¥å£ï¼Œç®€åŒ–ç³»ç»Ÿå¤æ‚åº¦
- **ä¸€è‡´æ€§**: ç»Ÿä¸€çš„è¡Œä¸ºå’Œæ¥å£è®¾è®¡
- **é«˜æ•ˆæ€§**: ç»Ÿä¸€ç®¡ç†æå‡ç³»ç»Ÿæ€§èƒ½
- **å¯ç»´æŠ¤æ€§**: æ¶ˆé™¤é‡å¤ä»£ç ï¼Œæé«˜ä»£ç è´¨é‡

### 9.2 ç»Ÿä¸€æœåŠ¡å‰æ™¯

#### ğŸŒŸ åº”ç”¨ä»·å€¼
1. **å¼€å‘æ•ˆç‡**: ç»Ÿä¸€APIå‡å°‘å¼€å‘å­¦ä¹ æˆæœ¬
2. **ç³»ç»Ÿç¨³å®š**: å•ä¸€æœåŠ¡å‡å°‘æ•…éšœé£é™©
3. **æ€§èƒ½ä¼˜åŒ–**: ç»Ÿä¸€ç®¡ç†æå‡ç³»ç»Ÿæ€§èƒ½
4. **æ‰©å±•ä¾¿åˆ©**: ç»Ÿä¸€æ¶æ„ä¾¿äºåŠŸèƒ½æ‰©å±•

#### ğŸš€ æŠ€æœ¯å‘å±•
1. **æ™ºèƒ½è½¬æ¢**: AIé©±åŠ¨çš„è¾¹ç±»å‹æ™ºèƒ½è½¬æ¢
2. **åŠ¨æ€ä¼˜åŒ–**: è¿è¡Œæ—¶çš„æ€§èƒ½åŠ¨æ€ä¼˜åŒ–
3. **å¯è§†åŒ–å¢å¼º**: æ›´ä¸°å¯Œçš„è¾¹å¯è§†åŒ–æ•ˆæœ
4. **åä½œæ”¯æŒ**: å¤šç”¨æˆ·åä½œçš„è¾¹ç®¡ç†

### 9.3 ç»“è®º

é¢„è§ˆçº¿è¿æ¥çº¿ç»Ÿä¸€è¾¹æœåŠ¡ç³»ç»Ÿæ˜¯ä¸€ä¸ª**è®¾è®¡å…ˆè¿›ã€æ¶æ„ç»Ÿä¸€ã€æ€§èƒ½ä¼˜å¼‚**çš„è¾¹ç®¡ç†è§£å†³æ–¹æ¡ˆã€‚ç³»ç»ŸæˆåŠŸå®ç°äº†é¢„è§ˆçº¿å’Œè¿æ¥çº¿çš„å®Œå…¨ç»Ÿä¸€ç®¡ç†ï¼Œæ¶ˆé™¤äº†ç³»ç»Ÿé‡å¤å’Œå¤æ‚æ€§ï¼Œè¾¾åˆ°äº†**ç”Ÿäº§å°±ç»ª**çš„é«˜æ ‡å‡†ã€‚

é€šè¿‡ç»Ÿä¸€æœåŠ¡æ¶æ„ï¼Œç³»ç»Ÿä¸ä»…ç®€åŒ–äº†å¼€å‘å’Œç»´æŠ¤å·¥ä½œï¼Œè¿˜æå‡äº†æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒï¼Œä¸ºå„ç±»å¯è§†åŒ–åº”ç”¨æä¾›äº†**ä¸šç•Œé¢†å…ˆ**çš„è¾¹ç®¡ç†è§£å†³æ–¹æ¡ˆã€‚

---

**æŠ¥å‘Šç”Ÿæˆå®Œæˆ** âœ…  
**ç³»ç»ŸçŠ¶æ€**: ç”Ÿäº§å°±ç»ª ğŸš€  
**æ¶æ„ç»Ÿä¸€åº¦**: 95.0% ğŸ¯  
**å»ºè®®ç­‰çº§**: å¼ºçƒˆæ¨èä½¿ç”¨ â­â­â­â­â­

*æŠ¥å‘Šç”Ÿæˆæ—¶é—´: 2024å¹´12æœˆ*  
*ç³»ç»Ÿç‰ˆæœ¬: v3.0.0 (ç»Ÿä¸€æœåŠ¡æ¶æ„ç‰ˆ)*  
*æ¶æ„ç»Ÿä¸€åº¦: 95.0%*  
*ç»¼åˆè¯„åˆ†: 92.7/100 (A- çº§åˆ«)*