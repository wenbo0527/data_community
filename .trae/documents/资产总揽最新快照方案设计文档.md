# 资产总揽（最新快照）产品与视觉设计文档

## 目标与原则
- 统一展示“当前最新快照”的资产规模、健康与关系，不提供时间范围选择
- 三层结构：概览指标 → 关系洞察 → 最新清单，信息清晰、引导明确
- 与数据发现能力融合：即搜即得、结构化筛选、关系高亮、质量预警
- 保持页面简洁、统一风格，强调关键数据与状态

## 信息架构
- 顶部导航
  - 标题“资产总揽”
  - 全局搜索（名称/标签/域/类型/平台，自动补全）
  - 刷新按钮与“已更新：xx秒前”提示（支持自动刷新开关）
  - 视图切换：概览、关系、清单
- 概览指标（一级）
  - 资产总数（当前）、活跃资产数（当前）、关系连接数（当前）、异常资产数（当前）
  - 综合健康分（质量/更新/使用综合评分，当前）
- 分布与预警（二级）
  - 分类分布（单维度切换：类型/域/平台，当前占比）
  - 最新预警摘要（未关闭的质量/合规/运维预警）
- 关系洞察（核心）
  - 资产关系图（血缘/依赖/引用拓扑，当前）
  - 左侧筛选器（类型/域/平台/仅存在关系/仅异常资产）
  - 右上角小地图、布局切换（层次/力导）
  - 关系摘要：关键路径、孤立节点数、入度/出度极值
- 最新清单（三级）
  - 列表默认按“最近更新时间”降序
  - 列：名称、类型、域、所有者、质量分、状态、最近更新时间
  - 顶部 chips 展示当前筛选条件；支持批量操作与导出
- 侧栏详情（从关系图或清单触发）
  - 基本信息、质量指标、使用统计、关系缩略图、最近变更记录
  - 操作入口：登记/评估/发布/运维/申请外数

## 关键交互
- 搜索联动
  - 输入即建议，高亮匹配；选择后清单顶置、关系图高亮并居中
- 筛选联动
  - 左侧筛选器与清单 chips 同步更新；关系图与清单双向联动
- 关系图操作
  - 悬浮显示属性卡片；双击打开详情抽屉
  - 一键高亮关键路径与孤立节点；布局切换不丢失筛选
- 刷新策略
  - 手动刷新 + 可选自动刷新（建议 60 秒）；顶部展示最近更新时间

## 视觉规范
- 栅格与间距
  - 24 栅格，卡片/图表间距 16px；组件对齐一致
- 字体与层次
  - 指标值 28–32px；标题 18px；辅助信息 12–14px
- 色彩与状态
  - 主色用于强调与交互；状态色统一（成功/警告/危险）
  - 关系图节点采用柔和类别色；异常状态用描边或徽标高亮
- 图表规范
  - 标签精简，突出比例与数量；避免杂色与过多网格线
- 信息密度
  - 中等密度，弱化非关键文本颜色，保证可读性

## 数据契约（最新快照）
- 概览与分布
  - GET /assets/snapshot/overview
    - total、active、relations、abnormal、healthScore、updatedAt
  - GET /assets/snapshot/distribution?dimension=type|domain|platform
    - buckets: [{key, count, ratio}]
- 预警
  - GET /assets/snapshot/alerts
    - list: [{id, severity, type, message, assetId, updatedAt}]
- 关系图
  - GET /assets/snapshot/graph
    - nodes: [{id, name, type, domain, platform, status, healthScore, updatedAt, tags}]
    - edges: [{source, target, type}]
    - metrics: {isolatedCount, maxInDegreeNode, maxOutDegreeNode, criticalPaths}
- 清单
  - GET /assets/snapshot/list?query=&filters={}
    - list: [{id, name, type, domain, owner, status, healthScore, updatedAt, tags}]
- 详情
  - GET /assets/snapshot/detail/:id
    - base、quality、usage、relationsMini、recentChanges
- 刷新
  - POST /assets/snapshot/refresh
    - 返回 updatedAt，用于展示“已更新：xx秒前”

## 组件清单（Arco + X6）
- 顶部导航：Input/AutoComplete、Button、Space、Segment
- 指标卡：Card、Statistic、Tag
- 分布图：ECharts（或项目已集成图表）
- 预警摘要：Alert、List、Badge
- 关系图：AntV X6 Graph + Minimap/Selection/Keyboard/Snapline/Transform
- 清单：Table、Tag、Pagination、Dropdown
- 侧栏详情：Drawer、Descriptions、Tabs、Tag

## 实现规划
- 里程碑 1（MVP）
  - 顶部导航、概览指标卡、分类分布（单维度）、最新清单、详情抽屉
  - 接入 snapshot 接口与刷新机制
- 里程碑 2（关系与预警）
  - 关系图及左侧筛选器；关键路径与孤立节点统计；Minimap
  - 最新预警摘要与跳转；异常节点高亮
- 里程碑 3（治理与优化）
  - 详情抽屉治理动作入口；批量操作；视图收藏
  - 性能优化：分层加载、虚拟化、筛选局部刷新

## 验收指标
- 首屏概览与分布渲染 ≤ 2 秒（最新快照）
- 关系图在 5000 节点/8000 边以内交互顺畅（筛选后）
- 搜索联动关系图与清单延迟 < 300ms（客户端高亮）
- 刷新后状态稳定，无闪屏与错乱；“已更新xx秒前”准确显示

## 线框说明
- 线框图使用 Mermaid 表示页面结构与区块关系
- 文件路径：.trae/documents/diagrams/资产总揽线框图.mmd
- 线框包含：导航、指标、分布/预警、关系洞察、清单、侧栏详情模块

