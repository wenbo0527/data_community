## 问题研判
- 高并发事件导致重渲染与 DOM 插入：
  - 节点悬停即写入数据，触发 vue-shape 重渲染：`src/pages/marketing/tasks/horizontal/index.vue:1226-1247`
  - 边悬停即插入工具按钮，产生频繁 DOM 变更：`src/pages/marketing/tasks/horizontal/index.vue:1406-1427`
- 插件重复启用造成监听与记录重复：
  - 历史插件重复：图配置内启用（`index.vue:847-853`）与二次 `graph.use(new History...)`（`index.vue:1033-1044`）
  - 选择插件重复：图配置内启用（`index.vue:1017-1023`）与二次 `graph.use(new Selection...)`（`index.vue:1155-1162`）
- 拖拽期间辅助 UI 开销：
  - Snapline、Minimap 在大量节点移动与视图变化时带来额外绘制与布局计算（`index.vue:3195-3204`, `index.vue:3077-3115`）
- 过多日志输出降低帧率：大量 `console.log` 分布在交互与布局流程中（多处）

## 优化目标
- 拖动画布时无明显卡顿与闪烁；节点与连线不在鼠标移动中频繁重绘或插入/移除 DOM。
- 保留必要交互反馈，削减高成本操作（数据写入、工具插入、日志输出）。

## 实施方案
### 1. 移除重复插件，保留单实例
- 历史插件：保留一种启用方式（推荐 `graph.use(new History(...))`），删除 Graph 配置内的 `history` 字段或相反。
  - 删除位置之一：`src/pages/marketing/tasks/horizontal/index.vue:847-853`
  - 保留位置：`index.vue:1033-1044`
- 选择插件：同理只保留一种方式（推荐 `graph.use(new Selection(...))`），删除 Graph 配置内的 `selecting`。
  - 删除位置之一：`index.vue:1017-1023`
  - 保留位置：`index.vue:1155-1162`

### 2. 将“悬停态/选中态”从数据写入改为样式类
- 替换 `node.setData({...hover})` 为样式类：`node.addClass('hover')` / `node.removeClass('hover')`；为 vue-shape 根元素提供 `:class` 绑定或使用 `:deep(.hover)` 样式，避免组件重渲染。
  - 修改位置：`index.vue:1226-1247`, `index.vue:1250-1260`
- 选中态也改为类管理，取消数据写入：`index.vue:1250-1260` 后续同理。

### 3. 降低边悬停的 DOM 工具插入频次
- 移除 `edge:mouseenter` 的 `edge.addTools([...])`，改为：
  - 仅在 `edge:selected` 或 `edge:contextmenu` 时插入工具，减少悬停大规模触发。
  - 现有右键菜单已具备删除功能（`index.vue:1386-1404`, `index.vue:2042-2053`），保留即可。

### 4. 拖拽期间暂停高开销 UI，结束后恢复
- 拖拽开始：关闭 `snapline` 和（可选）`minimap` 更新；拖拽结束：恢复。
  - 新增事件监听：`graph.on('pan:start')` / `graph.on('pan:end')` 或通过 `pointerdown`/`pointerup` 近似实现。
  - 开关辅助线：`graph.setSnaplineEnabled(false/true)`（参考 `index.vue:3195-3204`）
  - 小地图：仅在可视化需要时打开；拖拽中禁更（通过标志位拦截 `minimap.updateGraph`）。

### 5. 清理日志，压缩到 debug 模式
- 将大部分 `console.log` 包装为 `if (DEBUG) console.log(...)`，默认 `DEBUG=false`；保留关键错误日志。
  - 涉及布局、连线创建、事件回调等多处（如 `index.vue:3207-3274`, `index.vue:3248-3251`, `index.vue:3409-3493` 等）。

### 6. 维持单一拖拽平移通道
- 只启用 `panning: { enabled: true, eventTypes: ['leftMouseDown'] }`，确保无其它平移通道冲突；`scroller.pannable=false`。
  - 已配置位置：`index.vue:828-831`, `index.vue:1019-1022`, `index.vue:789-793`

### 7. 其他建议（按需）
- 边渲染样式简化：统一 `connector: 'orth'` 在大量边时更稳；按需评估（当前为 `smooth`）。
- 边标签延迟显示：仅在选中或静止时显示标签，拖拽时隐藏（减少文字布局计算）。

## 验收与回归
- 测试节点数 300+，边 400+：拖动画布 FPS 明显提升，无明显闪屏。
- 悬停与选中：无大规模重渲染；右键菜单功能可用。
- 布局后：不溢出容器时自动居中；溢出时不强制居中，避免跳变。

## 变更范围
- 文件：`src/pages/marketing/tasks/horizontal/index.vue`（交互与插件管理、日志门控）
- 文件：`src/pages/marketing/tasks/horizontal/HorizontalNode.vue`（如需为 hover/selected 提供样式类支持）

请确认以上方案，我将按步骤实施，并提交对比前后性能数据与关键改动点。