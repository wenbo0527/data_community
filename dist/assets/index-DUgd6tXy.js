import{_ as Y,u as H,p as x,r as D,c as j,f as e,w as a,M as E,e as n,o as T,h as g,j as d,i as I,Q as F,t as h,d as J,g as Q}from"./index-CsgcdrY7.js";import{recordMockData as q}from"./coupon-BKFb4O9B.js";import{I as A}from"./index-BmBsqAcj.js";import{I as G}from"./index-CrAnsjHE.js";const K={class:"coupon-record-container"},L={class:"form-content"},O={class:"form-row"},W={class:"form-actions"},X={__name:"index",setup(Z){H().params.id;const t=x({userId:"",couponId:"",packageId:"",taskId:"",count:void 0,time:[],status:void 0,operationType:void 0}),y=D([]),m=D(!1),s=x({total:0,current:1,pageSize:10,showTotal:!0,showJumper:!0,showPageSize:!0}),_=async()=>{m.value=!0;try{const r=q,l=(s.current-1)*s.pageSize,p=l+s.pageSize;y.value=r.slice(l,p),s.total=r.length}catch(r){console.error("获取发放记录失败:",r),E.error("获取发放记录失败")}finally{m.value=!1}},w=()=>{s.current=1,_()},z=()=>{t.userId="",t.couponId="",t.packageId="",t.taskId="",t.count=void 0,t.time=[],t.status=void 0,t.operationType=void 0,w()},S=r=>{s.current=r,_()},C=r=>{s.pageSize=r,s.current=1,_()};return _(),(r,l)=>{const p=n("a-input"),u=n("a-form-item"),R=n("a-range-picker"),i=n("a-option"),V=n("a-select"),f=n("a-button"),U=n("a-space"),M=n("a-form"),k=n("a-card"),P=n("a-typography-title"),v=n("a-tooltip"),c=n("a-table-column"),b=n("a-tag"),B=n("a-typography-text"),N=n("a-table");return T(),j("div",K,[e(k,{class:"search-card",bordered:!1},{default:a(()=>[e(M,{model:t,layout:"inline",class:"filter-form"},{default:a(()=>[g("div",L,[e(u,{field:"userId",label:"用户ID"},{default:a(()=>[e(p,{modelValue:t.userId,"onUpdate:modelValue":l[0]||(l[0]=o=>t.userId=o),placeholder:"请输入用户ID","allow-clear":""},null,8,["modelValue"])]),_:1}),e(u,{field:"couponId",label:"券实例ID"},{default:a(()=>[e(p,{modelValue:t.couponId,"onUpdate:modelValue":l[1]||(l[1]=o=>t.couponId=o),placeholder:"请输入券实例ID","allow-clear":""},null,8,["modelValue"])]),_:1}),e(u,{field:"packageId",label:"券包ID"},{default:a(()=>[e(p,{modelValue:t.packageId,"onUpdate:modelValue":l[2]||(l[2]=o=>t.packageId=o),placeholder:"请输入券包ID","allow-clear":""},null,8,["modelValue"])]),_:1}),e(u,{field:"taskId",label:"任务ID"},{default:a(()=>[e(p,{modelValue:t.taskId,"onUpdate:modelValue":l[3]||(l[3]=o=>t.taskId=o),placeholder:"请输入任务ID","allow-clear":""},null,8,["modelValue"])]),_:1}),g("div",O,[e(u,{field:"time",label:"发放时间",class:"date-form-item"},{default:a(()=>[e(R,{modelValue:t.time,"onUpdate:modelValue":l[4]||(l[4]=o=>t.time=o),"show-time":"",format:"YYYY-MM-DD HH:mm:ss",placeholder:["开始时间","结束时间"]},null,8,["modelValue"])]),_:1}),e(u,{field:"status",label:"发放状态"},{default:a(()=>[e(V,{modelValue:t.status,"onUpdate:modelValue":l[5]||(l[5]=o=>t.status=o),placeholder:"全部状态","allow-clear":""},{default:a(()=>[e(i,{value:"success"},{default:a(()=>[d("成功")]),_:1}),e(i,{value:"failed"},{default:a(()=>[d("失败")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(u,{field:"operationType",label:"流水类型"},{default:a(()=>[e(V,{modelValue:t.operationType,"onUpdate:modelValue":l[6]||(l[6]=o=>t.operationType=o),placeholder:"全部类型","allow-clear":""},{default:a(()=>[e(i,{value:"发放"},{default:a(()=>[d("发放")]),_:1}),e(i,{value:"锁定"},{default:a(()=>[d("锁定")]),_:1}),e(i,{value:"解锁"},{default:a(()=>[d("解锁")]),_:1}),e(i,{value:"核销"},{default:a(()=>[d("核销")]),_:1}),e(i,{value:"过期"},{default:a(()=>[d("过期")]),_:1}),e(i,{value:"作废"},{default:a(()=>[d("作废")]),_:1})]),_:1},8,["modelValue"])]),_:1})])]),g("div",W,[e(U,null,{default:a(()=>[e(f,{type:"primary",onClick:w},{icon:a(()=>[e(I(F))]),default:a(()=>[d(" 搜索 ")]),_:1}),e(f,{onClick:z},{icon:a(()=>[e(I(A))]),default:a(()=>[d(" 重置 ")]),_:1})]),_:1})])]),_:1},8,["model"])]),_:1}),e(k,{class:"table-card",bordered:!1},{title:a(()=>[e(P,{heading:6,style:{margin:"0"}},{default:a(()=>[d(" 流水记录列表 ")]),_:1})]),extra:a(()=>[e(v,{content:"下载流水记录"},{default:a(()=>[e(f,{type:"primary",size:"small"},{icon:a(()=>[e(I(G))]),default:a(()=>[d(" 下载记录 ")]),_:1})]),_:1})]),default:a(()=>[e(N,{data:y.value,loading:m.value,pagination:s,onPageChange:S,onPageSizeChange:C,bordered:{cell:!0,wrapper:!0},stripe:"",size:"small"},{columns:a(()=>[e(c,{title:"用户ID","data-index":"userId",width:120,align:"center"}),e(c,{title:"券实例ID","data-index":"couponId",width:140,align:"center"}),e(c,{title:"券包ID","data-index":"packageId",width:140,align:"center"}),e(c,{title:"任务ID","data-index":"taskId",width:140,align:"center"}),e(c,{title:"流水类型","data-index":"operationType",width:100,align:"center"},{cell:a(({record:o})=>[e(b,{color:{发放:"blue",锁定:"orange",解锁:"green",核销:"purple",过期:"red",作废:"gray"}[o.operationType],size:"small"},{default:a(()=>[d(h(o.operationType),1)]),_:2},1032,["color"])]),_:1}),e(c,{title:"状态","data-index":"status",width:80,align:"center"},{cell:a(({record:o})=>[e(b,{color:o.status==="成功"?"green":"red",size:"small"},{default:a(()=>[d(h(o.status),1)]),_:2},1032,["color"])]),_:1}),e(c,{title:"详情","data-index":"failedReason",width:200},{cell:a(({record:o})=>[o.failedReason?(T(),J(v,{key:0,content:o.failedReason,position:"left"},{default:a(()=>[e(B,{type:"secondary",style:{cursor:"help",display:"inline-block","max-width":"180px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},{default:a(()=>[d(h(o.failedReason),1)]),_:2},1024)]),_:2},1032,["content"])):Q("",!0)]),_:1}),e(c,{title:"发放时间","data-index":"operationTime",width:160,align:"center"})]),_:1},8,["data","loading","pagination"])]),_:1})])}}},le=Y(X,[["__scopeId","data-v-6e594ada"]]);export{le as default};
