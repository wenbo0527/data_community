import{B as G,p as T,r as h,b as H,c as k,f as e,w as a,e as u,o as f,j as n,i as g,Q as J,d as w,F as M,m as K,t as W,g as X,Z as Y,$ as ee,R as S,a0 as ae,_ as le}from"./index-CsgcdrY7.js";import{I as te}from"./index-BmBsqAcj.js";const oe={class:"policy-template-container"},ne=G({__name:"index",setup(de){const q=d=>{},r=T({templateId:"",messageType:"",title:""}),I=h([]),v=h(!1),c=T({current:1,pageSize:10,total:0}),V=h(!1),o=T({title:"",messageType:"",scene:"",tags:[],product:"",channel:"",frequencyControl:"",sendCount:1,sendTime:"",taskId:"",needShortMessage:!1,shortMessageTemplate:""}),D=[{label:"短信",value:"sms"},{label:"AI外呼",value:"ai_call"},{label:"人工外呼",value:"manual_call"}],$=()=>{},B=[{title:"模板ID",dataIndex:"id",width:120},{title:"消息类型",dataIndex:"messageType",width:100,render:({record:d})=>({sms:"短信",push:"推送",email:"邮件"})[d.messageType]||d.messageType},{title:"一级场景",dataIndex:"scene",width:120},{title:"策略Tag",dataIndex:"tags",render:({record:d})=>{var l;return S("div",(l=d.tags)==null?void 0:l.map(i=>S(ae,{color:"blue",style:{marginRight:"4px"}},()=>i)))}},{title:"消息标题",dataIndex:"title",ellipsis:!0,tooltip:!0},{title:"消息策略",dataIndex:"strategy",ellipsis:!0,tooltip:!0},{title:"操作",slotName:"operations",width:150}],C=()=>{c.current=1,y()},E=()=>{Object.keys(r).forEach(d=>{r[d]=""}),C()},N=d=>{c.current=d,y()},P=d=>{console.log("查看详情",d)},z=d=>{console.log("测试模板",d)},y=async()=>{v.value=!0;try{await new Promise(d=>setTimeout(d,500)),I.value=Array.from({length:10},(d,l)=>({id:`TP${1e3+l}`,messageType:["sms","push","email"][l%3],scene:["营销","风控","通知"][l%3],tags:[["高优先级","测试","正式"][l%3]],title:`模板标题${l+1}`,strategy:`策略描述${l+1}`})),c.total=30}catch(d){console.error("获取模板列表失败",d)}finally{v.value=!1}};return H(()=>{y()}),(d,l)=>{const i=u("a-input"),s=u("a-form-item"),m=u("a-option"),p=u("a-select"),_=u("a-button"),x=u("a-form"),U=u("a-card"),b=u("a-radio"),F=u("a-radio-group"),O=u("a-switch"),R=u("a-input-number"),j=u("a-date-picker"),A=u("a-modal"),L=u("a-space"),Q=u("a-table");return f(),k("div",oe,[e(U,{class:"search-card",bordered:!1},{default:a(()=>[e(x,{model:r,layout:"inline"},{default:a(()=>[e(s,{label:"模板ID"},{default:a(()=>[e(i,{modelValue:r.templateId,"onUpdate:modelValue":l[0]||(l[0]=t=>r.templateId=t),placeholder:"请输入模板ID"},null,8,["modelValue"])]),_:1}),e(s,{label:"消息类型"},{default:a(()=>[e(p,{modelValue:r.messageType,"onUpdate:modelValue":l[1]||(l[1]=t=>r.messageType=t),placeholder:"请选择消息类型"},{default:a(()=>[e(m,{value:"sms"},{default:a(()=>[n("短信")]),_:1}),e(m,{value:"push"},{default:a(()=>[n("推送")]),_:1}),e(m,{value:"email"},{default:a(()=>[n("邮件")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(s,{label:"消息标题"},{default:a(()=>[e(i,{modelValue:r.title,"onUpdate:modelValue":l[2]||(l[2]=t=>r.title=t),placeholder:"请输入消息标题"},null,8,["modelValue"])]),_:1}),e(s,null,{default:a(()=>[e(_,{type:"primary",onClick:C},{icon:a(()=>[e(g(J))]),default:a(()=>[n(" 搜索 ")]),_:1}),e(_,{onClick:E},{icon:a(()=>[e(g(te))]),default:a(()=>[n(" 重置 ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(U,{class:"table-card",bordered:!1},{extra:a(()=>[e(_,{type:"primary",onClick:l[3]||(l[3]=t=>V.value=!0)},{default:a(()=>[n("新建策略模板")]),_:1})]),default:a(()=>[e(A,{visible:V.value,"onUpdate:visible":l[15]||(l[15]=t=>V.value=t),title:"新建策略模板",width:"800px",onOk:$},{default:a(()=>[e(x,{model:o,layout:"vertical"},{default:a(()=>[e(s,{label:"标题",required:""},{default:a(()=>[e(i,{modelValue:o.title,"onUpdate:modelValue":l[4]||(l[4]=t=>o.title=t)},null,8,["modelValue"])]),_:1}),e(s,{label:"消息类型",required:""},{default:a(()=>[e(F,{modelValue:o.messageType,"onUpdate:modelValue":l[5]||(l[5]=t=>o.messageType=t)},{default:a(()=>[e(b,{value:"sms"},{default:a(()=>[n("短信")]),_:1}),e(b,{value:"push"},{default:a(()=>[n("推送")]),_:1}),e(b,{value:"email"},{default:a(()=>[n("邮件")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(s,{label:"一级场景",required:""},{default:a(()=>[e(p,{modelValue:o.scene,"onUpdate:modelValue":l[6]||(l[6]=t=>o.scene=t)},{default:a(()=>[e(m,{value:"marketing"},{default:a(()=>[n("营销")]),_:1}),e(m,{value:"risk"},{default:a(()=>[n("风控")]),_:1}),e(m,{value:"notification"},{default:a(()=>[n("通知")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(s,{label:"策略Tag",required:""},{default:a(()=>[e(p,{modelValue:o.tags,"onUpdate:modelValue":l[7]||(l[7]=t=>o.tags=t),mode:"multiple"},{default:a(()=>[e(m,{value:"high_priority"},{default:a(()=>[n("高优先级")]),_:1}),e(m,{value:"test"},{default:a(()=>[n("测试")]),_:1}),e(m,{value:"production"},{default:a(()=>[n("生产")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(s,{label:"目标渠道",required:""},{default:a(()=>[e(p,{modelValue:o.channel,"onUpdate:modelValue":l[8]||(l[8]=t=>o.channel=t),onChange:q},{default:a(()=>[(f(),k(M,null,K(D,t=>e(m,{key:t.value,value:t.value},{default:a(()=>[n(W(t.label),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])]),_:1}),o.channel==="sms"?(f(),w(s,{key:0,label:"短信模板"},{default:a(()=>[e(p,{modelValue:o.shortMessageTemplate,"onUpdate:modelValue":l[9]||(l[9]=t=>o.shortMessageTemplate=t)},{default:a(()=>[e(m,{value:"template1"},{default:a(()=>[n("模板1")]),_:1}),e(m,{value:"template2"},{default:a(()=>[n("模板2")]),_:1})]),_:1},8,["modelValue"])]),_:1})):(f(),k(M,{key:1},[e(s,{label:"任务ID",required:""},{default:a(()=>[e(i,{modelValue:o.taskId,"onUpdate:modelValue":l[10]||(l[10]=t=>o.taskId=t)},null,8,["modelValue"])]),_:1}),e(s,{label:"是否需要挂短"},{default:a(()=>[e(O,{modelValue:o.needShortMessage,"onUpdate:modelValue":l[11]||(l[11]=t=>o.needShortMessage=t)},null,8,["modelValue"])]),_:1}),o.needShortMessage?(f(),w(s,{key:0,label:"短信模板"},{default:a(()=>[e(p,{modelValue:o.shortMessageTemplate,"onUpdate:modelValue":l[12]||(l[12]=t=>o.shortMessageTemplate=t)},{default:a(()=>[e(m,{value:"template1"},{default:a(()=>[n("模板1")]),_:1}),e(m,{value:"template2"},{default:a(()=>[n("模板2")]),_:1})]),_:1},8,["modelValue"])]),_:1})):X("",!0)],64)),e(s,{label:"发送次数",required:""},{default:a(()=>[e(R,{modelValue:o.sendCount,"onUpdate:modelValue":l[13]||(l[13]=t=>o.sendCount=t),min:1},null,8,["modelValue"])]),_:1}),e(s,{label:"发送时间",required:""},{default:a(()=>[e(j,{modelValue:o.sendTime,"onUpdate:modelValue":l[14]||(l[14]=t=>o.sendTime=t),"show-time":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"]),e(Q,{data:I.value,columns:B,pagination:c,loading:v.value,onPageChange:N},{operations:a(({record:t})=>[e(L,null,{default:a(()=>[e(_,{type:"text",size:"small",onClick:Z=>P(t)},{icon:a(()=>[e(g(Y))]),default:a(()=>[n(" 查看 ")]),_:2},1032,["onClick"]),e(_,{type:"text",size:"small",onClick:Z=>z(t)},{icon:a(()=>[e(g(ee))]),default:a(()=>[n(" 测试 ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:1},8,["data","pagination","loading"])]),_:1})])}}}),me=le(ne,[["__scopeId","data-v-66d1d760"]]);export{me as default};
