import{_ as G,r as u,c as p,h as a,f as l,w as o,F as B,m as I,t as M,s as H,v as J,e as c,o as v,j as n,i as S,x as N,g as w,d as K,X as Q,Y as b,M as r}from"./index-CsgcdrY7.js";const d=h=>(H("data-v-bd5a649b"),h=h(),J(),h),W={class:"content"},Z={class:"page-header"},$=d(()=>a("h2",null,"全量变量回溯申请",-1)),ee={class:"application-list"},ae={class:"products-grid"},te={class:"add-icon"},le=d(()=>a("div",{class:"add-text"},"添加申请",-1)),se={class:"application-description"},oe={class:"description-header"},de=d(()=>a("span",{class:"description-title"},"申请说明",-1)),ne={class:"character-count"},ie={class:"confirm-section"},ue={class:"modal-content"},ce={class:"form-section"},re=d(()=>a("div",{class:"section-title"},"变量范围",-1)),ve={key:0,class:"custom-products"},_e=d(()=>a("div",{class:"section-title"},"选择数据产品",-1)),pe={class:"form-section"},me=d(()=>a("div",{class:"section-title"},"执行周期",-1)),fe={key:0,class:"form-section"},be=d(()=>a("div",{class:"section-title"},"回溯日期区间",-1)),he={class:"date-range"},Ve=d(()=>a("span",{class:"date-label"},"开始日期",-1)),ye=d(()=>a("span",{class:"date-separator"},"-",-1)),De=d(()=>a("span",{class:"date-label"},"结束日期",-1)),xe={class:"date-modal-content"},ke={class:"date-option"},Ce={key:0,class:"custom-date"},ge={class:"date-range-picker"},Se=d(()=>a("span",{class:"date-label"},"样本范围",-1)),we=d(()=>a("span",{class:"date-separator"},"-",-1)),Ue={__name:"backtrack",setup(h){const m=u(!1),f=u(!1),V=u("all"),y=u(null),D=u(null),x=u(""),e=u({variableScope:"all",selectedProducts:[],startDate:null,endDate:null,executionCycle:""}),A=u([{value:"user_profile",label:"用户画像数据"},{value:"transaction_data",label:"交易流水数据"},{value:"risk_score",label:"风险评分数据"},{value:"behavior_analysis",label:"行为分析数据"},{value:"credit_assessment",label:"信用评估数据"},{value:"market_data",label:"市场数据"},{value:"external_data",label:"外部数据源"},{value:"financial_indicators",label:"财务指标数据"}]),U=()=>{m.value=!0,e.value={variableScope:"all",selectedProducts:[],startDate:null,endDate:null,executionCycle:""}},E=i=>e.value.executionCycle==="daily"?i&&i.isAfter(b().subtract(1,"day"),"day"):!1,O=i=>e.value.executionCycle==="once"?i&&!i.isSame(b().subtract(1,"day"),"day"):e.value.startDate?i&&i.isBefore(b(e.value.startDate),"day"):!1,j=()=>{f.value=!0},z=()=>{if(!e.value.executionCycle){r.error("请选择执行周期");return}if(e.value.executionCycle==="daily"&&!e.value.startDate){r.error("请选择开始日期");return}if(e.value.executionCycle==="once"&&!e.value.endDate){r.error("请选择结束日期");return}if(e.value.variableScope==="custom"&&e.value.selectedProducts.length===0){r.error("请选择至少一个数据产品");return}if(e.value.startDate&&e.value.endDate&&b(e.value.endDate).isBefore(b(e.value.startDate))){r.error("结束时间必须晚于开始时间");return}m.value=!1,r.success("任务创建成功")},F=()=>{m.value=!1},R=()=>{V.value==="custom"&&y.value&&D.value&&(e.value.startDate=y.value,e.value.endDate=D.value),f.value=!1},L=()=>{f.value=!1},T=()=>{if(!x.value.trim()){r.error("请输入申请说明");return}r.success("申请提交成功")};return(i,s)=>{const C=c("a-button"),X=c("a-textarea"),_=c("a-radio"),g=c("a-radio-group"),Y=c("a-option"),q=c("a-select"),k=c("a-date-picker"),P=c("a-modal");return v(),p("div",W,[a("div",Z,[$,l(C,{type:"primary",onClick:U},{icon:o(()=>[l(S(N))]),default:o(()=>[n(" 添加 ")]),_:1})]),a("div",ee,[a("div",ae,[(v(),p(B,null,I(4,t=>a("div",{key:t,class:"add-product-item",onClick:U},[a("div",te,[l(S(N))]),le])),64))])]),a("div",se,[a("div",oe,[de,a("span",ne,M(x.value.length)+"/1000",1)]),l(X,{modelValue:x.value,"onUpdate:modelValue":s[0]||(s[0]=t=>x.value=t),placeholder:"请输入申请说明","max-length":1e3,"auto-size":{minRows:4,maxRows:8},"show-word-limit":"",class:"description-textarea"},null,8,["modelValue"]),a("div",ie,[l(C,{type:"primary",size:"large",onClick:T},{default:o(()=>[n(" 确认 ")]),_:1})])]),l(P,{visible:m.value,"onUpdate:visible":s[6]||(s[6]=t=>m.value=t),title:"添加申请",width:"600px","mask-closable":!1,onOk:z,onCancel:F},{default:o(()=>[a("div",ue,[a("div",ce,[re,l(g,{modelValue:e.value.variableScope,"onUpdate:modelValue":s[1]||(s[1]=t=>e.value.variableScope=t),class:"radio-group"},{default:o(()=>[l(_,{value:"all"},{default:o(()=>[n("全部")]),_:1}),l(_,{value:"custom"},{default:o(()=>[n("自定义")]),_:1})]),_:1},8,["modelValue"]),e.value.variableScope==="custom"?(v(),p("div",ve,[_e,l(q,{modelValue:e.value.selectedProducts,"onUpdate:modelValue":s[2]||(s[2]=t=>e.value.selectedProducts=t),placeholder:"请选择数据产品",multiple:"","allow-clear":"","max-tag-count":3},{default:o(()=>[(v(!0),p(B,null,I(A.value,t=>(v(),K(Y,{key:t.value,value:t.value},{default:o(()=>[n(M(t.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])])):w("",!0)]),a("div",pe,[me,l(g,{modelValue:e.value.executionCycle,"onUpdate:modelValue":s[3]||(s[3]=t=>e.value.executionCycle=t),class:"radio-group"},{default:o(()=>[l(_,{value:"daily"},{default:o(()=>[n("每日")]),_:1}),l(_,{value:"once"},{default:o(()=>[n("仅本次")]),_:1})]),_:1},8,["modelValue"])]),e.value.executionCycle?(v(),p("div",fe,[be,a("div",he,[Ve,l(k,{modelValue:e.value.startDate,"onUpdate:modelValue":s[4]||(s[4]=t=>e.value.startDate=t),placeholder:"请选择开始日期","disabled-date":E},null,8,["modelValue"]),ye,De,l(k,{modelValue:e.value.endDate,"onUpdate:modelValue":s[5]||(s[5]=t=>e.value.endDate=t),placeholder:"请选择结束日期","disabled-date":O},null,8,["modelValue"]),l(C,{type:"text",onClick:j},{default:o(()=>[l(S(Q))]),_:1})])])):w("",!0)])]),_:1},8,["visible"]),l(P,{visible:f.value,"onUpdate:visible":s[10]||(s[10]=t=>f.value=t),title:"添加申请",width:"400px","mask-closable":!1,onOk:R,onCancel:L},{default:o(()=>[a("div",xe,[a("div",ke,[l(g,{modelValue:V.value,"onUpdate:modelValue":s[7]||(s[7]=t=>V.value=t),class:"date-radio-group"},{default:o(()=>[l(_,{value:"all"},{default:o(()=>[n("全部")]),_:1}),l(_,{value:"custom"},{default:o(()=>[n("自定义")]),_:1})]),_:1},8,["modelValue"])]),V.value==="custom"?(v(),p("div",Ce,[a("div",ge,[Se,l(k,{modelValue:y.value,"onUpdate:modelValue":s[8]||(s[8]=t=>y.value=t),placeholder:"开始日期"},null,8,["modelValue"]),we,l(k,{modelValue:D.value,"onUpdate:modelValue":s[9]||(s[9]=t=>D.value=t),placeholder:"结束日期"},null,8,["modelValue"])])])):w("",!0)])]),_:1},8,["visible"])])}}},Be=G(Ue,[["__scopeId","data-v-bd5a649b"]]);export{Be as default};
