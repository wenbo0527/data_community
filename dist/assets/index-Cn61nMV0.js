import{_ as K,r as k,b as U,c as S,f as t,w as e,M as g,e as i,J as G,o as m,h as _,j as s,i as Q,x as W,t as d,F as V,m as M,d as z,g as X,s as Y,v as Z,N}from"./index-CsgcdrY7.js";import{templateMockData as x}from"./coupon-BKFb4O9B.js";const T=v=>(Y("data-v-d06d5054"),v=v(),Z(),v),ee={class:"coupon-template-container"},te={class:"header-actions"},ae={class:"scope-row"},le=T(()=>_("span",{class:"scope-label"},"产品：",-1)),ne={class:"scope-row"},se=T(()=>_("span",{class:"scope-label"},"渠道：",-1)),oe={__name:"index",setup(v){const P=G(),f=k([]),b=k(!1),c=k({total:0,current:1,pageSize:10,showTotal:!0,showJumper:!0,showPageSize:!0}),u=async()=>{b.value=!0;try{f.value=x,c.value.total=x.length}catch{g.error("获取数据失败")}finally{b.value=!1}},B=(a,n)=>{if(!n||n.length===0)return;const r=x.filter(w=>a==="status"?n.includes(w[a]):w[a].toLowerCase().includes(n[0].toLowerCase()));f.value=r,c.value.total=r.length,c.value.current=1},F=a=>{c.value.current=a,u()},L=a=>{c.value.pageSize=a,c.value.current=1,u()},I=()=>{P.push("/marketing/coupon/create")},J=a=>{a.status==="生效中"?N.warning({title:"确认下线",content:`确定要下线模版「${a.name}」吗？`,onOk:()=>{a.status="已失效",g.success("下线成功"),u()}}):(a.status="生效中",g.success("上线成功"),u())},O=a=>{const n={...a};n.id=Date.now().toString(),n.name=`${a.name}_副本`,n.status="草稿",n.createTime=new Date().toLocaleString(),f.value.unshift(n),g.success("复制成功")},R=a=>{P.push({path:"/marketing/coupon/template/detail",query:{id:a.id,mode:"view"}})},j=a=>{N.warning({title:"确认删除",content:`确定要删除模版「${a.name}」吗？`,onOk:()=>{g.success("删除成功"),u()}})};U(()=>{u()});const D=k(""),q=a=>{if(!a){u();return}const n=x.filter(r=>r.type===a);f.value=n,c.value.total=n.length,c.value.current=1};return(a,n)=>{const r=i("a-option"),w=i("a-select"),C=i("a-button"),h=i("a-space"),$=i("a-card"),y=i("a-tag"),A=i("a-link"),p=i("a-table-column"),E=i("a-divider"),H=i("a-table");return m(),S("div",ee,[t($,{class:"header-card"},{default:e(()=>[_("div",te,[t(h,null,{default:e(()=>[t(w,{modelValue:D.value,"onUpdate:modelValue":n[0]||(n[0]=l=>D.value=l),placeholder:"选择模版类型",style:{width:"300px"},onChange:q,"allow-clear":""},{default:e(()=>[t(r,{value:"interest_free"},{default:e(()=>[s("免息券")]),_:1}),t(r,{value:"discount"},{default:e(()=>[s("折扣券")]),_:1})]),_:1},8,["modelValue"]),t(C,{type:"primary",onClick:I},{icon:e(()=>[t(Q(W))]),default:e(()=>[s(" 新建券模版 ")]),_:1})]),_:1})])]),_:1}),t($,{class:"table-card"},{default:e(()=>[t(H,{data:f.value,loading:b.value,pagination:c.value,bordered:!1,stripe:!0,onPageChange:F,onPageSizeChange:L,onFilterChange:B},{columns:e(()=>[t(p,{title:"模版名称","data-index":"name",width:200,filterable:{filterSearch:!0}},{cell:e(({record:l})=>[t(h,null,{default:e(()=>[t(y,{color:l.type==="interest_free"?"arcoblue":"green"},{default:e(()=>[s(d(l.type==="interest_free"?"免息券":"折扣券"),1)]),_:2},1032,["color"]),t(A,{onClick:o=>R(l)},{default:e(()=>[s(d(l.name),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:1}),t(p,{title:"适用范围","data-index":"scope",width:160},{cell:e(({record:l})=>[_("div",null,[_("div",ae,[le,t(h,{size:"mini"},{default:e(()=>[(m(!0),S(V,null,M(l.products,o=>(m(),z(y,{key:o,size:"small"},{default:e(()=>[s(d(o==="personal_loan"?"个人贷款":"企业贷款"),1)]),_:2},1024))),128))]),_:2},1024)]),_("div",ne,[se,t(h,{size:"mini"},{default:e(()=>[(m(!0),S(V,null,M(l.useChannels,o=>(m(),z(y,{key:o,size:"small"},{default:e(()=>[s(d(o==="app"?"APP":o==="miniprogram"?"小程序":"H5"),1)]),_:2},1024))),128))]),_:2},1024)])])]),_:1}),t(p,{title:"有效期","data-index":"validityPeriod",width:160},{cell:e(({record:l})=>[_("div",null,d(l.validityPeriodType==="unlimited"?"长期有效":`${l.validityPeriod[0].split(" ")[0]} 至 ${l.validityPeriod[1].split(" ")[0]}`),1)]),_:1}),t(p,{title:"属主","data-index":"creator",width:100,filterable:{filterSearch:!0}}),t(p,{title:"状态","data-index":"status",width:80,align:"center",filterable:{filterMultiple:!1},filters:[{text:"生效中",value:"生效中"},{text:"已失效",value:"已失效"},{text:"草稿",value:"草稿"}]},{cell:e(({record:l})=>[t(y,{color:l.status==="生效中"?"green":"gray"},{default:e(()=>[s(d(l.status),1)]),_:2},1032,["color"])]),_:1}),t(p,{title:"操作",width:100,align:"center"},{cell:e(({record:l})=>[t(h,{size:"mini"},{default:e(()=>[t(C,{type:"text",size:"small",onClick:o=>J(l),status:l.status==="生效中"?"danger":"success"},{default:e(()=>[s(d(l.status==="生效中"?"下线":"上线"),1)]),_:2},1032,["onClick","status"]),t(E,{direction:"vertical"}),l.status==="草稿"?(m(),z(C,{key:0,type:"text",size:"small",status:"danger",onClick:o=>j(l)},{default:e(()=>[s(" 删除 ")]),_:2},1032,["onClick"])):X("",!0),t(C,{type:"text",size:"small",onClick:o=>O(l)},{default:e(()=>[s(" 复制 ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data","loading","pagination"])]),_:1})])}}},ue=K(oe,[["__scopeId","data-v-d06d5054"]]);export{ue as default};
