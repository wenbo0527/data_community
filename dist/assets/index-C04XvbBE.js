import{B as Me,r,p as V,b as Be,c as te,h as p,g as I,f as e,w as t,e as d,s as Re,v as Ee,o as b,j as o,i as D,z as ae,t as k,d as O,M as c,_ as Pe}from"./index-CsgcdrY7.js";import{I as $e}from"./index-DQfydHiA.js";import{I as De}from"./index-B8gm8_GQ.js";const S=z=>(Re("data-v-e4a2df5e"),z=z(),Ee(),z),Oe={class:"batch-asset-management"},Ne={class:"page-header"},Ae=S(()=>p("h2",null,"资产批量管理",-1)),Fe={class:"stats-section"},je={class:"search-section"},Ke={key:0,class:"batch-toolbar"},Le=S(()=>p("div",{style:{"font-size":"12px",color:"#86909c","margin-top":"4px"}},[o(" 新增上传：在现有数据基础上添加新数据"),p("br"),o(" 覆盖上传：完全替换现有数据 ")],-1)),We={class:"upload-area"},qe=S(()=>p("div",null,"点击上传Excel文件",-1)),Ge=S(()=>p("div",{style:{"font-size":"12px",color:"#86909c","margin-top":"4px"}}," 仅支持 .xlsx, .xls 格式，文件大小不超过10MB ",-1)),He={class:"preview-container"},Je={class:"preview-header"},Qe=S(()=>p("span",null,"预览前5行数据",-1)),Xe=Me({__name:"index",setup(z){const g=r(!1),N=r(""),A=r(""),F=r(""),j=r(""),U=r(!1),M=r(!1),h=r([]),x=r([]),le=r(),y=r(!1),K=r([]),f=r({total:0,rows:[]}),s=V({dataType:"",mode:"append",startRow:2,batchSize:1e3,skipErrors:!0}),B=V({total:156,tables:89,metrics:45,external:22}),_=V({type:"",value:"",scope:"selected"}),oe=[{title:"资产名称",dataIndex:"name",width:200},{title:"资产类型",dataIndex:"assetType",slotName:"assetType",width:100},{title:"描述",dataIndex:"description",ellipsis:!0,tooltip:!0},{title:"负责人",dataIndex:"owner",width:100},{title:"业务分类",dataIndex:"category",width:120},{title:"状态",dataIndex:"status",slotName:"status",width:100},{title:"更新时间",dataIndex:"updateTime",width:160},{title:"操作",slotName:"actions",width:120,fixed:"right"}],ne=r([{id:1,name:"user_profile",assetType:"table",description:"用户基础信息表",owner:"张三",category:"用户数据",status:"active",updateTime:"2024-01-15 10:30:00"},{id:2,name:"用户活跃度",assetType:"metric",description:"统计用户活跃程度的指标",owner:"李四",category:"业务指标",status:"active",updateTime:"2024-01-15 11:45:00"},{id:3,name:"央行征信数据",assetType:"external",description:"个人和企业征信数据源",owner:"王五",category:"外部数据",status:"active",updateTime:"2024-01-14 16:20:00"}]),R=V({current:1,pageSize:10,total:3,showTotal:!0,showPageSize:!0}),se=V({type:"checkbox",showCheckedAll:!0,onlyCurrent:!1}),w=()=>{g.value=!0,setTimeout(()=>{g.value=!1},500)},de=()=>{N.value="",A.value="",F.value="",j.value="",w()},ue=n=>{R.current=n},ie=n=>{R.pageSize=n,R.current=1},re=n=>({table:"blue",metric:"green",external:"orange"})[n]||"gray",ce=n=>({table:"表",metric:"指标",external:"外数"})[n]||"未知",pe=n=>({active:"green",inactive:"orange",archived:"red"})[n]||"gray",ve=n=>({active:"活跃",inactive:"非活跃",archived:"已归档"})[n]||"未知",me=n=>{console.log("查看资产:",n)},_e=n=>{console.log("编辑资产:",n)},G=n=>{console.log("批量更新状态:",n,h.value),c.success(`批量${n==="active"?"启用":"停用"}成功`)},fe=()=>{console.log("批量分配负责人:",h.value)},he=()=>{console.log("批量删除:",h.value),c.success("批量删除成功")},be=()=>{console.log("导出选中:",h.value),c.success("导出成功")},ge=n=>{console.log("文件变化:",n),y.value=!1},xe=n=>{const a=n.type==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"||n.type==="application/vnd.ms-excel",i=n.size/1024/1024<10;return a?i?!0:(c.error("文件大小不能超过10MB！"),!1):(c.error("只能上传Excel文件！"),!1)},ye=()=>{y.value=!1,f.value={total:0,rows:[]}},L=n=>({behavior:"行为变量",credit:"征信变量"})[n]||"",we=()=>{if(!x.value.length){c.warning("请先上传文件");return}s.dataType==="behavior"?(K.value=[{title:"用户ID",dataIndex:"userId",width:100},{title:"行为类型",dataIndex:"behaviorType",width:120},{title:"行为时间",dataIndex:"behaviorTime",width:160},{title:"行为值",dataIndex:"behaviorValue",width:100},{title:"渠道",dataIndex:"channel",width:100}],f.value={total:1250,rows:[{userId:"U001",behaviorType:"登录",behaviorTime:"2024-01-15 09:30:00",behaviorValue:"1",channel:"APP"},{userId:"U002",behaviorType:"购买",behaviorTime:"2024-01-15 10:15:00",behaviorValue:"299.00",channel:"WEB"},{userId:"U003",behaviorType:"浏览",behaviorTime:"2024-01-15 11:20:00",behaviorValue:"5",channel:"APP"},{userId:"U004",behaviorType:"分享",behaviorTime:"2024-01-15 12:05:00",behaviorValue:"1",channel:"WEB"},{userId:"U005",behaviorType:"收藏",behaviorTime:"2024-01-15 13:45:00",behaviorValue:"3",channel:"APP"}]}):s.dataType==="credit"&&(K.value=[{title:"客户ID",dataIndex:"customerId",width:100},{title:"征信分数",dataIndex:"creditScore",width:100},{title:"逾期次数",dataIndex:"overdueCount",width:100},{title:"负债率",dataIndex:"debtRatio",width:100},{title:"更新时间",dataIndex:"updateTime",width:160}],f.value={total:856,rows:[{customerId:"C001",creditScore:"750",overdueCount:"0",debtRatio:"0.35",updateTime:"2024-01-15"},{customerId:"C002",creditScore:"680",overdueCount:"1",debtRatio:"0.42",updateTime:"2024-01-15"},{customerId:"C003",creditScore:"720",overdueCount:"0",debtRatio:"0.28",updateTime:"2024-01-15"},{customerId:"C004",creditScore:"650",overdueCount:"2",debtRatio:"0.55",updateTime:"2024-01-15"},{customerId:"C005",creditScore:"780",overdueCount:"0",debtRatio:"0.20",updateTime:"2024-01-15"}]}),y.value=!0,c.success("数据预览加载成功")},Te=()=>{if(!s.dataType){c.warning("请先选择数据类型");return}console.log("下载模板:",{behavior:"行为变量导入模板.xlsx",credit:"征信变量导入模板.xlsx"}[s.dataType]),c.success(`${L(s.dataType)}模板下载成功`)},Ce=()=>{if(!s.dataType){c.error("请选择数据类型");return}if(!x.value.length){c.error("请上传Excel文件");return}g.value=!0,setTimeout(()=>{g.value=!1;const n=s.mode==="append"?"新增":"覆盖";c.success(`${L(s.dataType)}${n}导入成功！共处理 ${f.value.total} 条数据`),U.value=!1,H()},2e3)},H=()=>{x.value=[],y.value=!1,f.value={total:0,rows:[]},Object.assign(s,{dataType:"",mode:"append",startRow:2,batchSize:1e3,skipErrors:!0})},Ve=()=>{console.log("批量操作:",_),c.success("批量操作成功"),M.value=!1,J()},J=()=>{Object.assign(_,{type:"",value:"",scope:"selected"})};return Be(()=>{}),(n,a)=>{const i=d("a-button"),E=d("a-space"),P=d("a-statistic"),$=d("a-card"),v=d("a-col"),W=d("a-row"),Ie=d("a-input-search"),u=d("a-option"),T=d("a-select"),q=d("a-tag"),Q=d("a-table"),m=d("a-form-item"),C=d("a-radio"),X=d("a-radio-group"),ke=d("a-upload"),Y=d("a-input-number"),Se=d("a-checkbox"),Z=d("a-form"),ee=d("a-modal"),ze=d("a-input");return b(),te("div",Oe,[p("div",Ne,[Ae,e(E,null,{default:t(()=>[e(i,{onClick:a[0]||(a[0]=l=>U.value=!0)},{icon:t(()=>[e(D(ae))]),default:t(()=>[o(" 批量导入 ")]),_:1}),e(i,{type:"primary",onClick:a[1]||(a[1]=l=>M.value=!0)},{icon:t(()=>[e(D($e))]),default:t(()=>[o(" 批量操作 ")]),_:1})]),_:1})]),p("div",Fe,[e(W,{gutter:16},{default:t(()=>[e(v,{span:6},{default:t(()=>[e($,null,{default:t(()=>[e(P,{title:"总资产数",value:B.total},null,8,["value"])]),_:1})]),_:1}),e(v,{span:6},{default:t(()=>[e($,null,{default:t(()=>[e(P,{title:"表资产",value:B.tables},null,8,["value"])]),_:1})]),_:1}),e(v,{span:6},{default:t(()=>[e($,null,{default:t(()=>[e(P,{title:"指标资产",value:B.metrics},null,8,["value"])]),_:1})]),_:1}),e(v,{span:6},{default:t(()=>[e($,null,{default:t(()=>[e(P,{title:"外数资产",value:B.external},null,8,["value"])]),_:1})]),_:1})]),_:1})]),p("div",je,[e(W,{gutter:16},{default:t(()=>[e(v,{span:8},{default:t(()=>[e(Ie,{modelValue:N.value,"onUpdate:modelValue":a[2]||(a[2]=l=>N.value=l),placeholder:"搜索资产名称、描述",onSearch:w},null,8,["modelValue"])]),_:1}),e(v,{span:4},{default:t(()=>[e(T,{modelValue:A.value,"onUpdate:modelValue":a[3]||(a[3]=l=>A.value=l),placeholder:"资产类型","allow-clear":"",onChange:w},{default:t(()=>[e(u,{value:"table"},{default:t(()=>[o("表")]),_:1}),e(u,{value:"metric"},{default:t(()=>[o("指标")]),_:1}),e(u,{value:"external"},{default:t(()=>[o("外数")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(v,{span:4},{default:t(()=>[e(T,{modelValue:F.value,"onUpdate:modelValue":a[4]||(a[4]=l=>F.value=l),placeholder:"状态","allow-clear":"",onChange:w},{default:t(()=>[e(u,{value:"active"},{default:t(()=>[o("活跃")]),_:1}),e(u,{value:"inactive"},{default:t(()=>[o("非活跃")]),_:1}),e(u,{value:"archived"},{default:t(()=>[o("已归档")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(v,{span:4},{default:t(()=>[e(T,{modelValue:j.value,"onUpdate:modelValue":a[5]||(a[5]=l=>j.value=l),placeholder:"负责人","allow-clear":"",onChange:w},{default:t(()=>[e(u,{value:"张三"},{default:t(()=>[o("张三")]),_:1}),e(u,{value:"李四"},{default:t(()=>[o("李四")]),_:1}),e(u,{value:"王五"},{default:t(()=>[o("王五")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(v,{span:4},{default:t(()=>[e(i,{type:"outline",onClick:de},{default:t(()=>[o("重置")]),_:1})]),_:1})]),_:1})]),h.value.length>0?(b(),te("div",Ke,[e(E,null,{default:t(()=>[p("span",null,"已选择 "+k(h.value.length)+" 项",1),e(i,{size:"small",onClick:a[6]||(a[6]=l=>G("active"))},{default:t(()=>[o(" 批量启用 ")]),_:1}),e(i,{size:"small",onClick:a[7]||(a[7]=l=>G("inactive"))},{default:t(()=>[o(" 批量停用 ")]),_:1}),e(i,{size:"small",onClick:fe},{default:t(()=>[o(" 批量分配负责人 ")]),_:1}),e(i,{size:"small",status:"danger",onClick:he},{default:t(()=>[o(" 批量删除 ")]),_:1}),e(i,{size:"small",onClick:be},{default:t(()=>[o(" 导出选中 ")]),_:1})]),_:1})])):I("",!0),e(Q,{columns:oe,data:ne.value,loading:g.value,pagination:R,"row-selection":se,onPageChange:ue,onPageSizeChange:ie},{assetType:t(({record:l})=>[e(q,{color:re(l.assetType)},{default:t(()=>[o(k(ce(l.assetType)),1)]),_:2},1032,["color"])]),status:t(({record:l})=>[e(q,{color:pe(l.status)},{default:t(()=>[o(k(ve(l.status)),1)]),_:2},1032,["color"])]),actions:t(({record:l})=>[e(E,null,{default:t(()=>[e(i,{type:"text",size:"small",onClick:Ue=>me(l)},{default:t(()=>[o(" 查看 ")]),_:2},1032,["onClick"]),e(i,{type:"text",size:"small",onClick:Ue=>_e(l)},{default:t(()=>[o(" 编辑 ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:1},8,["data","loading","pagination","row-selection"]),e(ee,{visible:U.value,"onUpdate:visible":a[13]||(a[13]=l=>U.value=l),title:"批量数据导入",width:"700px",onOk:Ce,onCancel:H},{default:t(()=>[e(Z,{layout:"vertical"},{default:t(()=>[e(m,{label:"数据类型"},{default:t(()=>[e(T,{modelValue:s.dataType,"onUpdate:modelValue":a[8]||(a[8]=l=>s.dataType=l),placeholder:"选择数据类型",onChange:ye},{default:t(()=>[e(u,{value:"behavior"},{default:t(()=>[o("行为变量")]),_:1}),e(u,{value:"credit"},{default:t(()=>[o("征信变量")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(m,{label:"导入模式"},{default:t(()=>[e(X,{modelValue:s.mode,"onUpdate:modelValue":a[9]||(a[9]=l=>s.mode=l)},{default:t(()=>[e(C,{value:"append"},{default:t(()=>[o("新增上传")]),_:1}),e(C,{value:"overwrite"},{default:t(()=>[o("覆盖上传")]),_:1})]),_:1},8,["modelValue"]),Le]),_:1}),e(m,{label:"上传Excel文件"},{default:t(()=>[e(ke,{ref_key:"uploadRef",ref:le,"file-list":x.value,"auto-upload":!1,accept:".xlsx,.xls",limit:1,onChange:ge,onBeforeUpload:xe},{"upload-button":t(()=>[p("div",We,[e(D(ae),{style:{"font-size":"24px",color:"#c9cdd4","margin-bottom":"8px"}}),qe,Ge])]),_:1},8,["file-list"])]),_:1}),s.dataType?(b(),O(m,{key:0},{default:t(()=>[e(E,null,{default:t(()=>[e(i,{type:"outline",onClick:Te},{icon:t(()=>[e(D(De))]),default:t(()=>[o(" 下载"+k(L(s.dataType))+"模板 ",1)]),_:1}),e(i,{type:"text",onClick:we,disabled:!x.value.length},{default:t(()=>[o(" 预览数据 ")]),_:1},8,["disabled"])]),_:1})]),_:1})):I("",!0),y.value?(b(),O(m,{key:1,label:"数据预览"},{default:t(()=>[p("div",He,[p("div",Je,[Qe,e(q,{color:"blue"},{default:t(()=>[o("共 "+k(f.value.total)+" 行",1)]),_:1})]),e(Q,{columns:K.value,data:f.value.rows,pagination:!1,size:"small",scroll:{x:800}},null,8,["columns","data"])])]),_:1})):I("",!0),s.dataType?(b(),O(m,{key:2,label:"导入配置"},{default:t(()=>[e(W,{gutter:16},{default:t(()=>[e(v,{span:12},{default:t(()=>[e(m,{label:"数据起始行",size:"small"},{default:t(()=>[e(Y,{modelValue:s.startRow,"onUpdate:modelValue":a[10]||(a[10]=l=>s.startRow=l),min:1,max:100},null,8,["modelValue"])]),_:1})]),_:1}),e(v,{span:12},{default:t(()=>[e(m,{label:"批次大小",size:"small"},{default:t(()=>[e(Y,{modelValue:s.batchSize,"onUpdate:modelValue":a[11]||(a[11]=l=>s.batchSize=l),min:100,max:1e4},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(Se,{modelValue:s.skipErrors,"onUpdate:modelValue":a[12]||(a[12]=l=>s.skipErrors=l)},{default:t(()=>[o("跳过错误行继续导入")]),_:1},8,["modelValue"])]),_:1})):I("",!0)]),_:1})]),_:1},8,["visible"]),e(ee,{visible:M.value,"onUpdate:visible":a[17]||(a[17]=l=>M.value=l),title:"批量操作配置",width:"500px",onOk:Ve,onCancel:J},{default:t(()=>[e(Z,{layout:"vertical"},{default:t(()=>[e(m,{label:"操作类型"},{default:t(()=>[e(T,{modelValue:_.type,"onUpdate:modelValue":a[14]||(a[14]=l=>_.type=l),placeholder:"选择操作类型"},{default:t(()=>[e(u,{value:"updateStatus"},{default:t(()=>[o("更新状态")]),_:1}),e(u,{value:"updateOwner"},{default:t(()=>[o("更新负责人")]),_:1}),e(u,{value:"updateCategory"},{default:t(()=>[o("更新分类")]),_:1}),e(u,{value:"addTags"},{default:t(()=>[o("添加标签")]),_:1})]),_:1},8,["modelValue"])]),_:1}),_.type?(b(),O(m,{key:0,label:"目标值"},{default:t(()=>[e(ze,{modelValue:_.value,"onUpdate:modelValue":a[15]||(a[15]=l=>_.value=l),placeholder:"请输入目标值"},null,8,["modelValue"])]),_:1})):I("",!0),e(m,{label:"应用范围"},{default:t(()=>[e(X,{modelValue:_.scope,"onUpdate:modelValue":a[16]||(a[16]=l=>_.scope=l)},{default:t(()=>[e(C,{value:"selected"},{default:t(()=>[o("仅选中项")]),_:1}),e(C,{value:"filtered"},{default:t(()=>[o("当前筛选结果")]),_:1}),e(C,{value:"all"},{default:t(()=>[o("全部资产")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["visible"])])}}}),tt=Pe(Xe,[["__scopeId","data-v-e4a2df5e"]]);export{tt as default};
