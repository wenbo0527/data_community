const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/tableData-DYle3NyQ.js","assets/index-CsgcdrY7.js","assets/index-BzpxCuvK.css","assets/data-map-BtHUnIhr.js"])))=>i.map(i=>d[i]);
import{B as Y,r as u,b as Z,u as ee,M as s,c as E,h as _,f as e,w as o,e as c,s as te,v as ae,J as oe,o as x,j as r,F as ne,m as le,d as F,g as se,i as v,a1 as ce,t as D,a2 as I,a3 as re,P as N,_ as ie}from"./index-CsgcdrY7.js";import{t as q}from"./tableData-DYle3NyQ.js";import{I as ue}from"./index-D3r115Ij.js";import{I as de}from"./index-59Iun2mN.js";import{I as pe}from"./index-Cf7xlEWt.js";import"./data-map-BtHUnIhr.js";const _e=y=>(te("data-v-04841890"),y=y(),ae(),y),me={class:"table-list-page"},he={class:"page-header"},fe=_e(()=>_("h2",{class:"page-title"},"数据表",-1)),ve={class:"card-header"},ye={class:"table-name"},we={class:"card-content"},be=["title"],ge={class:"update-time"},ke=Y({__name:"TableList",setup(y){const O=ee(),$=oe(),m=u(""),w=u(""),b=u(""),M=u(!1),S=u([]);u(null);const B=u({total:0,current:1,pageSize:10,showTotal:!0,showJumper:!0,showPageSize:!0});Z(()=>{const t=O.query.keyword;t&&(m.value=t,P())});const R=()=>q.map(t=>({...t,updateTime:new Date().toLocaleDateString()})),U=t=>m.value===""||t.name.includes(m.value)||t.description.includes(m.value),z=t=>w.value===""||t.domain===w.value,A=t=>b.value===""||t.theme===b.value,P=async()=>{M.value=!0;try{await new Promise(a=>setTimeout(a,1e3));const t=R();S.value=t.filter(a=>U(a)&&z(a)&&A(a)),B.value.total=S.value.length}catch{s.error("搜索失败")}finally{M.value=!1}},J=(t,a)=>({name:t.name,type:t.type||"",description:t.description||"",updateTime:t.updateTime||new Date().toLocaleDateString(),fields:a.fields||[],category:a.category||"",domain:a.domain||"",updateFrequency:a.updateFrequency||"",owner:a.owner||""}),K=t=>{if(!(t!=null&&t.name))throw new Error("表名不能为空");const a=q.find(i=>i.name===t.name);if(!a)throw new Error("未找到表数据");return a},j=t=>{try{const a=K(t),i=J(t,a);$.push({name:"TableDetail",params:{tableName:t.name},query:{table:JSON.stringify(i)}})}catch(a){s.error(a.message),console.error("跳转表详情页失败:",a)}},G=async t=>{try{s.success("权限申请已提交")}catch{s.error("权限申请失败")}},H=async t=>{try{s.success("添加收藏成功")}catch{s.error("添加收藏失败")}},Q=async t=>{try{await navigator.clipboard.writeText(t.name),s.success("复制成功")}catch{s.error("复制失败")}},W=async t=>{try{const{Modal:a,Select:i,Option:f}=await N(async()=>{const{Modal:l,Select:h,Option:g}=await import("./tableData-DYle3NyQ.js").then(k=>k.i);return{Modal:l,Select:h,Option:g}},__vite__mapDeps([0,1,2,3])),{h:d}=await N(async()=>{const{h:l}=await import("./tableData-DYle3NyQ.js").then(h=>h.v);return{h:l}},__vite__mapDeps([0,1,2,3]));let p=u("");a.confirm({title:"添加到常用表集合",content:()=>d("div",[d(i,{placeholder:"请选择集合",style:{width:"100%"},allowClear:!0,"onUpdate:modelValue":l=>{p.value=l}},()=>[d(f,{value:"collection1"},()=>"常用表集合1"),d(f,{value:"collection2"},()=>"常用表集合2"),d(f,{value:"collection3"},()=>"常用表集合3")])]),onOk:async()=>{if(!p.value)return s.warning("请选择集合"),!1;try{return s.success(`已添加到${p.value}`),!0}catch{return s.error("添加到集合失败"),!1}},onCancel:()=>{s.info("已取消")}})}catch{s.error("弹窗打开失败")}};return(t,a)=>{const i=c("a-breadcrumb-item"),f=c("a-breadcrumb"),d=c("a-input-search"),p=c("a-col"),l=c("a-option"),h=c("a-select"),g=c("a-space"),k=c("a-row"),X=c("a-tag"),C=c("a-button"),T=c("a-tooltip"),L=c("a-card");return x(),E("div",me,[_("div",he,[e(f,null,{default:o(()=>[e(i,null,{default:o(()=>[r("数据地图")]),_:1}),e(i,null,{default:o(()=>[r("数据表")]),_:1})]),_:1}),fe]),e(L,null,{default:o(()=>[e(k,{class:"search-info",align:"center",gutter:16},{default:o(()=>[e(p,{span:16},{default:o(()=>[e(d,{modelValue:m.value,"onUpdate:modelValue":a[0]||(a[0]=n=>m.value=n),placeholder:"搜索表名、字段名或描述","search-button":"","allow-clear":"",onSearch:P,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),e(p,{span:8},{default:o(()=>[e(g,null,{default:o(()=>[e(h,{modelValue:w.value,"onUpdate:modelValue":a[1]||(a[1]=n=>w.value=n),placeholder:"业务域","allow-clear":"",style:{width:"140px"}},{default:o(()=>[e(l,{value:"domain1"},{default:o(()=>[r("业务域1")]),_:1}),e(l,{value:"domain2"},{default:o(()=>[r("业务域2")]),_:1}),e(l,{value:"domain3"},{default:o(()=>[r("业务域3")]),_:1}),e(l,{value:"domain4"},{default:o(()=>[r("业务域4")]),_:1})]),_:1},8,["modelValue"]),e(h,{modelValue:b.value,"onUpdate:modelValue":a[2]||(a[2]=n=>b.value=n),placeholder:"主题域","allow-clear":"",style:{width:"140px"}},{default:o(()=>[e(l,{value:"theme1"},{default:o(()=>[r("主题域1")]),_:1}),e(l,{value:"theme2"},{default:o(()=>[r("主题域2")]),_:1}),e(l,{value:"theme3"},{default:o(()=>[r("主题域3")]),_:1}),e(l,{value:"theme4"},{default:o(()=>[r("主题域4")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(k,{gutter:12},{default:o(()=>[(x(!0),E(ne,null,le(S.value,n=>(x(),F(p,{key:n.name,span:8,style:{"margin-bottom":"12px"}},{default:o(()=>[e(L,{hoverable:"",onClick:V=>j(n),class:"table-card",bordered:!1},{actions:o(()=>[e(g,null,{default:o(()=>[e(T,{content:"收藏",position:"bottom"},{default:o(()=>[e(C,{type:"text",onClick:I(V=>H(n),["stop"])},{icon:o(()=>[e(v(ue))]),_:2},1032,["onClick"])]),_:2},1024),e(T,{content:"申请权限",position:"bottom"},{default:o(()=>[e(C,{type:"text",onClick:I(V=>G(n),["stop"])},{icon:o(()=>[e(v(de))]),_:2},1032,["onClick"])]),_:2},1024),e(T,{content:"复制表名",position:"bottom"},{default:o(()=>[e(C,{type:"text",onClick:I(V=>Q(n),["stop"])},{icon:o(()=>[e(v(re))]),_:2},1032,["onClick"])]),_:2},1024),e(T,{content:"添加到集合",position:"bottom"},{default:o(()=>[e(C,{type:"text",onClick:I(V=>W(n),["stop"])},{icon:o(()=>[e(v(pe))]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),default:o(()=>[_("div",ve,[e(v(ce),{style:{"margin-right":"8px"}}),_("span",ye,D(n.name),1),n.type?(x(),F(X,{key:0,color:n.type==="维度表"?"arcoblue":"orangered",size:"small",style:{"margin-left":"8px"}},{default:o(()=>[r(D(n.type),1)]),_:2},1032,["color"])):se("",!0)]),_("div",we,[_("p",{class:"description",title:n.description},D(n.description),9,be),_("p",ge,D(n.updateTime),1)])]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})]),_:1})])}}}),Se=ie(ke,[["__scopeId","data-v-04841890"]]);export{Se as default};
