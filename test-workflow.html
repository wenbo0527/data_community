<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>工作流测试</title>
</head>
<body>
    <h1>工作流画布测试</h1>
    <p>点击下面的链接来测试工作流功能：</p>
    
    <div style="margin: 20px 0;">
        <h3>测试步骤：</h3>
        <ol>
            <li><a href="http://localhost:5173/exploration/workflows" target="_blank">访问工作流管理页面</a></li>
            <li><a href="http://localhost:5173/exploration/workflows/create" target="_blank">创建新工作流</a></li>
            <li>创建工作流后会自动跳转到编辑器</li>
            <li>在编辑器中测试以下功能：
                <ul>
                    <li>鼠标悬停节点查看连接桩</li>
                    <li>点击节点右侧的+号按钮</li>
                    <li>从下拉菜单选择节点类型</li>
                    <li>验证新节点是否正确创建和连接</li>
                </ul>
            </li>
        </ol>
    </div>
    
    <div style="margin: 20px 0;">
        <h3>预期功能：</h3>
        <ul>
            <li>✅ 节点悬停显示连接桩</li>
            <li>✅ +号按钮显示下拉菜单</li>
            <li>✅ 点击菜单项创建新节点</li>
            <li>✅ 自动计算节点位置</li>
            <li>✅ 自动创建连接线</li>
        </ul>
    </div>
    
    <script>
        // 创建测试工作流数据
        function createTestWorkflow() {
            const testWorkflow = {
                id: 'test_workflow_' + Date.now(),
                name: '测试工作流',
                description: '用于测试画布功能的工作流',
                tags: ['测试'],
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString(),
                nodes: [
                    {
                        id: 'input-1',
                        shape: 'workflow-node',
                        x: 100,
                        y: 100,
                        ports: [{ id: 'input-1-out', group: 'out' }],
                        data: {
                            name: '数据输入_1',
                            type: 'INPUT'
                        }
                    }
                ],
                edges: [],
                config: {}
            };
            
            // 保存到localStorage
            const workflows = JSON.parse(localStorage.getItem('workflow_storage_workflows') || '[]');
            workflows.push(testWorkflow);
            localStorage.setItem('workflow_storage_workflows', JSON.stringify(workflows));
            
            alert('测试工作流已创建！ID: ' + testWorkflow.id);
            
            // 打开编辑器
            window.open(`http://localhost:5173/exploration/workflows/${testWorkflow.id}/edit`, '_blank');
        }
        
        // 清理测试数据
        function clearTestData() {
            localStorage.removeItem('workflow_storage_workflows');
            localStorage.removeItem('workflow_storage_data_sources');
            localStorage.removeItem('workflow_storage_settings');
            alert('测试数据已清理！');
        }
    </script>
    
    <div style="margin: 20px 0;">
        <button onclick="createTestWorkflow()" style="padding: 10px 20px; margin-right: 10px; background: #1890ff; color: white; border: none; border-radius: 4px; cursor: pointer;">创建测试工作流</button>
        <button onclick="clearTestData()" style="padding: 10px 20px; background: #f5222d; color: white; border: none; border-radius: 4px; cursor: pointer;">清理测试数据</button>
    </div>
</body>
</html>